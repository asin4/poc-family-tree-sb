var El=Object.defineProperty;var _l=(e,t,n)=>t in e?El(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var oe=(e,t,n)=>_l(e,typeof t!="symbol"?t+"":t,n);import{g as xs,a as vs,R as W,r as z}from"./index-DmM0KDA7.js";import{j as H}from"./index-BIwgqnKK.js";import"./index-nLeaPAJ8.js";var bn,fi;function Br(){if(fi)return bn;fi=1;var e="\0",t="\0",n="";class r{constructor(u){oe(this,"_isDirected",!0);oe(this,"_isMultigraph",!1);oe(this,"_isCompound",!1);oe(this,"_label");oe(this,"_defaultNodeLabelFn",()=>{});oe(this,"_defaultEdgeLabelFn",()=>{});oe(this,"_nodes",{});oe(this,"_in",{});oe(this,"_preds",{});oe(this,"_out",{});oe(this,"_sucs",{});oe(this,"_edgeObjs",{});oe(this,"_edgeLabels",{});oe(this,"_nodeCount",0);oe(this,"_edgeCount",0);oe(this,"_parent");oe(this,"_children");u&&(this._isDirected=Object.hasOwn(u,"directed")?u.directed:!0,this._isMultigraph=Object.hasOwn(u,"multigraph")?u.multigraph:!1,this._isCompound=Object.hasOwn(u,"compound")?u.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[t]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(u){return this._label=u,this}graph(){return this._label}setDefaultNodeLabel(u){return this._defaultNodeLabelFn=u,typeof u!="function"&&(this._defaultNodeLabelFn=()=>u),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var u=this;return this.nodes().filter(c=>Object.keys(u._in[c]).length===0)}sinks(){var u=this;return this.nodes().filter(c=>Object.keys(u._out[c]).length===0)}setNodes(u,c){var f=arguments,h=this;return u.forEach(function(p){f.length>1?h.setNode(p,c):h.setNode(p)}),this}setNode(u,c){return Object.hasOwn(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=c),this):(this._nodes[u]=arguments.length>1?c:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=t,this._children[u]={},this._children[t][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)}node(u){return this._nodes[u]}hasNode(u){return Object.hasOwn(this._nodes,u)}removeNode(u){var c=this;if(Object.hasOwn(this._nodes,u)){var f=h=>c.removeEdge(c._edgeObjs[h]);delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],this.children(u).forEach(function(h){c.setParent(h)}),delete this._children[u]),Object.keys(this._in[u]).forEach(f),delete this._in[u],delete this._preds[u],Object.keys(this._out[u]).forEach(f),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this}setParent(u,c){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(c===void 0)c=t;else{c+="";for(var f=c;f!==void 0;f=this.parent(f))if(f===u)throw new Error("Setting "+c+" as parent of "+u+" would create a cycle");this.setNode(c)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=c,this._children[c][u]=!0,this}_removeFromParentsChildList(u){delete this._children[this._parent[u]][u]}parent(u){if(this._isCompound){var c=this._parent[u];if(c!==t)return c}}children(u=t){if(this._isCompound){var c=this._children[u];if(c)return Object.keys(c)}else{if(u===t)return this.nodes();if(this.hasNode(u))return[]}}predecessors(u){var c=this._preds[u];if(c)return Object.keys(c)}successors(u){var c=this._sucs[u];if(c)return Object.keys(c)}neighbors(u){var c=this.predecessors(u);if(c){const h=new Set(c);for(var f of this.successors(u))h.add(f);return Array.from(h.values())}}isLeaf(u){var c;return this.isDirected()?c=this.successors(u):c=this.neighbors(u),c.length===0}filterNodes(u){var c=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});c.setGraph(this.graph());var f=this;Object.entries(this._nodes).forEach(function([m,x]){u(m)&&c.setNode(m,x)}),Object.values(this._edgeObjs).forEach(function(m){c.hasNode(m.v)&&c.hasNode(m.w)&&c.setEdge(m,f.edge(m))});var h={};function p(m){var x=f.parent(m);return x===void 0||c.hasNode(x)?(h[m]=x,x):x in h?h[x]:p(x)}return this._isCompound&&c.nodes().forEach(m=>c.setParent(m,p(m))),c}setDefaultEdgeLabel(u){return this._defaultEdgeLabelFn=u,typeof u!="function"&&(this._defaultEdgeLabelFn=()=>u),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(u,c){var f=this,h=arguments;return u.reduce(function(p,m){return h.length>1?f.setEdge(p,m,c):f.setEdge(p,m),m}),this}setEdge(){var u,c,f,h,p=!1,m=arguments[0];typeof m=="object"&&m!==null&&"v"in m?(u=m.v,c=m.w,f=m.name,arguments.length===2&&(h=arguments[1],p=!0)):(u=m,c=arguments[1],f=arguments[3],arguments.length>2&&(h=arguments[2],p=!0)),u=""+u,c=""+c,f!==void 0&&(f=""+f);var x=o(this._isDirected,u,c,f);if(Object.hasOwn(this._edgeLabels,x))return p&&(this._edgeLabels[x]=h),this;if(f!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(c),this._edgeLabels[x]=p?h:this._defaultEdgeLabelFn(u,c,f);var y=a(this._isDirected,u,c,f);return u=y.v,c=y.w,Object.freeze(y),this._edgeObjs[x]=y,i(this._preds[c],u),i(this._sucs[u],c),this._in[c][x]=y,this._out[u][x]=y,this._edgeCount++,this}edge(u,c,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):o(this._isDirected,u,c,f);return this._edgeLabels[h]}edgeAsObj(){const u=this.edge(...arguments);return typeof u!="object"?{label:u}:u}hasEdge(u,c,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):o(this._isDirected,u,c,f);return Object.hasOwn(this._edgeLabels,h)}removeEdge(u,c,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):o(this._isDirected,u,c,f),p=this._edgeObjs[h];return p&&(u=p.v,c=p.w,delete this._edgeLabels[h],delete this._edgeObjs[h],s(this._preds[c],u),s(this._sucs[u],c),delete this._in[c][h],delete this._out[u][h],this._edgeCount--),this}inEdges(u,c){var f=this._in[u];if(f){var h=Object.values(f);return c?h.filter(p=>p.v===c):h}}outEdges(u,c){var f=this._out[u];if(f){var h=Object.values(f);return c?h.filter(p=>p.w===c):h}}nodeEdges(u,c){var f=this.inEdges(u,c);if(f)return f.concat(this.outEdges(u,c))}}function i(d,u){d[u]?d[u]++:d[u]=1}function s(d,u){--d[u]||delete d[u]}function o(d,u,c,f){var h=""+u,p=""+c;if(!d&&h>p){var m=h;h=p,p=m}return h+n+p+n+(f===void 0?e:f)}function a(d,u,c,f){var h=""+u,p=""+c;if(!d&&h>p){var m=h;h=p,p=m}var x={v:h,w:p};return f&&(x.name=f),x}function l(d,u){return o(d,u.v,u.w,u.name)}return bn=r,bn}var En,hi;function Nl(){return hi||(hi=1,En="2.2.4"),En}var _n,pi;function Sl(){return pi||(pi=1,_n={Graph:Br(),version:Nl()}),_n}var Nn,gi;function kl(){if(gi)return Nn;gi=1;var e=Br();Nn={write:t,read:i};function t(s){var o={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:n(s),edges:r(s)};return s.graph()!==void 0&&(o.value=structuredClone(s.graph())),o}function n(s){return s.nodes().map(function(o){var a=s.node(o),l=s.parent(o),d={v:o};return a!==void 0&&(d.value=a),l!==void 0&&(d.parent=l),d})}function r(s){return s.edges().map(function(o){var a=s.edge(o),l={v:o.v,w:o.w};return o.name!==void 0&&(l.name=o.name),a!==void 0&&(l.value=a),l})}function i(s){var o=new e(s.options).setGraph(s.value);return s.nodes.forEach(function(a){o.setNode(a.v,a.value),a.parent&&o.setParent(a.v,a.parent)}),s.edges.forEach(function(a){o.setEdge({v:a.v,w:a.w,name:a.name},a.value)}),o}return Nn}var Sn,mi;function Cl(){if(mi)return Sn;mi=1,Sn=e;function e(t){var n={},r=[],i;function s(o){Object.hasOwn(n,o)||(n[o]=!0,i.push(o),t.successors(o).forEach(s),t.predecessors(o).forEach(s))}return t.nodes().forEach(function(o){i=[],s(o),i.length&&r.push(i)}),r}return Sn}var kn,yi;function bs(){if(yi)return kn;yi=1;class e{constructor(){oe(this,"_arr",[]);oe(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map(function(n){return n.key})}has(n){return Object.hasOwn(this._keyIndices,n)}priority(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(n,r){var i=this._keyIndices;if(n=String(n),!Object.hasOwn(i,n)){var s=this._arr,o=s.length;return i[n]=o,s.push({key:n,priority:r}),this._decrease(o),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key}decrease(n,r){var i=this._keyIndices[n];if(r>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[i].priority+" New: "+r);this._arr[i].priority=r,this._decrease(i)}_heapify(n){var r=this._arr,i=2*n,s=i+1,o=n;i<r.length&&(o=r[i].priority<r[o].priority?i:o,s<r.length&&(o=r[s].priority<r[o].priority?s:o),o!==n&&(this._swap(n,o),this._heapify(o)))}_decrease(n){for(var r=this._arr,i=r[n].priority,s;n!==0&&(s=n>>1,!(r[s].priority<i));)this._swap(n,s),n=s}_swap(n,r){var i=this._arr,s=this._keyIndices,o=i[n],a=i[r];i[n]=a,i[r]=o,s[a.key]=n,s[o.key]=r}}return kn=e,kn}var Cn,wi;function Es(){if(wi)return Cn;wi=1;var e=bs();Cn=n;var t=()=>1;function n(i,s,o,a){return r(i,String(s),o||t,a||function(l){return i.outEdges(l)})}function r(i,s,o,a){var l={},d=new e,u,c,f=function(h){var p=h.v!==u?h.v:h.w,m=l[p],x=o(h),y=c.distance+x;if(x<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+h+" Weight: "+x);y<m.distance&&(m.distance=y,m.predecessor=u,d.decrease(p,y))};for(i.nodes().forEach(function(h){var p=h===s?0:Number.POSITIVE_INFINITY;l[h]={distance:p},d.add(h,p)});d.size()>0&&(u=d.removeMin(),c=l[u],c.distance!==Number.POSITIVE_INFINITY);)a(u).forEach(f);return l}return Cn}var Mn,xi;function Ml(){if(xi)return Mn;xi=1;var e=Es();Mn=t;function t(n,r,i){return n.nodes().reduce(function(s,o){return s[o]=e(n,o,r,i),s},{})}return Mn}var Rn,vi;function _s(){if(vi)return Rn;vi=1,Rn=e;function e(t){var n=0,r=[],i={},s=[];function o(a){var l=i[a]={onStack:!0,lowlink:n,index:n++};if(r.push(a),t.successors(a).forEach(function(c){Object.hasOwn(i,c)?i[c].onStack&&(l.lowlink=Math.min(l.lowlink,i[c].index)):(o(c),l.lowlink=Math.min(l.lowlink,i[c].lowlink))}),l.lowlink===l.index){var d=[],u;do u=r.pop(),i[u].onStack=!1,d.push(u);while(a!==u);s.push(d)}}return t.nodes().forEach(function(a){Object.hasOwn(i,a)||o(a)}),s}return Rn}var In,bi;function Rl(){if(bi)return In;bi=1;var e=_s();In=t;function t(n){return e(n).filter(function(r){return r.length>1||r.length===1&&n.hasEdge(r[0],r[0])})}return In}var Tn,Ei;function Il(){if(Ei)return Tn;Ei=1,Tn=t;var e=()=>1;function t(r,i,s){return n(r,i||e,s||function(o){return r.outEdges(o)})}function n(r,i,s){var o={},a=r.nodes();return a.forEach(function(l){o[l]={},o[l][l]={distance:0},a.forEach(function(d){l!==d&&(o[l][d]={distance:Number.POSITIVE_INFINITY})}),s(l).forEach(function(d){var u=d.v===l?d.w:d.v,c=i(d);o[l][u]={distance:c,predecessor:l}})}),a.forEach(function(l){var d=o[l];a.forEach(function(u){var c=o[u];a.forEach(function(f){var h=c[l],p=d[f],m=c[f],x=h.distance+p.distance;x<m.distance&&(m.distance=x,m.predecessor=p.predecessor)})})}),o}return Tn}var An,_i;function Ns(){if(_i)return An;_i=1;function e(n){var r={},i={},s=[];function o(a){if(Object.hasOwn(i,a))throw new t;Object.hasOwn(r,a)||(i[a]=!0,r[a]=!0,n.predecessors(a).forEach(o),delete i[a],s.push(a))}if(n.sinks().forEach(o),Object.keys(r).length!==n.nodeCount())throw new t;return s}class t extends Error{constructor(){super(...arguments)}}return An=e,e.CycleException=t,An}var Pn,Ni;function Tl(){if(Ni)return Pn;Ni=1;var e=Ns();Pn=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return Pn}var $n,Si;function Ss(){if(Si)return $n;Si=1,$n=e;function e(i,s,o){Array.isArray(s)||(s=[s]);var a=i.isDirected()?c=>i.successors(c):c=>i.neighbors(c),l=o==="post"?t:n,d=[],u={};return s.forEach(c=>{if(!i.hasNode(c))throw new Error("Graph does not have node: "+c);l(c,a,u,d)}),d}function t(i,s,o,a){for(var l=[[i,!1]];l.length>0;){var d=l.pop();d[1]?a.push(d[0]):Object.hasOwn(o,d[0])||(o[d[0]]=!0,l.push([d[0],!0]),r(s(d[0]),u=>l.push([u,!1])))}}function n(i,s,o,a){for(var l=[i];l.length>0;){var d=l.pop();Object.hasOwn(o,d)||(o[d]=!0,a.push(d),r(s(d),u=>l.push(u)))}}function r(i,s){for(var o=i.length;o--;)s(i[o],o,i);return i}return $n}var On,ki;function Al(){if(ki)return On;ki=1;var e=Ss();On=t;function t(n,r){return e(n,r,"post")}return On}var Ln,Ci;function Pl(){if(Ci)return Ln;Ci=1;var e=Ss();Ln=t;function t(n,r){return e(n,r,"pre")}return Ln}var Dn,Mi;function $l(){if(Mi)return Dn;Mi=1;var e=Br(),t=bs();Dn=n;function n(r,i){var s=new e,o={},a=new t,l;function d(c){var f=c.v===l?c.w:c.v,h=a.priority(f);if(h!==void 0){var p=i(c);p<h&&(o[f]=l,a.decrease(f,p))}}if(r.nodeCount()===0)return s;r.nodes().forEach(function(c){a.add(c,Number.POSITIVE_INFINITY),s.setNode(c)}),a.decrease(r.nodes()[0],0);for(var u=!1;a.size()>0;){if(l=a.removeMin(),Object.hasOwn(o,l))s.setEdge(l,o[l]);else{if(u)throw new Error("Input graph is not connected: "+r);u=!0}r.nodeEdges(l).forEach(d)}return s}return Dn}var jn,Ri;function Ol(){return Ri||(Ri=1,jn={components:Cl(),dijkstra:Es(),dijkstraAll:Ml(),findCycles:Rl(),floydWarshall:Il(),isAcyclic:Tl(),postorder:Al(),preorder:Pl(),prim:$l(),tarjan:_s(),topsort:Ns()}),jn}var Hn,Ii;function me(){if(Ii)return Hn;Ii=1;var e=Sl();return Hn={Graph:e.Graph,json:kl(),alg:Ol(),version:e.version},Hn}var zn,Ti;function Ll(){if(Ti)return zn;Ti=1;class e{constructor(){let i={};i._next=i._prev=i,this._sentinel=i}dequeue(){let i=this._sentinel,s=i._prev;if(s!==i)return t(s),s}enqueue(i){let s=this._sentinel;i._prev&&i._next&&t(i),i._next=s._next,s._next._prev=i,s._next=i,i._prev=s}toString(){let i=[],s=this._sentinel,o=s._prev;for(;o!==s;)i.push(JSON.stringify(o,n)),o=o._prev;return"["+i.join(", ")+"]"}}function t(r){r._prev._next=r._next,r._next._prev=r._prev,delete r._next,delete r._prev}function n(r,i){if(r!=="_next"&&r!=="_prev")return i}return zn=e,zn}var Fn,Ai;function Dl(){if(Ai)return Fn;Ai=1;let e=me().Graph,t=Ll();Fn=r;let n=()=>1;function r(d,u){if(d.nodeCount()<=1)return[];let c=o(d,u||n);return i(c.graph,c.buckets,c.zeroIdx).flatMap(h=>d.outEdges(h.v,h.w))}function i(d,u,c){let f=[],h=u[u.length-1],p=u[0],m;for(;d.nodeCount();){for(;m=p.dequeue();)s(d,u,c,m);for(;m=h.dequeue();)s(d,u,c,m);if(d.nodeCount()){for(let x=u.length-2;x>0;--x)if(m=u[x].dequeue(),m){f=f.concat(s(d,u,c,m,!0));break}}}return f}function s(d,u,c,f,h){let p=h?[]:void 0;return d.inEdges(f.v).forEach(m=>{let x=d.edge(m),y=d.node(m.v);h&&p.push({v:m.v,w:m.w}),y.out-=x,a(u,c,y)}),d.outEdges(f.v).forEach(m=>{let x=d.edge(m),y=m.w,v=d.node(y);v.in-=x,a(u,c,v)}),d.removeNode(f.v),p}function o(d,u){let c=new e,f=0,h=0;d.nodes().forEach(x=>{c.setNode(x,{v:x,in:0,out:0})}),d.edges().forEach(x=>{let y=c.edge(x.v,x.w)||0,v=u(x),g=y+v;c.setEdge(x.v,x.w,g),h=Math.max(h,c.node(x.v).out+=v),f=Math.max(f,c.node(x.w).in+=v)});let p=l(h+f+3).map(()=>new t),m=f+1;return c.nodes().forEach(x=>{a(p,m,c.node(x))}),{graph:c,buckets:p,zeroIdx:m}}function a(d,u,c){c.out?c.in?d[c.out-c.in+u].enqueue(c):d[d.length-1].enqueue(c):d[0].enqueue(c)}function l(d){const u=[];for(let c=0;c<d;c++)u.push(c);return u}return Fn}var Vn,Pi;function ae(){if(Pi)return Vn;Pi=1;let e=me().Graph;Vn={addBorderNode:u,addDummyNode:t,applyWithChunking:h,asNonCompoundGraph:r,buildLayerMatrix:a,intersectRect:o,mapValues:k,maxRank:p,normalizeRanks:l,notime:y,partition:m,pick:N,predecessorWeights:s,range:w,removeEmptyRanks:d,simplify:n,successorWeights:i,time:x,uniqueId:g,zipObject:C};function t(E,_,S,R){let I;do I=g(R);while(E.hasNode(I));return S.dummy=_,E.setNode(I,S),I}function n(E){let _=new e().setGraph(E.graph());return E.nodes().forEach(S=>_.setNode(S,E.node(S))),E.edges().forEach(S=>{let R=_.edge(S.v,S.w)||{weight:0,minlen:1},I=E.edge(S);_.setEdge(S.v,S.w,{weight:R.weight+I.weight,minlen:Math.max(R.minlen,I.minlen)})}),_}function r(E){let _=new e({multigraph:E.isMultigraph()}).setGraph(E.graph());return E.nodes().forEach(S=>{E.children(S).length||_.setNode(S,E.node(S))}),E.edges().forEach(S=>{_.setEdge(S,E.edge(S))}),_}function i(E){let _=E.nodes().map(S=>{let R={};return E.outEdges(S).forEach(I=>{R[I.w]=(R[I.w]||0)+E.edge(I).weight}),R});return C(E.nodes(),_)}function s(E){let _=E.nodes().map(S=>{let R={};return E.inEdges(S).forEach(I=>{R[I.v]=(R[I.v]||0)+E.edge(I).weight}),R});return C(E.nodes(),_)}function o(E,_){let S=E.x,R=E.y,I=_.x-S,D=_.y-R,b=E.width/2,T=E.height/2;if(!I&&!D)throw new Error("Not possible to find intersection inside of the rectangle");let M,O;return Math.abs(D)*b>Math.abs(I)*T?(D<0&&(T=-T),M=T*I/D,O=T):(I<0&&(b=-b),M=b,O=b*D/I),{x:S+M,y:R+O}}function a(E){let _=w(p(E)+1).map(()=>[]);return E.nodes().forEach(S=>{let R=E.node(S),I=R.rank;I!==void 0&&(_[I][R.order]=S)}),_}function l(E){let _=E.nodes().map(R=>{let I=E.node(R).rank;return I===void 0?Number.MAX_VALUE:I}),S=h(Math.min,_);E.nodes().forEach(R=>{let I=E.node(R);Object.hasOwn(I,"rank")&&(I.rank-=S)})}function d(E){let _=E.nodes().map(b=>E.node(b).rank),S=h(Math.min,_),R=[];E.nodes().forEach(b=>{let T=E.node(b).rank-S;R[T]||(R[T]=[]),R[T].push(b)});let I=0,D=E.graph().nodeRankFactor;Array.from(R).forEach((b,T)=>{b===void 0&&T%D!==0?--I:b!==void 0&&I&&b.forEach(M=>E.node(M).rank+=I)})}function u(E,_,S,R){let I={width:0,height:0};return arguments.length>=4&&(I.rank=S,I.order=R),t(E,"border",I,_)}function c(E,_=f){const S=[];for(let R=0;R<E.length;R+=_){const I=E.slice(R,R+_);S.push(I)}return S}const f=65535;function h(E,_){if(_.length>f){const S=c(_);return E.apply(null,S.map(R=>E.apply(null,R)))}else return E.apply(null,_)}function p(E){const S=E.nodes().map(R=>{let I=E.node(R).rank;return I===void 0?Number.MIN_VALUE:I});return h(Math.max,S)}function m(E,_){let S={lhs:[],rhs:[]};return E.forEach(R=>{_(R)?S.lhs.push(R):S.rhs.push(R)}),S}function x(E,_){let S=Date.now();try{return _()}finally{console.log(E+" time: "+(Date.now()-S)+"ms")}}function y(E,_){return _()}let v=0;function g(E){var _=++v;return toString(E)+_}function w(E,_,S=1){_==null&&(_=E,E=0);let R=D=>D<_;S<0&&(R=D=>_<D);const I=[];for(let D=E;R(D);D+=S)I.push(D);return I}function N(E,_){const S={};for(const R of _)E[R]!==void 0&&(S[R]=E[R]);return S}function k(E,_){let S=_;return typeof _=="string"&&(S=R=>R[_]),Object.entries(E).reduce((R,[I,D])=>(R[I]=S(D,I),R),{})}function C(E,_){return E.reduce((S,R,I)=>(S[R]=_[I],S),{})}return Vn}var qn,$i;function jl(){if($i)return qn;$i=1;let e=Dl(),t=ae().uniqueId;qn={run:n,undo:i};function n(s){(s.graph().acyclicer==="greedy"?e(s,a(s)):r(s)).forEach(l=>{let d=s.edge(l);s.removeEdge(l),d.forwardName=l.name,d.reversed=!0,s.setEdge(l.w,l.v,d,t("rev"))});function a(l){return d=>l.edge(d).weight}}function r(s){let o=[],a={},l={};function d(u){Object.hasOwn(l,u)||(l[u]=!0,a[u]=!0,s.outEdges(u).forEach(c=>{Object.hasOwn(a,c.w)?o.push(c):d(c.w)}),delete a[u])}return s.nodes().forEach(d),o}function i(s){s.edges().forEach(o=>{let a=s.edge(o);if(a.reversed){s.removeEdge(o);let l=a.forwardName;delete a.reversed,delete a.forwardName,s.setEdge(o.w,o.v,a,l)}})}return qn}var Bn,Oi;function Hl(){if(Oi)return Bn;Oi=1;let e=ae();Bn={run:t,undo:r};function t(i){i.graph().dummyChains=[],i.edges().forEach(s=>n(i,s))}function n(i,s){let o=s.v,a=i.node(o).rank,l=s.w,d=i.node(l).rank,u=s.name,c=i.edge(s),f=c.labelRank;if(d===a+1)return;i.removeEdge(s);let h,p,m;for(m=0,++a;a<d;++m,++a)c.points=[],p={width:0,height:0,edgeLabel:c,edgeObj:s,rank:a},h=e.addDummyNode(i,"edge",p,"_d"),a===f&&(p.width=c.width,p.height=c.height,p.dummy="edge-label",p.labelpos=c.labelpos),i.setEdge(o,h,{weight:c.weight},u),m===0&&i.graph().dummyChains.push(h),o=h;i.setEdge(o,l,{weight:c.weight},u)}function r(i){i.graph().dummyChains.forEach(s=>{let o=i.node(s),a=o.edgeLabel,l;for(i.setEdge(o.edgeObj,a);o.dummy;)l=i.successors(s)[0],i.removeNode(s),a.points.push({x:o.x,y:o.y}),o.dummy==="edge-label"&&(a.x=o.x,a.y=o.y,a.width=o.width,a.height=o.height),s=l,o=i.node(s)})}return Bn}var Gn,Li;function Vt(){if(Li)return Gn;Li=1;const{applyWithChunking:e}=ae();Gn={longestPath:t,slack:n};function t(r){var i={};function s(o){var a=r.node(o);if(Object.hasOwn(i,o))return a.rank;i[o]=!0;let l=r.outEdges(o).map(u=>u==null?Number.POSITIVE_INFINITY:s(u.w)-r.edge(u).minlen);var d=e(Math.min,l);return d===Number.POSITIVE_INFINITY&&(d=0),a.rank=d}r.sources().forEach(s)}function n(r,i){return r.node(i.w).rank-r.node(i.v).rank-r.edge(i).minlen}return Gn}var Yn,Di;function ks(){if(Di)return Yn;Di=1;var e=me().Graph,t=Vt().slack;Yn=n;function n(o){var a=new e({directed:!1}),l=o.nodes()[0],d=o.nodeCount();a.setNode(l,{});for(var u,c;r(a,o)<d;)u=i(a,o),c=a.hasNode(u.v)?t(o,u):-t(o,u),s(a,o,c);return a}function r(o,a){function l(d){a.nodeEdges(d).forEach(u=>{var c=u.v,f=d===c?u.w:c;!o.hasNode(f)&&!t(a,u)&&(o.setNode(f,{}),o.setEdge(d,f,{}),l(f))})}return o.nodes().forEach(l),o.nodeCount()}function i(o,a){return a.edges().reduce((d,u)=>{let c=Number.POSITIVE_INFINITY;return o.hasNode(u.v)!==o.hasNode(u.w)&&(c=t(a,u)),c<d[0]?[c,u]:d},[Number.POSITIVE_INFINITY,null])[1]}function s(o,a,l){o.nodes().forEach(d=>a.node(d).rank+=l)}return Yn}var Xn,ji;function zl(){if(ji)return Xn;ji=1;var e=ks(),t=Vt().slack,n=Vt().longestPath,r=me().alg.preorder,i=me().alg.postorder,s=ae().simplify;Xn=o,o.initLowLimValues=u,o.initCutValues=a,o.calcCutValue=d,o.leaveEdge=f,o.enterEdge=h,o.exchangeEdges=p;function o(v){v=s(v),n(v);var g=e(v);u(g),a(g,v);for(var w,N;w=f(g);)N=h(g,v,w),p(g,v,w,N)}function a(v,g){var w=i(v,v.nodes());w=w.slice(0,w.length-1),w.forEach(N=>l(v,g,N))}function l(v,g,w){var N=v.node(w),k=N.parent;v.edge(w,k).cutvalue=d(v,g,w)}function d(v,g,w){var N=v.node(w),k=N.parent,C=!0,E=g.edge(w,k),_=0;return E||(C=!1,E=g.edge(k,w)),_=E.weight,g.nodeEdges(w).forEach(S=>{var R=S.v===w,I=R?S.w:S.v;if(I!==k){var D=R===C,b=g.edge(S).weight;if(_+=D?b:-b,x(v,w,I)){var T=v.edge(w,I).cutvalue;_+=D?-T:T}}}),_}function u(v,g){arguments.length<2&&(g=v.nodes()[0]),c(v,{},1,g)}function c(v,g,w,N,k){var C=w,E=v.node(N);return g[N]=!0,v.neighbors(N).forEach(_=>{Object.hasOwn(g,_)||(w=c(v,g,w,_,N))}),E.low=C,E.lim=w++,k?E.parent=k:delete E.parent,w}function f(v){return v.edges().find(g=>v.edge(g).cutvalue<0)}function h(v,g,w){var N=w.v,k=w.w;g.hasEdge(N,k)||(N=w.w,k=w.v);var C=v.node(N),E=v.node(k),_=C,S=!1;C.lim>E.lim&&(_=E,S=!0);var R=g.edges().filter(I=>S===y(v,v.node(I.v),_)&&S!==y(v,v.node(I.w),_));return R.reduce((I,D)=>t(g,D)<t(g,I)?D:I)}function p(v,g,w,N){var k=w.v,C=w.w;v.removeEdge(k,C),v.setEdge(N.v,N.w,{}),u(v),a(v,g),m(v,g)}function m(v,g){var w=v.nodes().find(k=>!g.node(k).parent),N=r(v,w);N=N.slice(1),N.forEach(k=>{var C=v.node(k).parent,E=g.edge(k,C),_=!1;E||(E=g.edge(C,k),_=!0),g.node(k).rank=g.node(C).rank+(_?E.minlen:-E.minlen)})}function x(v,g,w){return v.hasEdge(g,w)}function y(v,g,w){return w.low<=g.lim&&g.lim<=w.lim}return Xn}var Wn,Hi;function Fl(){if(Hi)return Wn;Hi=1;var e=Vt(),t=e.longestPath,n=ks(),r=zl();Wn=i;function i(l){switch(l.graph().ranker){case"network-simplex":a(l);break;case"tight-tree":o(l);break;case"longest-path":s(l);break;default:a(l)}}var s=t;function o(l){t(l),n(l)}function a(l){r(l)}return Wn}var Un,zi;function Vl(){if(zi)return Un;zi=1,Un=e;function e(r){let i=n(r);r.graph().dummyChains.forEach(s=>{let o=r.node(s),a=o.edgeObj,l=t(r,i,a.v,a.w),d=l.path,u=l.lca,c=0,f=d[c],h=!0;for(;s!==a.w;){if(o=r.node(s),h){for(;(f=d[c])!==u&&r.node(f).maxRank<o.rank;)c++;f===u&&(h=!1)}if(!h){for(;c<d.length-1&&r.node(f=d[c+1]).minRank<=o.rank;)c++;f=d[c]}r.setParent(s,f),s=r.successors(s)[0]}})}function t(r,i,s,o){let a=[],l=[],d=Math.min(i[s].low,i[o].low),u=Math.max(i[s].lim,i[o].lim),c,f;c=s;do c=r.parent(c),a.push(c);while(c&&(i[c].low>d||u>i[c].lim));for(f=c,c=o;(c=r.parent(c))!==f;)l.push(c);return{path:a.concat(l.reverse()),lca:f}}function n(r){let i={},s=0;function o(a){let l=s;r.children(a).forEach(o),i[a]={low:l,lim:s++}}return r.children().forEach(o),i}return Un}var Kn,Fi;function ql(){if(Fi)return Kn;Fi=1;let e=ae();Kn={run:t,cleanup:s};function t(o){let a=e.addDummyNode(o,"root",{},"_root"),l=r(o),d=Object.values(l),u=e.applyWithChunking(Math.max,d)-1,c=2*u+1;o.graph().nestingRoot=a,o.edges().forEach(h=>o.edge(h).minlen*=c);let f=i(o)+1;o.children().forEach(h=>n(o,a,c,f,u,l,h)),o.graph().nodeRankFactor=c}function n(o,a,l,d,u,c,f){let h=o.children(f);if(!h.length){f!==a&&o.setEdge(a,f,{weight:0,minlen:l});return}let p=e.addBorderNode(o,"_bt"),m=e.addBorderNode(o,"_bb"),x=o.node(f);o.setParent(p,f),x.borderTop=p,o.setParent(m,f),x.borderBottom=m,h.forEach(y=>{n(o,a,l,d,u,c,y);let v=o.node(y),g=v.borderTop?v.borderTop:y,w=v.borderBottom?v.borderBottom:y,N=v.borderTop?d:2*d,k=g!==w?1:u-c[f]+1;o.setEdge(p,g,{weight:N,minlen:k,nestingEdge:!0}),o.setEdge(w,m,{weight:N,minlen:k,nestingEdge:!0})}),o.parent(f)||o.setEdge(a,p,{weight:0,minlen:u+c[f]})}function r(o){var a={};function l(d,u){var c=o.children(d);c&&c.length&&c.forEach(f=>l(f,u+1)),a[d]=u}return o.children().forEach(d=>l(d,1)),a}function i(o){return o.edges().reduce((a,l)=>a+o.edge(l).weight,0)}function s(o){var a=o.graph();o.removeNode(a.nestingRoot),delete a.nestingRoot,o.edges().forEach(l=>{var d=o.edge(l);d.nestingEdge&&o.removeEdge(l)})}return Kn}var Zn,Vi;function Bl(){if(Vi)return Zn;Vi=1;let e=ae();Zn=t;function t(r){function i(s){let o=r.children(s),a=r.node(s);if(o.length&&o.forEach(i),Object.hasOwn(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(let l=a.minRank,d=a.maxRank+1;l<d;++l)n(r,"borderLeft","_bl",s,a,l),n(r,"borderRight","_br",s,a,l)}}r.children().forEach(i)}function n(r,i,s,o,a,l){let d={width:0,height:0,rank:l,borderType:i},u=a[i][l-1],c=e.addDummyNode(r,"border",d,s);a[i][l]=c,r.setParent(c,o),u&&r.setEdge(u,c,{weight:1})}return Zn}var Qn,qi;function Gl(){if(qi)return Qn;qi=1,Qn={adjust:e,undo:t};function e(l){let d=l.graph().rankdir.toLowerCase();(d==="lr"||d==="rl")&&n(l)}function t(l){let d=l.graph().rankdir.toLowerCase();(d==="bt"||d==="rl")&&i(l),(d==="lr"||d==="rl")&&(o(l),n(l))}function n(l){l.nodes().forEach(d=>r(l.node(d))),l.edges().forEach(d=>r(l.edge(d)))}function r(l){let d=l.width;l.width=l.height,l.height=d}function i(l){l.nodes().forEach(d=>s(l.node(d))),l.edges().forEach(d=>{let u=l.edge(d);u.points.forEach(s),Object.hasOwn(u,"y")&&s(u)})}function s(l){l.y=-l.y}function o(l){l.nodes().forEach(d=>a(l.node(d))),l.edges().forEach(d=>{let u=l.edge(d);u.points.forEach(a),Object.hasOwn(u,"x")&&a(u)})}function a(l){let d=l.x;l.x=l.y,l.y=d}return Qn}var Jn,Bi;function Yl(){if(Bi)return Jn;Bi=1;let e=ae();Jn=t;function t(n){let r={},i=n.nodes().filter(u=>!n.children(u).length),s=i.map(u=>n.node(u).rank),o=e.applyWithChunking(Math.max,s),a=e.range(o+1).map(()=>[]);function l(u){if(r[u])return;r[u]=!0;let c=n.node(u);a[c.rank].push(u),n.successors(u).forEach(l)}return i.sort((u,c)=>n.node(u).rank-n.node(c).rank).forEach(l),a}return Jn}var er,Gi;function Xl(){if(Gi)return er;Gi=1;let e=ae().zipObject;er=t;function t(r,i){let s=0;for(let o=1;o<i.length;++o)s+=n(r,i[o-1],i[o]);return s}function n(r,i,s){let o=e(s,s.map((f,h)=>h)),a=i.flatMap(f=>r.outEdges(f).map(h=>({pos:o[h.w],weight:r.edge(h).weight})).sort((h,p)=>h.pos-p.pos)),l=1;for(;l<s.length;)l<<=1;let d=2*l-1;l-=1;let u=new Array(d).fill(0),c=0;return a.forEach(f=>{let h=f.pos+l;u[h]+=f.weight;let p=0;for(;h>0;)h%2&&(p+=u[h+1]),h=h-1>>1,u[h]+=f.weight;c+=f.weight*p}),c}return er}var tr,Yi;function Wl(){if(Yi)return tr;Yi=1,tr=e;function e(t,n=[]){return n.map(r=>{let i=t.inEdges(r);if(i.length){let s=i.reduce((o,a)=>{let l=t.edge(a),d=t.node(a.v);return{sum:o.sum+l.weight*d.order,weight:o.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:r}})}return tr}var nr,Xi;function Ul(){if(Xi)return nr;Xi=1;let e=ae();nr=t;function t(i,s){let o={};i.forEach((l,d)=>{let u=o[l.v]={indegree:0,in:[],out:[],vs:[l.v],i:d};l.barycenter!==void 0&&(u.barycenter=l.barycenter,u.weight=l.weight)}),s.edges().forEach(l=>{let d=o[l.v],u=o[l.w];d!==void 0&&u!==void 0&&(u.indegree++,d.out.push(o[l.w]))});let a=Object.values(o).filter(l=>!l.indegree);return n(a)}function n(i){let s=[];function o(l){return d=>{d.merged||(d.barycenter===void 0||l.barycenter===void 0||d.barycenter>=l.barycenter)&&r(l,d)}}function a(l){return d=>{d.in.push(l),--d.indegree===0&&i.push(d)}}for(;i.length;){let l=i.pop();s.push(l),l.in.reverse().forEach(o(l)),l.out.forEach(a(l))}return s.filter(l=>!l.merged).map(l=>e.pick(l,["vs","i","barycenter","weight"]))}function r(i,s){let o=0,a=0;i.weight&&(o+=i.barycenter*i.weight,a+=i.weight),s.weight&&(o+=s.barycenter*s.weight,a+=s.weight),i.vs=s.vs.concat(i.vs),i.barycenter=o/a,i.weight=a,i.i=Math.min(s.i,i.i),s.merged=!0}return nr}var rr,Wi;function Kl(){if(Wi)return rr;Wi=1;let e=ae();rr=t;function t(i,s){let o=e.partition(i,p=>Object.hasOwn(p,"barycenter")),a=o.lhs,l=o.rhs.sort((p,m)=>m.i-p.i),d=[],u=0,c=0,f=0;a.sort(r(!!s)),f=n(d,l,f),a.forEach(p=>{f+=p.vs.length,d.push(p.vs),u+=p.barycenter*p.weight,c+=p.weight,f=n(d,l,f)});let h={vs:d.flat(!0)};return c&&(h.barycenter=u/c,h.weight=c),h}function n(i,s,o){let a;for(;s.length&&(a=s[s.length-1]).i<=o;)s.pop(),i.push(a.vs),o++;return o}function r(i){return(s,o)=>s.barycenter<o.barycenter?-1:s.barycenter>o.barycenter?1:i?o.i-s.i:s.i-o.i}return rr}var ir,Ui;function Zl(){if(Ui)return ir;Ui=1;let e=Wl(),t=Ul(),n=Kl();ir=r;function r(o,a,l,d){let u=o.children(a),c=o.node(a),f=c?c.borderLeft:void 0,h=c?c.borderRight:void 0,p={};f&&(u=u.filter(v=>v!==f&&v!==h));let m=e(o,u);m.forEach(v=>{if(o.children(v.v).length){let g=r(o,v.v,l,d);p[v.v]=g,Object.hasOwn(g,"barycenter")&&s(v,g)}});let x=t(m,l);i(x,p);let y=n(x,d);if(f&&(y.vs=[f,y.vs,h].flat(!0),o.predecessors(f).length)){let v=o.node(o.predecessors(f)[0]),g=o.node(o.predecessors(h)[0]);Object.hasOwn(y,"barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+v.order+g.order)/(y.weight+2),y.weight+=2}return y}function i(o,a){o.forEach(l=>{l.vs=l.vs.flatMap(d=>a[d]?a[d].vs:d)})}function s(o,a){o.barycenter!==void 0?(o.barycenter=(o.barycenter*o.weight+a.barycenter*a.weight)/(o.weight+a.weight),o.weight+=a.weight):(o.barycenter=a.barycenter,o.weight=a.weight)}return ir}var or,Ki;function Ql(){if(Ki)return or;Ki=1;let e=me().Graph,t=ae();or=n;function n(i,s,o){let a=r(i),l=new e({compound:!0}).setGraph({root:a}).setDefaultNodeLabel(d=>i.node(d));return i.nodes().forEach(d=>{let u=i.node(d),c=i.parent(d);(u.rank===s||u.minRank<=s&&s<=u.maxRank)&&(l.setNode(d),l.setParent(d,c||a),i[o](d).forEach(f=>{let h=f.v===d?f.w:f.v,p=l.edge(h,d),m=p!==void 0?p.weight:0;l.setEdge(h,d,{weight:i.edge(f).weight+m})}),Object.hasOwn(u,"minRank")&&l.setNode(d,{borderLeft:u.borderLeft[s],borderRight:u.borderRight[s]}))}),l}function r(i){for(var s;i.hasNode(s=t.uniqueId("_root")););return s}return or}var sr,Zi;function Jl(){if(Zi)return sr;Zi=1,sr=e;function e(t,n,r){let i={},s;r.forEach(o=>{let a=t.parent(o),l,d;for(;a;){if(l=t.parent(a),l?(d=i[l],i[l]=a):(d=s,s=a),d&&d!==a){n.setEdge(d,a);return}a=l}})}return sr}var ar,Qi;function eu(){if(Qi)return ar;Qi=1;let e=Yl(),t=Xl(),n=Zl(),r=Ql(),i=Jl(),s=me().Graph,o=ae();ar=a;function a(c,f){if(f&&typeof f.customOrder=="function"){f.customOrder(c,a);return}let h=o.maxRank(c),p=l(c,o.range(1,h+1),"inEdges"),m=l(c,o.range(h-1,-1,-1),"outEdges"),x=e(c);if(u(c,x),f&&f.disableOptimalOrderHeuristic)return;let y=Number.POSITIVE_INFINITY,v;for(let g=0,w=0;w<4;++g,++w){d(g%2?p:m,g%4>=2),x=o.buildLayerMatrix(c);let N=t(c,x);N<y&&(w=0,v=Object.assign({},x),y=N)}u(c,v)}function l(c,f,h){return f.map(function(p){return r(c,p,h)})}function d(c,f){let h=new s;c.forEach(function(p){let m=p.graph().root,x=n(p,m,h,f);x.vs.forEach((y,v)=>p.node(y).order=v),i(p,h,x.vs)})}function u(c,f){Object.values(f).forEach(h=>h.forEach((p,m)=>c.node(p).order=m))}return ar}var cr,Ji;function tu(){if(Ji)return cr;Ji=1;let e=me().Graph,t=ae();cr={positionX:h,findType1Conflicts:n,findType2Conflicts:r,addConflict:s,hasConflict:o,verticalAlignment:a,horizontalCompaction:l,alignCoordinates:c,findSmallestWidthAlignment:u,balance:f};function n(x,y){let v={};function g(w,N){let k=0,C=0,E=w.length,_=N[N.length-1];return N.forEach((S,R)=>{let I=i(x,S),D=I?x.node(I).order:E;(I||S===_)&&(N.slice(C,R+1).forEach(b=>{x.predecessors(b).forEach(T=>{let M=x.node(T),O=M.order;(O<k||D<O)&&!(M.dummy&&x.node(b).dummy)&&s(v,T,b)})}),C=R+1,k=D)}),N}return y.length&&y.reduce(g),v}function r(x,y){let v={};function g(N,k,C,E,_){let S;t.range(k,C).forEach(R=>{S=N[R],x.node(S).dummy&&x.predecessors(S).forEach(I=>{let D=x.node(I);D.dummy&&(D.order<E||D.order>_)&&s(v,I,S)})})}function w(N,k){let C=-1,E,_=0;return k.forEach((S,R)=>{if(x.node(S).dummy==="border"){let I=x.predecessors(S);I.length&&(E=x.node(I[0]).order,g(k,_,R,C,E),_=R,C=E)}g(k,_,k.length,E,N.length)}),k}return y.length&&y.reduce(w),v}function i(x,y){if(x.node(y).dummy)return x.predecessors(y).find(v=>x.node(v).dummy)}function s(x,y,v){if(y>v){let w=y;y=v,v=w}let g=x[y];g||(x[y]=g={}),g[v]=!0}function o(x,y,v){if(y>v){let g=y;y=v,v=g}return!!x[y]&&Object.hasOwn(x[y],v)}function a(x,y,v,g){let w={},N={},k={};return y.forEach(C=>{C.forEach((E,_)=>{w[E]=E,N[E]=E,k[E]=_})}),y.forEach(C=>{let E=-1;C.forEach(_=>{let S=g(_);if(S.length){S=S.sort((I,D)=>k[I]-k[D]);let R=(S.length-1)/2;for(let I=Math.floor(R),D=Math.ceil(R);I<=D;++I){let b=S[I];N[_]===_&&E<k[b]&&!o(v,_,b)&&(N[b]=_,N[_]=w[_]=w[b],E=k[b])}}})}),{root:w,align:N}}function l(x,y,v,g,w){let N={},k=d(x,y,v,w),C=w?"borderLeft":"borderRight";function E(R,I){let D=k.nodes(),b=D.pop(),T={};for(;b;)T[b]?R(b):(T[b]=!0,D.push(b),D=D.concat(I(b))),b=D.pop()}function _(R){N[R]=k.inEdges(R).reduce((I,D)=>Math.max(I,N[D.v]+k.edge(D)),0)}function S(R){let I=k.outEdges(R).reduce((b,T)=>Math.min(b,N[T.w]-k.edge(T)),Number.POSITIVE_INFINITY),D=x.node(R);I!==Number.POSITIVE_INFINITY&&D.borderType!==C&&(N[R]=Math.max(N[R],I))}return E(_,k.predecessors.bind(k)),E(S,k.successors.bind(k)),Object.keys(g).forEach(R=>N[R]=N[v[R]]),N}function d(x,y,v,g){let w=new e,N=x.graph(),k=p(N.nodesep,N.edgesep,g);return y.forEach(C=>{let E;C.forEach(_=>{let S=v[_];if(w.setNode(S),E){var R=v[E],I=w.edge(R,S);w.setEdge(R,S,Math.max(k(x,_,E),I||0))}E=_})}),w}function u(x,y){return Object.values(y).reduce((v,g)=>{let w=Number.NEGATIVE_INFINITY,N=Number.POSITIVE_INFINITY;Object.entries(g).forEach(([C,E])=>{let _=m(x,C)/2;w=Math.max(E+_,w),N=Math.min(E-_,N)});const k=w-N;return k<v[0]&&(v=[k,g]),v},[Number.POSITIVE_INFINITY,null])[1]}function c(x,y){let v=Object.values(y),g=t.applyWithChunking(Math.min,v),w=t.applyWithChunking(Math.max,v);["u","d"].forEach(N=>{["l","r"].forEach(k=>{let C=N+k,E=x[C];if(E===y)return;let _=Object.values(E),S=g-t.applyWithChunking(Math.min,_);k!=="l"&&(S=w-t.applyWithChunking(Math.max,_)),S&&(x[C]=t.mapValues(E,R=>R+S))})})}function f(x,y){return t.mapValues(x.ul,(v,g)=>{if(y)return x[y.toLowerCase()][g];{let w=Object.values(x).map(N=>N[g]).sort((N,k)=>N-k);return(w[1]+w[2])/2}})}function h(x){let y=t.buildLayerMatrix(x),v=Object.assign(n(x,y),r(x,y)),g={},w;["u","d"].forEach(k=>{w=k==="u"?y:Object.values(y).reverse(),["l","r"].forEach(C=>{C==="r"&&(w=w.map(R=>Object.values(R).reverse()));let E=(k==="u"?x.predecessors:x.successors).bind(x),_=a(x,w,v,E),S=l(x,w,_.root,_.align,C==="r");C==="r"&&(S=t.mapValues(S,R=>-R)),g[k+C]=S})});let N=u(x,g);return c(g,N),f(g,x.graph().align)}function p(x,y,v){return(g,w,N)=>{let k=g.node(w),C=g.node(N),E=0,_;if(E+=k.width/2,Object.hasOwn(k,"labelpos"))switch(k.labelpos.toLowerCase()){case"l":_=-k.width/2;break;case"r":_=k.width/2;break}if(_&&(E+=v?_:-_),_=0,E+=(k.dummy?y:x)/2,E+=(C.dummy?y:x)/2,E+=C.width/2,Object.hasOwn(C,"labelpos"))switch(C.labelpos.toLowerCase()){case"l":_=C.width/2;break;case"r":_=-C.width/2;break}return _&&(E+=v?_:-_),_=0,E}}function m(x,y){return x.node(y).width}return cr}var lr,eo;function nu(){if(eo)return lr;eo=1;let e=ae(),t=tu().positionX;lr=n;function n(i){i=e.asNonCompoundGraph(i),r(i),Object.entries(t(i)).forEach(([s,o])=>i.node(s).x=o)}function r(i){let s=e.buildLayerMatrix(i),o=i.graph().ranksep,a=0;s.forEach(l=>{const d=l.reduce((u,c)=>{const f=i.node(c).height;return u>f?u:f},0);l.forEach(u=>i.node(u).y=a+d/2),a+=d+o})}return lr}var ur,to;function ru(){if(to)return ur;to=1;let e=jl(),t=Hl(),n=Fl(),r=ae().normalizeRanks,i=Vl(),s=ae().removeEmptyRanks,o=ql(),a=Bl(),l=Gl(),d=eu(),u=nu(),c=ae(),f=me().Graph;ur=h;function h(A,$){let L=$&&$.debugTiming?c.time:c.notime;L("layout",()=>{let F=L("  buildLayoutGraph",()=>E(A));L("  runLayout",()=>p(F,L,$)),L("  updateInputGraph",()=>m(A,F))})}function p(A,$,L){$("    makeSpaceForEdgeLabels",()=>_(A)),$("    removeSelfEdges",()=>j(A)),$("    acyclic",()=>e.run(A)),$("    nestingGraph.run",()=>o.run(A)),$("    rank",()=>n(c.asNonCompoundGraph(A))),$("    injectEdgeLabelProxies",()=>S(A)),$("    removeEmptyRanks",()=>s(A)),$("    nestingGraph.cleanup",()=>o.cleanup(A)),$("    normalizeRanks",()=>r(A)),$("    assignRankMinMax",()=>R(A)),$("    removeEdgeLabelProxies",()=>I(A)),$("    normalize.run",()=>t.run(A)),$("    parentDummyChains",()=>i(A)),$("    addBorderSegments",()=>a(A)),$("    order",()=>d(A,L)),$("    insertSelfEdges",()=>P(A)),$("    adjustCoordinateSystem",()=>l.adjust(A)),$("    position",()=>u(A)),$("    positionSelfEdges",()=>V(A)),$("    removeBorderNodes",()=>O(A)),$("    normalize.undo",()=>t.undo(A)),$("    fixupEdgeLabelCoords",()=>T(A)),$("    undoCoordinateSystem",()=>l.undo(A)),$("    translateGraph",()=>D(A)),$("    assignNodeIntersects",()=>b(A)),$("    reversePoints",()=>M(A)),$("    acyclic.undo",()=>e.undo(A))}function m(A,$){A.nodes().forEach(L=>{let F=A.node(L),q=$.node(L);F&&(F.x=q.x,F.y=q.y,F.rank=q.rank,$.children(L).length&&(F.width=q.width,F.height=q.height))}),A.edges().forEach(L=>{let F=A.edge(L),q=$.edge(L);F.points=q.points,Object.hasOwn(q,"x")&&(F.x=q.x,F.y=q.y)}),A.graph().width=$.graph().width,A.graph().height=$.graph().height}let x=["nodesep","edgesep","ranksep","marginx","marginy"],y={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},v=["acyclicer","ranker","rankdir","align"],g=["width","height"],w={width:0,height:0},N=["minlen","weight","width","height","labeloffset"],k={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},C=["labelpos"];function E(A){let $=new f({multigraph:!0,compound:!0}),L=G(A.graph());return $.setGraph(Object.assign({},y,B(L,x),c.pick(L,v))),A.nodes().forEach(F=>{let q=G(A.node(F));const Y=B(q,g);Object.keys(w).forEach(K=>{Y[K]===void 0&&(Y[K]=w[K])}),$.setNode(F,Y),$.setParent(F,A.parent(F))}),A.edges().forEach(F=>{let q=G(A.edge(F));$.setEdge(F,Object.assign({},k,B(q,N),c.pick(q,C)))}),$}function _(A){let $=A.graph();$.ranksep/=2,A.edges().forEach(L=>{let F=A.edge(L);F.minlen*=2,F.labelpos.toLowerCase()!=="c"&&($.rankdir==="TB"||$.rankdir==="BT"?F.width+=F.labeloffset:F.height+=F.labeloffset)})}function S(A){A.edges().forEach($=>{let L=A.edge($);if(L.width&&L.height){let F=A.node($.v),Y={rank:(A.node($.w).rank-F.rank)/2+F.rank,e:$};c.addDummyNode(A,"edge-proxy",Y,"_ep")}})}function R(A){let $=0;A.nodes().forEach(L=>{let F=A.node(L);F.borderTop&&(F.minRank=A.node(F.borderTop).rank,F.maxRank=A.node(F.borderBottom).rank,$=Math.max($,F.maxRank))}),A.graph().maxRank=$}function I(A){A.nodes().forEach($=>{let L=A.node($);L.dummy==="edge-proxy"&&(A.edge(L.e).labelRank=L.rank,A.removeNode($))})}function D(A){let $=Number.POSITIVE_INFINITY,L=0,F=Number.POSITIVE_INFINITY,q=0,Y=A.graph(),K=Y.marginx||0,J=Y.marginy||0;function Q(U){let Z=U.x,te=U.y,ie=U.width,le=U.height;$=Math.min($,Z-ie/2),L=Math.max(L,Z+ie/2),F=Math.min(F,te-le/2),q=Math.max(q,te+le/2)}A.nodes().forEach(U=>Q(A.node(U))),A.edges().forEach(U=>{let Z=A.edge(U);Object.hasOwn(Z,"x")&&Q(Z)}),$-=K,F-=J,A.nodes().forEach(U=>{let Z=A.node(U);Z.x-=$,Z.y-=F}),A.edges().forEach(U=>{let Z=A.edge(U);Z.points.forEach(te=>{te.x-=$,te.y-=F}),Object.hasOwn(Z,"x")&&(Z.x-=$),Object.hasOwn(Z,"y")&&(Z.y-=F)}),Y.width=L-$+K,Y.height=q-F+J}function b(A){A.edges().forEach($=>{let L=A.edge($),F=A.node($.v),q=A.node($.w),Y,K;L.points?(Y=L.points[0],K=L.points[L.points.length-1]):(L.points=[],Y=q,K=F),L.points.unshift(c.intersectRect(F,Y)),L.points.push(c.intersectRect(q,K))})}function T(A){A.edges().forEach($=>{let L=A.edge($);if(Object.hasOwn(L,"x"))switch((L.labelpos==="l"||L.labelpos==="r")&&(L.width-=L.labeloffset),L.labelpos){case"l":L.x-=L.width/2+L.labeloffset;break;case"r":L.x+=L.width/2+L.labeloffset;break}})}function M(A){A.edges().forEach($=>{let L=A.edge($);L.reversed&&L.points.reverse()})}function O(A){A.nodes().forEach($=>{if(A.children($).length){let L=A.node($),F=A.node(L.borderTop),q=A.node(L.borderBottom),Y=A.node(L.borderLeft[L.borderLeft.length-1]),K=A.node(L.borderRight[L.borderRight.length-1]);L.width=Math.abs(K.x-Y.x),L.height=Math.abs(q.y-F.y),L.x=Y.x+L.width/2,L.y=F.y+L.height/2}}),A.nodes().forEach($=>{A.node($).dummy==="border"&&A.removeNode($)})}function j(A){A.edges().forEach($=>{if($.v===$.w){var L=A.node($.v);L.selfEdges||(L.selfEdges=[]),L.selfEdges.push({e:$,label:A.edge($)}),A.removeEdge($)}})}function P(A){var $=c.buildLayerMatrix(A);$.forEach(L=>{var F=0;L.forEach((q,Y)=>{var K=A.node(q);K.order=Y+F,(K.selfEdges||[]).forEach(J=>{c.addDummyNode(A,"selfedge",{width:J.label.width,height:J.label.height,rank:K.rank,order:Y+ ++F,e:J.e,label:J.label},"_se")}),delete K.selfEdges})})}function V(A){A.nodes().forEach($=>{var L=A.node($);if(L.dummy==="selfedge"){var F=A.node(L.e.v),q=F.x+F.width/2,Y=F.y,K=L.x-q,J=F.height/2;A.setEdge(L.e,L.label),A.removeNode($),L.label.points=[{x:q+2*K/3,y:Y-J},{x:q+5*K/6,y:Y-J},{x:q+K,y:Y},{x:q+5*K/6,y:Y+J},{x:q+2*K/3,y:Y+J}],L.label.x=L.x,L.label.y=L.y}})}function B(A,$){return c.mapValues(c.pick(A,$),Number)}function G(A){var $={};return A&&Object.entries(A).forEach(([L,F])=>{typeof L=="string"&&(L=L.toLowerCase()),$[L]=F}),$}return ur}var dr,no;function iu(){if(no)return dr;no=1;let e=ae(),t=me().Graph;dr={debugOrdering:n};function n(r){let i=e.buildLayerMatrix(r),s=new t({compound:!0,multigraph:!0}).setGraph({});return r.nodes().forEach(o=>{s.setNode(o,{label:o}),s.setParent(o,"layer"+r.node(o).rank)}),r.edges().forEach(o=>s.setEdge(o.v,o.w,{},o.name)),i.forEach((o,a)=>{let l="layer"+a;s.setNode(l,{rank:"same"}),o.reduce((d,u)=>(s.setEdge(d,u,{style:"invis"}),u))}),s}return dr}var fr,ro;function ou(){return ro||(ro=1,fr="1.1.4"),fr}var hr,io;function su(){return io||(io=1,hr={graphlib:me(),layout:ru(),debug:iu(),util:{time:ae().time,notime:ae().notime},version:ou()}),hr}var au=su();const oo=xs(au);function ce(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ce(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var cu={value:()=>{}};function Jt(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new jt(n)}function jt(e){this._=e}function lu(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}jt.prototype=Jt.prototype={constructor:jt,on:function(e,t){var n=this._,r=lu(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=uu(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=so(n[i],e.name,t);else if(t==null)for(i in n)n[i]=so(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new jt(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function uu(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function so(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=cu,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Cr="http://www.w3.org/1999/xhtml";const ao={svg:"http://www.w3.org/2000/svg",xhtml:Cr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function en(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),ao.hasOwnProperty(t)?{space:ao[t],local:e}:e}function du(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Cr&&t.documentElement.namespaceURI===Cr?t.createElement(e):t.createElementNS(n,e)}}function fu(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Cs(e){var t=en(e);return(t.local?fu:du)(t)}function hu(){}function Gr(e){return e==null?hu:function(){return this.querySelector(e)}}function pu(e){typeof e!="function"&&(e=Gr(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=new Array(o),l,d,u=0;u<o;++u)(l=s[u])&&(d=e.call(l,l.__data__,u,s))&&("__data__"in l&&(d.__data__=l.__data__),a[u]=d);return new fe(r,this._parents)}function gu(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function mu(){return[]}function Ms(e){return e==null?mu:function(){return this.querySelectorAll(e)}}function yu(e){return function(){return gu(e.apply(this,arguments))}}function wu(e){typeof e=="function"?e=yu(e):e=Ms(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],a=o.length,l,d=0;d<a;++d)(l=o[d])&&(r.push(e.call(l,l.__data__,d,o)),i.push(l));return new fe(r,i)}function Rs(e){return function(){return this.matches(e)}}function Is(e){return function(t){return t.matches(e)}}var xu=Array.prototype.find;function vu(e){return function(){return xu.call(this.children,e)}}function bu(){return this.firstElementChild}function Eu(e){return this.select(e==null?bu:vu(typeof e=="function"?e:Is(e)))}var _u=Array.prototype.filter;function Nu(){return Array.from(this.children)}function Su(e){return function(){return _u.call(this.children,e)}}function ku(e){return this.selectAll(e==null?Nu:Su(typeof e=="function"?e:Is(e)))}function Cu(e){typeof e!="function"&&(e=Rs(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],l,d=0;d<o;++d)(l=s[d])&&e.call(l,l.__data__,d,s)&&a.push(l);return new fe(r,this._parents)}function Ts(e){return new Array(e.length)}function Mu(){return new fe(this._enter||this._groups.map(Ts),this._parents)}function qt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}qt.prototype={constructor:qt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Ru(e){return function(){return e}}function Iu(e,t,n,r,i,s){for(var o=0,a,l=t.length,d=s.length;o<d;++o)(a=t[o])?(a.__data__=s[o],r[o]=a):n[o]=new qt(e,s[o]);for(;o<l;++o)(a=t[o])&&(i[o]=a)}function Tu(e,t,n,r,i,s,o){var a,l,d=new Map,u=t.length,c=s.length,f=new Array(u),h;for(a=0;a<u;++a)(l=t[a])&&(f[a]=h=o.call(l,l.__data__,a,t)+"",d.has(h)?i[a]=l:d.set(h,l));for(a=0;a<c;++a)h=o.call(e,s[a],a,s)+"",(l=d.get(h))?(r[a]=l,l.__data__=s[a],d.delete(h)):n[a]=new qt(e,s[a]);for(a=0;a<u;++a)(l=t[a])&&d.get(f[a])===l&&(i[a]=l)}function Au(e){return e.__data__}function Pu(e,t){if(!arguments.length)return Array.from(this,Au);var n=t?Tu:Iu,r=this._parents,i=this._groups;typeof e!="function"&&(e=Ru(e));for(var s=i.length,o=new Array(s),a=new Array(s),l=new Array(s),d=0;d<s;++d){var u=r[d],c=i[d],f=c.length,h=$u(e.call(u,u&&u.__data__,d,r)),p=h.length,m=a[d]=new Array(p),x=o[d]=new Array(p),y=l[d]=new Array(f);n(u,c,m,x,y,h,t);for(var v=0,g=0,w,N;v<p;++v)if(w=m[v]){for(v>=g&&(g=v+1);!(N=x[g])&&++g<p;);w._next=N||null}}return o=new fe(o,r),o._enter=a,o._exit=l,o}function $u(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ou(){return new fe(this._exit||this._groups.map(Ts),this._parents)}function Lu(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function Du(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),l=0;l<o;++l)for(var d=n[l],u=r[l],c=d.length,f=a[l]=new Array(c),h,p=0;p<c;++p)(h=d[p]||u[p])&&(f[p]=h);for(;l<i;++l)a[l]=n[l];return new fe(a,this._parents)}function ju(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function Hu(e){e||(e=zu);function t(c,f){return c&&f?e(c.__data__,f.__data__):!c-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,l=i[s]=new Array(a),d,u=0;u<a;++u)(d=o[u])&&(l[u]=d);l.sort(t)}return new fe(i,this._parents).order()}function zu(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Fu(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Vu(){return Array.from(this)}function qu(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function Bu(){let e=0;for(const t of this)++e;return e}function Gu(){return!this.node()}function Yu(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&e.call(a,a.__data__,s,i);return this}function Xu(e){return function(){this.removeAttribute(e)}}function Wu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Uu(e,t){return function(){this.setAttribute(e,t)}}function Ku(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Zu(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Qu(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Ju(e,t){var n=en(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Wu:Xu:typeof t=="function"?n.local?Qu:Zu:n.local?Ku:Uu)(n,t))}function As(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ed(e){return function(){this.style.removeProperty(e)}}function td(e,t,n){return function(){this.style.setProperty(e,t,n)}}function nd(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function rd(e,t,n){return arguments.length>1?this.each((t==null?ed:typeof t=="function"?nd:td)(e,t,n??"")):Ge(this.node(),e)}function Ge(e,t){return e.style.getPropertyValue(t)||As(e).getComputedStyle(e,null).getPropertyValue(t)}function id(e){return function(){delete this[e]}}function od(e,t){return function(){this[e]=t}}function sd(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function ad(e,t){return arguments.length>1?this.each((t==null?id:typeof t=="function"?sd:od)(e,t)):this.node()[e]}function Ps(e){return e.trim().split(/^|\s+/)}function Yr(e){return e.classList||new $s(e)}function $s(e){this._node=e,this._names=Ps(e.getAttribute("class")||"")}$s.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Os(e,t){for(var n=Yr(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Ls(e,t){for(var n=Yr(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function cd(e){return function(){Os(this,e)}}function ld(e){return function(){Ls(this,e)}}function ud(e,t){return function(){(t.apply(this,arguments)?Os:Ls)(this,e)}}function dd(e,t){var n=Ps(e+"");if(arguments.length<2){for(var r=Yr(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?ud:t?cd:ld)(n,t))}function fd(){this.textContent=""}function hd(e){return function(){this.textContent=e}}function pd(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function gd(e){return arguments.length?this.each(e==null?fd:(typeof e=="function"?pd:hd)(e)):this.node().textContent}function md(){this.innerHTML=""}function yd(e){return function(){this.innerHTML=e}}function wd(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function xd(e){return arguments.length?this.each(e==null?md:(typeof e=="function"?wd:yd)(e)):this.node().innerHTML}function vd(){this.nextSibling&&this.parentNode.appendChild(this)}function bd(){return this.each(vd)}function Ed(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _d(){return this.each(Ed)}function Nd(e){var t=typeof e=="function"?e:Cs(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Sd(){return null}function kd(e,t){var n=typeof e=="function"?e:Cs(e),r=t==null?Sd:typeof t=="function"?t:Gr(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Cd(){var e=this.parentNode;e&&e.removeChild(this)}function Md(){return this.each(Cd)}function Rd(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Id(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Td(e){return this.select(e?Id:Rd)}function Ad(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Pd(e){return function(t){e.call(this,t,this.__data__)}}function $d(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Od(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function Ld(e,t,n){return function(){var r=this.__on,i,s=Pd(t);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function Dd(e,t,n){var r=$d(e+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,d=a.length,u;l<d;++l)for(i=0,u=a[l];i<s;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(a=t?Ld:Od,i=0;i<s;++i)this.each(a(r[i],t,n));return this}function Ds(e,t,n){var r=As(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function jd(e,t){return function(){return Ds(this,e,t)}}function Hd(e,t){return function(){return Ds(this,e,t.apply(this,arguments))}}function zd(e,t){return this.each((typeof t=="function"?Hd:jd)(e,t))}function*Fd(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var js=[null];function fe(e,t){this._groups=e,this._parents=t}function xt(){return new fe([[document.documentElement]],js)}function Vd(){return this}fe.prototype=xt.prototype={constructor:fe,select:pu,selectAll:wu,selectChild:Eu,selectChildren:ku,filter:Cu,data:Pu,enter:Mu,exit:Ou,join:Lu,merge:Du,selection:Vd,order:ju,sort:Hu,call:Fu,nodes:Vu,node:qu,size:Bu,empty:Gu,each:Yu,attr:Ju,style:rd,property:ad,classed:dd,text:gd,html:xd,raise:bd,lower:_d,append:Nd,insert:kd,remove:Md,clone:Td,datum:Ad,on:Dd,dispatch:zd,[Symbol.iterator]:Fd};function de(e){return typeof e=="string"?new fe([[document.querySelector(e)]],[document.documentElement]):new fe([[e]],js)}function qd(e){let t;for(;t=e.sourceEvent;)e=t;return e}function he(e,t){if(e=qd(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const Bd={passive:!1},lt={capture:!0,passive:!1};function pr(e){e.stopImmediatePropagation()}function qe(e){e.preventDefault(),e.stopImmediatePropagation()}function Hs(e){var t=e.document.documentElement,n=de(e).on("dragstart.drag",qe,lt);"onselectstart"in t?n.on("selectstart.drag",qe,lt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function zs(e,t){var n=e.document.documentElement,r=de(e).on("dragstart.drag",null);t&&(r.on("click.drag",qe,lt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const kt=e=>()=>e;function Mr(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:l,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}Mr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Gd(e){return!e.ctrlKey&&!e.button}function Yd(){return this.parentNode}function Xd(e,t){return t??{x:e.x,y:e.y}}function Wd(){return navigator.maxTouchPoints||"ontouchstart"in this}function Fs(){var e=Gd,t=Yd,n=Xd,r=Wd,i={},s=Jt("start","drag","end"),o=0,a,l,d,u,c=0;function f(w){w.on("mousedown.drag",h).filter(r).on("touchstart.drag",x).on("touchmove.drag",y,Bd).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,N){if(!(u||!e.call(this,w,N))){var k=g(this,t.call(this,w,N),w,N,"mouse");k&&(de(w.view).on("mousemove.drag",p,lt).on("mouseup.drag",m,lt),Hs(w.view),pr(w),d=!1,a=w.clientX,l=w.clientY,k("start",w))}}function p(w){if(qe(w),!d){var N=w.clientX-a,k=w.clientY-l;d=N*N+k*k>c}i.mouse("drag",w)}function m(w){de(w.view).on("mousemove.drag mouseup.drag",null),zs(w.view,d),qe(w),i.mouse("end",w)}function x(w,N){if(e.call(this,w,N)){var k=w.changedTouches,C=t.call(this,w,N),E=k.length,_,S;for(_=0;_<E;++_)(S=g(this,C,w,N,k[_].identifier,k[_]))&&(pr(w),S("start",w,k[_]))}}function y(w){var N=w.changedTouches,k=N.length,C,E;for(C=0;C<k;++C)(E=i[N[C].identifier])&&(qe(w),E("drag",w,N[C]))}function v(w){var N=w.changedTouches,k=N.length,C,E;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),C=0;C<k;++C)(E=i[N[C].identifier])&&(pr(w),E("end",w,N[C]))}function g(w,N,k,C,E,_){var S=s.copy(),R=he(_||k,N),I,D,b;if((b=n.call(w,new Mr("beforestart",{sourceEvent:k,target:f,identifier:E,active:o,x:R[0],y:R[1],dx:0,dy:0,dispatch:S}),C))!=null)return I=b.x-R[0]||0,D=b.y-R[1]||0,function T(M,O,j){var P=R,V;switch(M){case"start":i[E]=T,V=o++;break;case"end":delete i[E],--o;case"drag":R=he(j||O,N),V=o;break}S.call(M,w,new Mr(M,{sourceEvent:O,subject:b,target:f,identifier:E,active:V,x:R[0]+I,y:R[1]+D,dx:R[0]-P[0],dy:R[1]-P[1],dispatch:S}),C)}}return f.filter=function(w){return arguments.length?(e=typeof w=="function"?w:kt(!!w),f):e},f.container=function(w){return arguments.length?(t=typeof w=="function"?w:kt(w),f):t},f.subject=function(w){return arguments.length?(n=typeof w=="function"?w:kt(w),f):n},f.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:kt(!!w),f):r},f.on=function(){var w=s.on.apply(s,arguments);return w===s?f:w},f.clickDistance=function(w){return arguments.length?(c=(w=+w)*w,f):Math.sqrt(c)},f}function Xr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Vs(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function vt(){}var ut=.7,Bt=1/ut,Be="\\s*([+-]?\\d+)\\s*",dt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",we="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ud=/^#([0-9a-f]{3,8})$/,Kd=new RegExp(`^rgb\\(${Be},${Be},${Be}\\)$`),Zd=new RegExp(`^rgb\\(${we},${we},${we}\\)$`),Qd=new RegExp(`^rgba\\(${Be},${Be},${Be},${dt}\\)$`),Jd=new RegExp(`^rgba\\(${we},${we},${we},${dt}\\)$`),ef=new RegExp(`^hsl\\(${dt},${we},${we}\\)$`),tf=new RegExp(`^hsla\\(${dt},${we},${we},${dt}\\)$`),co={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Xr(vt,ft,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:lo,formatHex:lo,formatHex8:nf,formatHsl:rf,formatRgb:uo,toString:uo});function lo(){return this.rgb().formatHex()}function nf(){return this.rgb().formatHex8()}function rf(){return qs(this).formatHsl()}function uo(){return this.rgb().formatRgb()}function ft(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ud.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?fo(t):n===3?new ue(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ct(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ct(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Kd.exec(e))?new ue(t[1],t[2],t[3],1):(t=Zd.exec(e))?new ue(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Qd.exec(e))?Ct(t[1],t[2],t[3],t[4]):(t=Jd.exec(e))?Ct(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ef.exec(e))?go(t[1],t[2]/100,t[3]/100,1):(t=tf.exec(e))?go(t[1],t[2]/100,t[3]/100,t[4]):co.hasOwnProperty(e)?fo(co[e]):e==="transparent"?new ue(NaN,NaN,NaN,0):null}function fo(e){return new ue(e>>16&255,e>>8&255,e&255,1)}function Ct(e,t,n,r){return r<=0&&(e=t=n=NaN),new ue(e,t,n,r)}function of(e){return e instanceof vt||(e=ft(e)),e?(e=e.rgb(),new ue(e.r,e.g,e.b,e.opacity)):new ue}function Rr(e,t,n,r){return arguments.length===1?of(e):new ue(e,t,n,r??1)}function ue(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Xr(ue,Rr,Vs(vt,{brighter(e){return e=e==null?Bt:Math.pow(Bt,e),new ue(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ut:Math.pow(ut,e),new ue(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ue(Oe(this.r),Oe(this.g),Oe(this.b),Gt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ho,formatHex:ho,formatHex8:sf,formatRgb:po,toString:po}));function ho(){return`#${$e(this.r)}${$e(this.g)}${$e(this.b)}`}function sf(){return`#${$e(this.r)}${$e(this.g)}${$e(this.b)}${$e((isNaN(this.opacity)?1:this.opacity)*255)}`}function po(){const e=Gt(this.opacity);return`${e===1?"rgb(":"rgba("}${Oe(this.r)}, ${Oe(this.g)}, ${Oe(this.b)}${e===1?")":`, ${e})`}`}function Gt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Oe(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function $e(e){return e=Oe(e),(e<16?"0":"")+e.toString(16)}function go(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new pe(e,t,n,r)}function qs(e){if(e instanceof pe)return new pe(e.h,e.s,e.l,e.opacity);if(e instanceof vt||(e=ft(e)),!e)return new pe;if(e instanceof pe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,a=s-i,l=(s+i)/2;return a?(t===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-t)/a+2:o=(t-n)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new pe(o,a,l,e.opacity)}function af(e,t,n,r){return arguments.length===1?qs(e):new pe(e,t,n,r??1)}function pe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Xr(pe,af,Vs(vt,{brighter(e){return e=e==null?Bt:Math.pow(Bt,e),new pe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ut:Math.pow(ut,e),new pe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ue(gr(e>=240?e-240:e+120,i,r),gr(e,i,r),gr(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new pe(mo(this.h),Mt(this.s),Mt(this.l),Gt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Gt(this.opacity);return`${e===1?"hsl(":"hsla("}${mo(this.h)}, ${Mt(this.s)*100}%, ${Mt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function mo(e){return e=(e||0)%360,e<0?e+360:e}function Mt(e){return Math.max(0,Math.min(1,e||0))}function gr(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Bs=e=>()=>e;function cf(e,t){return function(n){return e+n*t}}function lf(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function uf(e){return(e=+e)==1?Gs:function(t,n){return n-t?lf(t,n,e):Bs(isNaN(t)?n:t)}}function Gs(e,t){var n=t-e;return n?cf(e,n):Bs(isNaN(e)?t:e)}const yo=function e(t){var n=uf(t);function r(i,s){var o=n((i=Rr(i)).r,(s=Rr(s)).r),a=n(i.g,s.g),l=n(i.b,s.b),d=Gs(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=a(u),i.b=l(u),i.opacity=d(u),i+""}}return r.gamma=e,r}(1);function Ie(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Ir=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mr=new RegExp(Ir.source,"g");function df(e){return function(){return e}}function ff(e){return function(t){return e(t)+""}}function hf(e,t){var n=Ir.lastIndex=mr.lastIndex=0,r,i,s,o=-1,a=[],l=[];for(e=e+"",t=t+"";(r=Ir.exec(e))&&(i=mr.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:Ie(r,i)})),n=mr.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?ff(l[0].x):df(t):(t=l.length,function(d){for(var u=0,c;u<t;++u)a[(c=l[u]).i]=c.x(d);return a.join("")})}var wo=180/Math.PI,Tr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ys(e,t,n,r,i,s){var o,a,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*wo,skewX:Math.atan(l)*wo,scaleX:o,scaleY:a}}var Rt;function pf(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Tr:Ys(t.a,t.b,t.c,t.d,t.e,t.f)}function gf(e){return e==null||(Rt||(Rt=document.createElementNS("http://www.w3.org/2000/svg","g")),Rt.setAttribute("transform",e),!(e=Rt.transform.baseVal.consolidate()))?Tr:(e=e.matrix,Ys(e.a,e.b,e.c,e.d,e.e,e.f))}function Xs(e,t,n,r){function i(d){return d.length?d.pop()+" ":""}function s(d,u,c,f,h,p){if(d!==c||u!==f){var m=h.push("translate(",null,t,null,n);p.push({i:m-4,x:Ie(d,c)},{i:m-2,x:Ie(u,f)})}else(c||f)&&h.push("translate("+c+t+f+n)}function o(d,u,c,f){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),f.push({i:c.push(i(c)+"rotate(",null,r)-2,x:Ie(d,u)})):u&&c.push(i(c)+"rotate("+u+r)}function a(d,u,c,f){d!==u?f.push({i:c.push(i(c)+"skewX(",null,r)-2,x:Ie(d,u)}):u&&c.push(i(c)+"skewX("+u+r)}function l(d,u,c,f,h,p){if(d!==c||u!==f){var m=h.push(i(h)+"scale(",null,",",null,")");p.push({i:m-4,x:Ie(d,c)},{i:m-2,x:Ie(u,f)})}else(c!==1||f!==1)&&h.push(i(h)+"scale("+c+","+f+")")}return function(d,u){var c=[],f=[];return d=e(d),u=e(u),s(d.translateX,d.translateY,u.translateX,u.translateY,c,f),o(d.rotate,u.rotate,c,f),a(d.skewX,u.skewX,c,f),l(d.scaleX,d.scaleY,u.scaleX,u.scaleY,c,f),d=u=null,function(h){for(var p=-1,m=f.length,x;++p<m;)c[(x=f[p]).i]=x.x(h);return c.join("")}}}var mf=Xs(pf,"px, ","px)","deg)"),yf=Xs(gf,", ",")",")"),wf=1e-12;function xo(e){return((e=Math.exp(e))+1/e)/2}function xf(e){return((e=Math.exp(e))-1/e)/2}function vf(e){return((e=Math.exp(2*e))-1)/(e+1)}const bf=function e(t,n,r){function i(s,o){var a=s[0],l=s[1],d=s[2],u=o[0],c=o[1],f=o[2],h=u-a,p=c-l,m=h*h+p*p,x,y;if(m<wf)y=Math.log(f/d)/t,x=function(C){return[a+C*h,l+C*p,d*Math.exp(t*C*y)]};else{var v=Math.sqrt(m),g=(f*f-d*d+r*m)/(2*d*n*v),w=(f*f-d*d-r*m)/(2*f*n*v),N=Math.log(Math.sqrt(g*g+1)-g),k=Math.log(Math.sqrt(w*w+1)-w);y=(k-N)/t,x=function(C){var E=C*y,_=xo(N),S=d/(n*v)*(_*vf(t*E+N)-xf(N));return[a+S*h,l+S*p,d*_/xo(t*E+N)]}}return x.duration=y*1e3*t/Math.SQRT2,x}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,l=a*a;return e(o,a,l)},i}(Math.SQRT2,2,4);var Ye=0,ot=0,nt=0,Ws=1e3,Yt,st,Xt=0,De=0,tn=0,ht=typeof performance=="object"&&performance.now?performance:Date,Us=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Wr(){return De||(Us(Ef),De=ht.now()+tn)}function Ef(){De=0}function Wt(){this._call=this._time=this._next=null}Wt.prototype=Ks.prototype={constructor:Wt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Wr():+n)+(t==null?0:+t),!this._next&&st!==this&&(st?st._next=this:Yt=this,st=this),this._call=e,this._time=n,Ar()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ar())}};function Ks(e,t,n){var r=new Wt;return r.restart(e,t,n),r}function _f(){Wr(),++Ye;for(var e=Yt,t;e;)(t=De-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ye}function vo(){De=(Xt=ht.now())+tn,Ye=ot=0;try{_f()}finally{Ye=0,Sf(),De=0}}function Nf(){var e=ht.now(),t=e-Xt;t>Ws&&(tn-=t,Xt=e)}function Sf(){for(var e,t=Yt,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Yt=n);st=e,Ar(r)}function Ar(e){if(!Ye){ot&&(ot=clearTimeout(ot));var t=e-De;t>24?(e<1/0&&(ot=setTimeout(vo,e-ht.now()-tn)),nt&&(nt=clearInterval(nt))):(nt||(Xt=ht.now(),nt=setInterval(Nf,Ws)),Ye=1,Us(vo))}}function bo(e,t,n){var r=new Wt;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var kf=Jt("start","end","cancel","interrupt"),Cf=[],Zs=0,Eo=1,Pr=2,Ht=3,_o=4,$r=5,zt=6;function nn(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;Mf(e,n,{name:t,index:r,group:i,on:kf,tween:Cf,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Zs})}function Ur(e,t){var n=ye(e,t);if(n.state>Zs)throw new Error("too late; already scheduled");return n}function ve(e,t){var n=ye(e,t);if(n.state>Ht)throw new Error("too late; already running");return n}function ye(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Mf(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Ks(s,0,n.time);function s(d){n.state=Eo,n.timer.restart(o,n.delay,n.time),n.delay<=d&&o(d-n.delay)}function o(d){var u,c,f,h;if(n.state!==Eo)return l();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Ht)return bo(o);h.state===_o?(h.state=zt,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=zt,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(bo(function(){n.state===Ht&&(n.state=_o,n.timer.restart(a,n.delay,n.time),a(d))}),n.state=Pr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Pr){for(n.state=Ht,i=new Array(f=n.tween.length),u=0,c=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++c]=h);i.length=c+1}}function a(d){for(var u=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(l),n.state=$r,1),c=-1,f=i.length;++c<f;)i[c].call(e,u);n.state===$r&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=zt,n.timer.stop(),delete r[t];for(var d in r)return;delete e.__transition}}function Ft(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>Pr&&r.state<$r,r.state=zt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function Rf(e){return this.each(function(){Ft(this,e)})}function If(e,t){var n,r;return function(){var i=ve(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Tf(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=ve(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:t,value:n},l=0,d=i.length;l<d;++l)if(i[l].name===t){i[l]=a;break}l===d&&i.push(a)}s.tween=i}}function Af(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ye(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?If:Tf)(n,e,t))}function Kr(e,t,n){var r=e._id;return e.each(function(){var i=ve(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return ye(i,r).value[t]}}function Qs(e,t){var n;return(typeof t=="number"?Ie:t instanceof ft?yo:(n=ft(t))?(t=n,yo):hf)(e,t)}function Pf(e){return function(){this.removeAttribute(e)}}function $f(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Of(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function Lf(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function Df(e,t,n){var r,i,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttribute(e):(o=this.getAttribute(e),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=t(r=o,a)))}}function jf(e,t,n){var r,i,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=t(r=o,a)))}}function Hf(e,t){var n=en(e),r=n==="transform"?yf:Qs;return this.attrTween(e,typeof t=="function"?(n.local?jf:Df)(n,r,Kr(this,"attr."+e,t)):t==null?(n.local?$f:Pf)(n):(n.local?Lf:Of)(n,r,t))}function zf(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Ff(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Vf(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Ff(e,s)),n}return i._value=t,i}function qf(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&zf(e,s)),n}return i._value=t,i}function Bf(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=en(e);return this.tween(n,(r.local?Vf:qf)(r,t))}function Gf(e,t){return function(){Ur(this,e).delay=+t.apply(this,arguments)}}function Yf(e,t){return t=+t,function(){Ur(this,e).delay=t}}function Xf(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Gf:Yf)(t,e)):ye(this.node(),t).delay}function Wf(e,t){return function(){ve(this,e).duration=+t.apply(this,arguments)}}function Uf(e,t){return t=+t,function(){ve(this,e).duration=t}}function Kf(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Wf:Uf)(t,e)):ye(this.node(),t).duration}function Zf(e,t){if(typeof t!="function")throw new Error;return function(){ve(this,e).ease=t}}function Qf(e){var t=this._id;return arguments.length?this.each(Zf(t,e)):ye(this.node(),t).ease}function Jf(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ve(this,e).ease=n}}function eh(e){if(typeof e!="function")throw new Error;return this.each(Jf(this._id,e))}function th(e){typeof e!="function"&&(e=Rs(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],l,d=0;d<o;++d)(l=s[d])&&e.call(l,l.__data__,d,s)&&a.push(l);return new Ne(r,this._parents,this._name,this._id)}function nh(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var l=t[a],d=n[a],u=l.length,c=o[a]=new Array(u),f,h=0;h<u;++h)(f=l[h]||d[h])&&(c[h]=f);for(;a<r;++a)o[a]=t[a];return new Ne(o,this._parents,this._name,this._id)}function rh(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function ih(e,t,n){var r,i,s=rh(t)?Ur:ve;return function(){var o=s(this,e),a=o.on;a!==r&&(i=(r=a).copy()).on(t,n),o.on=i}}function oh(e,t){var n=this._id;return arguments.length<2?ye(this.node(),n).on.on(e):this.each(ih(n,e,t))}function sh(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function ah(){return this.on("end.remove",sh(this._id))}function ch(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Gr(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],l=a.length,d=s[o]=new Array(l),u,c,f=0;f<l;++f)(u=a[f])&&(c=e.call(u,u.__data__,f,a))&&("__data__"in u&&(c.__data__=u.__data__),d[f]=c,nn(d[f],t,n,f,d,ye(u,n)));return new Ne(s,this._parents,t,n)}function lh(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ms(e));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var l=r[a],d=l.length,u,c=0;c<d;++c)if(u=l[c]){for(var f=e.call(u,u.__data__,c,l),h,p=ye(u,n),m=0,x=f.length;m<x;++m)(h=f[m])&&nn(h,t,n,m,f,p);s.push(f),o.push(u)}return new Ne(s,o,t,n)}var uh=xt.prototype.constructor;function dh(){return new uh(this._groups,this._parents)}function fh(e,t){var n,r,i;return function(){var s=Ge(this,e),o=(this.style.removeProperty(e),Ge(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function Js(e){return function(){this.style.removeProperty(e)}}function hh(e,t,n){var r,i=n+"",s;return function(){var o=Ge(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function ph(e,t,n){var r,i,s;return function(){var o=Ge(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),Ge(this,e))),o===l?null:o===r&&l===i?s:(i=l,s=t(r=o,a))}}function gh(e,t){var n,r,i,s="style."+t,o="end."+s,a;return function(){var l=ve(this,e),d=l.on,u=l.value[s]==null?a||(a=Js(t)):void 0;(d!==n||i!==u)&&(r=(n=d).copy()).on(o,i=u),l.on=r}}function mh(e,t,n){var r=(e+="")=="transform"?mf:Qs;return t==null?this.styleTween(e,fh(e,r)).on("end.style."+e,Js(e)):typeof t=="function"?this.styleTween(e,ph(e,r,Kr(this,"style."+e,t))).each(gh(this._id,e)):this.styleTween(e,hh(e,r,t),n).on("end.style."+e,null)}function yh(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function wh(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&yh(e,o,n)),r}return s._value=t,s}function xh(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,wh(e,t,n??""))}function vh(e){return function(){this.textContent=e}}function bh(e){return function(){var t=e(this);this.textContent=t??""}}function Eh(e){return this.tween("text",typeof e=="function"?bh(Kr(this,"text",e)):vh(e==null?"":e+""))}function _h(e){return function(t){this.textContent=e.call(this,t)}}function Nh(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&_h(i)),t}return r._value=e,r}function Sh(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Nh(e))}function kh(){for(var e=this._name,t=this._id,n=ea(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,d=0;d<a;++d)if(l=o[d]){var u=ye(l,t);nn(l,e,n,d,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ne(r,this._parents,e,n)}function Ch(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},l={value:function(){--i===0&&s()}};n.each(function(){var d=ve(this,r),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),d.on=t}),i===0&&s()})}var Mh=0;function Ne(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function ea(){return++Mh}var be=xt.prototype;Ne.prototype={constructor:Ne,select:ch,selectAll:lh,selectChild:be.selectChild,selectChildren:be.selectChildren,filter:th,merge:nh,selection:dh,transition:kh,call:be.call,nodes:be.nodes,node:be.node,size:be.size,empty:be.empty,each:be.each,on:oh,attr:Hf,attrTween:Bf,style:mh,styleTween:xh,text:Eh,textTween:Sh,remove:ah,tween:Af,delay:Xf,duration:Kf,ease:Qf,easeVarying:eh,end:Ch,[Symbol.iterator]:be[Symbol.iterator]};function Rh(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Ih={time:null,delay:0,duration:250,ease:Rh};function Th(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Ah(e){var t,n;e instanceof Ne?(t=e._id,e=e._name):(t=ea(),(n=Ih).time=Wr(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,d=0;d<a;++d)(l=o[d])&&nn(l,e,t,d,o,n||Th(l,t));return new Ne(r,this._parents,e,t)}xt.prototype.interrupt=Rf;xt.prototype.transition=Ah;const It=e=>()=>e;function Ph(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Ee(e,t,n){this.k=e,this.x=t,this.y=n}Ee.prototype={constructor:Ee,scale:function(e){return e===1?this:new Ee(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ee(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var rn=new Ee(1,0,0);ta.prototype=Ee.prototype;function ta(e){for(;!e.__zoom;)if(!(e=e.parentNode))return rn;return e.__zoom}function yr(e){e.stopImmediatePropagation()}function rt(e){e.preventDefault(),e.stopImmediatePropagation()}function $h(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Oh(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function No(){return this.__zoom||rn}function Lh(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Dh(){return navigator.maxTouchPoints||"ontouchstart"in this}function jh(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function na(){var e=$h,t=Oh,n=jh,r=Lh,i=Dh,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,l=bf,d=Jt("start","zoom","end"),u,c,f,h=500,p=150,m=0,x=10;function y(b){b.property("__zoom",No).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",_).on("dblclick.zoom",S).filter(i).on("touchstart.zoom",R).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(b,T,M,O){var j=b.selection?b.selection():b;j.property("__zoom",No),b!==j?N(b,T,M,O):j.interrupt().each(function(){k(this,arguments).event(O).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},y.scaleBy=function(b,T,M,O){y.scaleTo(b,function(){var j=this.__zoom.k,P=typeof T=="function"?T.apply(this,arguments):T;return j*P},M,O)},y.scaleTo=function(b,T,M,O){y.transform(b,function(){var j=t.apply(this,arguments),P=this.__zoom,V=M==null?w(j):typeof M=="function"?M.apply(this,arguments):M,B=P.invert(V),G=typeof T=="function"?T.apply(this,arguments):T;return n(g(v(P,G),V,B),j,o)},M,O)},y.translateBy=function(b,T,M,O){y.transform(b,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof M=="function"?M.apply(this,arguments):M),t.apply(this,arguments),o)},null,O)},y.translateTo=function(b,T,M,O,j){y.transform(b,function(){var P=t.apply(this,arguments),V=this.__zoom,B=O==null?w(P):typeof O=="function"?O.apply(this,arguments):O;return n(rn.translate(B[0],B[1]).scale(V.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof M=="function"?-M.apply(this,arguments):-M),P,o)},O,j)};function v(b,T){return T=Math.max(s[0],Math.min(s[1],T)),T===b.k?b:new Ee(T,b.x,b.y)}function g(b,T,M){var O=T[0]-M[0]*b.k,j=T[1]-M[1]*b.k;return O===b.x&&j===b.y?b:new Ee(b.k,O,j)}function w(b){return[(+b[0][0]+ +b[1][0])/2,(+b[0][1]+ +b[1][1])/2]}function N(b,T,M,O){b.on("start.zoom",function(){k(this,arguments).event(O).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(O).end()}).tween("zoom",function(){var j=this,P=arguments,V=k(j,P).event(O),B=t.apply(j,P),G=M==null?w(B):typeof M=="function"?M.apply(j,P):M,A=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),$=j.__zoom,L=typeof T=="function"?T.apply(j,P):T,F=l($.invert(G).concat(A/$.k),L.invert(G).concat(A/L.k));return function(q){if(q===1)q=L;else{var Y=F(q),K=A/Y[2];q=new Ee(K,G[0]-Y[0]*K,G[1]-Y[1]*K)}V.zoom(null,q)}})}function k(b,T,M){return!M&&b.__zooming||new C(b,T)}function C(b,T){this.that=b,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(b,T),this.taps=0}C.prototype={event:function(b){return b&&(this.sourceEvent=b),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,T){return this.mouse&&b!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&b!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&b!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){var T=de(this.that).datum();d.call(b,this.that,new Ph(b,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:d}),T)}};function E(b,...T){if(!e.apply(this,arguments))return;var M=k(this,T).event(b),O=this.__zoom,j=Math.max(s[0],Math.min(s[1],O.k*Math.pow(2,r.apply(this,arguments)))),P=he(b);if(M.wheel)(M.mouse[0][0]!==P[0]||M.mouse[0][1]!==P[1])&&(M.mouse[1]=O.invert(M.mouse[0]=P)),clearTimeout(M.wheel);else{if(O.k===j)return;M.mouse=[P,O.invert(P)],Ft(this),M.start()}rt(b),M.wheel=setTimeout(V,p),M.zoom("mouse",n(g(v(O,j),M.mouse[0],M.mouse[1]),M.extent,o));function V(){M.wheel=null,M.end()}}function _(b,...T){if(f||!e.apply(this,arguments))return;var M=b.currentTarget,O=k(this,T,!0).event(b),j=de(b.view).on("mousemove.zoom",G,!0).on("mouseup.zoom",A,!0),P=he(b,M),V=b.clientX,B=b.clientY;Hs(b.view),yr(b),O.mouse=[P,this.__zoom.invert(P)],Ft(this),O.start();function G($){if(rt($),!O.moved){var L=$.clientX-V,F=$.clientY-B;O.moved=L*L+F*F>m}O.event($).zoom("mouse",n(g(O.that.__zoom,O.mouse[0]=he($,M),O.mouse[1]),O.extent,o))}function A($){j.on("mousemove.zoom mouseup.zoom",null),zs($.view,O.moved),rt($),O.event($).end()}}function S(b,...T){if(e.apply(this,arguments)){var M=this.__zoom,O=he(b.changedTouches?b.changedTouches[0]:b,this),j=M.invert(O),P=M.k*(b.shiftKey?.5:2),V=n(g(v(M,P),O,j),t.apply(this,T),o);rt(b),a>0?de(this).transition().duration(a).call(N,V,O,b):de(this).call(y.transform,V,O,b)}}function R(b,...T){if(e.apply(this,arguments)){var M=b.touches,O=M.length,j=k(this,T,b.changedTouches.length===O).event(b),P,V,B,G;for(yr(b),V=0;V<O;++V)B=M[V],G=he(B,this),G=[G,this.__zoom.invert(G),B.identifier],j.touch0?!j.touch1&&j.touch0[2]!==G[2]&&(j.touch1=G,j.taps=0):(j.touch0=G,P=!0,j.taps=1+!!u);u&&(u=clearTimeout(u)),P&&(j.taps<2&&(c=G[0],u=setTimeout(function(){u=null},h)),Ft(this),j.start())}}function I(b,...T){if(this.__zooming){var M=k(this,T).event(b),O=b.changedTouches,j=O.length,P,V,B,G;for(rt(b),P=0;P<j;++P)V=O[P],B=he(V,this),M.touch0&&M.touch0[2]===V.identifier?M.touch0[0]=B:M.touch1&&M.touch1[2]===V.identifier&&(M.touch1[0]=B);if(V=M.that.__zoom,M.touch1){var A=M.touch0[0],$=M.touch0[1],L=M.touch1[0],F=M.touch1[1],q=(q=L[0]-A[0])*q+(q=L[1]-A[1])*q,Y=(Y=F[0]-$[0])*Y+(Y=F[1]-$[1])*Y;V=v(V,Math.sqrt(q/Y)),B=[(A[0]+L[0])/2,(A[1]+L[1])/2],G=[($[0]+F[0])/2,($[1]+F[1])/2]}else if(M.touch0)B=M.touch0[0],G=M.touch0[1];else return;M.zoom("touch",n(g(V,B,G),M.extent,o))}}function D(b,...T){if(this.__zooming){var M=k(this,T).event(b),O=b.changedTouches,j=O.length,P,V;for(yr(b),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),P=0;P<j;++P)V=O[P],M.touch0&&M.touch0[2]===V.identifier?delete M.touch0:M.touch1&&M.touch1[2]===V.identifier&&delete M.touch1;if(M.touch1&&!M.touch0&&(M.touch0=M.touch1,delete M.touch1),M.touch0)M.touch0[1]=this.__zoom.invert(M.touch0[0]);else if(M.end(),M.taps===2&&(V=he(V,this),Math.hypot(c[0]-V[0],c[1]-V[1])<x)){var B=de(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return y.wheelDelta=function(b){return arguments.length?(r=typeof b=="function"?b:It(+b),y):r},y.filter=function(b){return arguments.length?(e=typeof b=="function"?b:It(!!b),y):e},y.touchable=function(b){return arguments.length?(i=typeof b=="function"?b:It(!!b),y):i},y.extent=function(b){return arguments.length?(t=typeof b=="function"?b:It([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),y):t},y.scaleExtent=function(b){return arguments.length?(s[0]=+b[0],s[1]=+b[1],y):[s[0],s[1]]},y.translateExtent=function(b){return arguments.length?(o[0][0]=+b[0][0],o[1][0]=+b[1][0],o[0][1]=+b[0][1],o[1][1]=+b[1][1],y):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},y.constrain=function(b){return arguments.length?(n=b,y):n},y.duration=function(b){return arguments.length?(a=+b,y):a},y.interpolate=function(b){return arguments.length?(l=b,y):l},y.on=function(){var b=d.on.apply(d,arguments);return b===d?y:b},y.clickDistance=function(b){return arguments.length?(m=(b=+b)*b,y):Math.sqrt(m)},y.tapDistance=function(b){return arguments.length?(x=+b,y):x},y}const xe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},pt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ra=["Enter"," ","Escape"];var Xe;(function(e){e.Strict="strict",e.Loose="loose"})(Xe||(Xe={}));var Le;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Le||(Le={}));var gt;(function(e){e.Partial="partial",e.Full="full"})(gt||(gt={}));const ia={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var Te;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Te||(Te={}));var Ut;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Ut||(Ut={}));var X;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(X||(X={}));const So={[X.Left]:X.Right,[X.Right]:X.Left,[X.Top]:X.Bottom,[X.Bottom]:X.Top};function oa(e){return e===null?null:e?"valid":"invalid"}const sa=e=>"id"in e&&"source"in e&&"target"in e,Hh=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Zr=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),bt=(e,t=[0,0])=>{const{width:n,height:r}=ke(e),i=e.origin??t,s=n*i[0],o=r*i[1];return{x:e.position.x-s,y:e.position.y-o}},zh=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,i)=>{const s=typeof i=="string";let o=!t.nodeLookup&&!s?i:void 0;t.nodeLookup&&(o=s?t.nodeLookup.get(i):Zr(i)?i:t.nodeLookup.get(i.id));const a=o?Kt(o,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return on(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return sn(n)},Et=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const i=Kt(r);n=on(n,i)}}),sn(n)},aa=(e,t,[n,r,i]=[0,0,1],s=!1,o=!1)=>{const a={..._t(t,[n,r,i]),width:t.width/i,height:t.height/i},l=[];for(const d of e.values()){const{measured:u,selectable:c=!0,hidden:f=!1}=d;if(o&&!c||f)continue;const h=u.width??d.width??d.initialWidth??null,p=u.height??d.height??d.initialHeight??null,m=mt(a,Ue(d)),x=(h??0)*(p??0),y=s&&m>0;(!d.internals.handleBounds||y||m>=x||d.dragging)&&l.push(d)}return l},Fh=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function Or(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(i=>i.id)):null;return e.forEach(i=>{i.measured.width&&i.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!i.hidden)&&(!r||r.has(i.id))&&n.set(i.id,i)}),n}async function Lr({nodes:e,width:t,height:n,panZoom:r,minZoom:i,maxZoom:s},o){if(e.size===0)return Promise.resolve(!1);const a=Et(e),l=Qr(a,t,n,(o==null?void 0:o.minZoom)??i,(o==null?void 0:o.maxZoom)??s,(o==null?void 0:o.padding)??.1);return await r.setViewport(l,{duration:o==null?void 0:o.duration}),Promise.resolve(!0)}function ca({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:i,onError:s}){const o=n.get(e),a=o.parentId?n.get(o.parentId):void 0,{x:l,y:d}=a?a.internals.positionAbsolute:{x:0,y:0},u=o.origin??r;let c=i;if(o.extent==="parent"&&!o.expandParent)if(!a)s==null||s("005",xe.error005());else{const h=a.measured.width,p=a.measured.height;h&&p&&(c=[[l,d],[l+h,d+p]])}else a&&Ke(o.extent)&&(c=[[o.extent[0][0]+l,o.extent[0][1]+d],[o.extent[1][0]+l,o.extent[1][1]+d]]);const f=Ke(c)?je(t,c,o.measured):t;return(o.measured.width===void 0||o.measured.height===void 0)&&(s==null||s("015",xe.error015())),{position:{x:f.x-l+(o.measured.width??0)*u[0],y:f.y-d+(o.measured.height??0)*u[1]},positionAbsolute:f}}async function Vh({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:i}){const s=new Set(e.map(f=>f.id)),o=[];for(const f of n){if(f.deletable===!1)continue;const h=s.has(f.id),p=!h&&f.parentId&&o.find(m=>m.id===f.parentId);(h||p)&&o.push(f)}const a=new Set(t.map(f=>f.id)),l=r.filter(f=>f.deletable!==!1),u=Fh(o,l);for(const f of l)a.has(f.id)&&!u.find(p=>p.id===f.id)&&u.push(f);if(!i)return{edges:u,nodes:o};const c=await i({nodes:o,edges:u});return typeof c=="boolean"?c?{edges:u,nodes:o}:{edges:[],nodes:[]}:c}const We=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),je=(e={x:0,y:0},t,n)=>({x:We(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:We(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function la(e,t,n){const{width:r,height:i}=ke(n),{x:s,y:o}=n.internals.positionAbsolute;return je(e,[[s,o],[s+r,o+i]],t)}const ko=(e,t,n)=>e<t?We(Math.abs(e-t),1,t)/t:e>n?-We(Math.abs(e-n),1,t)/t:0,ua=(e,t,n=15,r=40)=>{const i=ko(e.x,r,t.width-r)*n,s=ko(e.y,r,t.height-r)*n;return[i,s]},on=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Dr=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),sn=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Ue=(e,t=[0,0])=>{var i,s;const{x:n,y:r}=Zr(e)?e.internals.positionAbsolute:bt(e,t);return{x:n,y:r,width:((i=e.measured)==null?void 0:i.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},Kt=(e,t=[0,0])=>{var i,s;const{x:n,y:r}=Zr(e)?e.internals.positionAbsolute:bt(e,t);return{x:n,y:r,x2:n+(((i=e.measured)==null?void 0:i.width)??e.width??e.initialWidth??0),y2:r+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},da=(e,t)=>sn(on(Dr(e),Dr(t))),mt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Co=e=>ge(e.width)&&ge(e.height)&&ge(e.x)&&ge(e.y),ge=e=>!isNaN(e)&&isFinite(e),qh=(e,t)=>{},an=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),_t=({x:e,y:t},[n,r,i],s=!1,o=[1,1])=>{const a={x:(e-n)/i,y:(t-r)/i};return s?an(a,o):a},fa=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r}),Qr=(e,t,n,r,i,s)=>{const o=t/(e.width*(1+s)),a=n/(e.height*(1+s)),l=Math.min(o,a),d=We(l,r,i),u=e.x+e.width/2,c=e.y+e.height/2,f=t/2-u*d,h=n/2-c*d;return{x:f,y:h,zoom:d}},Zt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Ke(e){return e!==void 0&&e!=="parent"}function ke(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Jr(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function ha(e,t={width:0,height:0},n,r,i){const s={...e},o=r.get(n);if(o){const a=o.origin||i;s.x+=o.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=o.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function Mo(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function at(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:i}){const{x:s,y:o}=_e(e),a=_t({x:s-((i==null?void 0:i.left)??0),y:o-((i==null?void 0:i.top)??0)},r),{x:l,y:d}=n?an(a,t):a;return{xSnapped:l,ySnapped:d,...a}}const cn=e=>({width:e.offsetWidth,height:e.offsetHeight}),pa=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Bh=["INPUT","SELECT","TEXTAREA"];function jr(e){var r,i;const t=((i=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:i[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Bh.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ga=e=>"clientX"in e,_e=(e,t)=>{var s,o;const n=ga(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=n?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},Ro=(e,t,n,r,i)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(o=>{const a=o.getBoundingClientRect();return{id:o.getAttribute("data-handleid"),type:e,nodeId:i,position:o.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...cn(o)}})};function ma({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:a}){const l=e*.125+i*.375+o*.375+n*.125,d=t*.125+s*.375+a*.375+r*.125,u=Math.abs(l-e),c=Math.abs(d-t);return[l,d,u,c]}function Tt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Io({pos:e,x1:t,y1:n,x2:r,y2:i,c:s}){switch(e){case X.Left:return[t-Tt(t-r,s),n];case X.Right:return[t+Tt(r-t,s),n];case X.Top:return[t,n-Tt(n-i,s)];case X.Bottom:return[t,n+Tt(i-n,s)]}}function ya({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:i,targetPosition:s=X.Top,curvature:o=.25}){const[a,l]=Io({pos:n,x1:e,y1:t,x2:r,y2:i,c:o}),[d,u]=Io({pos:s,x1:r,y1:i,x2:e,y2:t,c:o}),[c,f,h,p]=ma({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:a,sourceControlY:l,targetControlX:d,targetControlY:u});return[`M${e},${t} C${a},${l} ${d},${u} ${r},${i}`,c,f,h,p]}function wa({sourceX:e,sourceY:t,targetX:n,targetY:r}){const i=Math.abs(n-e)/2,s=n<e?n+i:n-i,o=Math.abs(r-t)/2,a=r<t?r+o:r-o;return[s,a,i,o]}function Gh({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:i=!1}){if(!i)return r;const s=n||t.selected||e.selected,o=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(s?o:0)}function Yh({sourceNode:e,targetNode:t,width:n,height:r,transform:i}){const s=on(Kt(e),Kt(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const o={x:-i[0]/i[2],y:-i[1]/i[2],width:n/i[2],height:r/i[2]};return mt(o,sn(s))>0}const Xh=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Wh=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Uh=(e,t)=>{if(!e.source||!e.target)return t;let n;return sa(e)?n={...e}:n={...e,id:Xh(e)},Wh(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function He({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[i,s,o,a]=wa({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,s,o,a]}const To={[X.Left]:{x:-1,y:0},[X.Right]:{x:1,y:0},[X.Top]:{x:0,y:-1},[X.Bottom]:{x:0,y:1}},Kh=({source:e,sourcePosition:t=X.Bottom,target:n})=>t===X.Left||t===X.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Ao=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Zh({source:e,sourcePosition:t=X.Bottom,target:n,targetPosition:r=X.Top,center:i,offset:s}){const o=To[t],a=To[r],l={x:e.x+o.x*s,y:e.y+o.y*s},d={x:n.x+a.x*s,y:n.y+a.y*s},u=Kh({source:l,sourcePosition:t,target:d}),c=u.x!==0?"x":"y",f=u[c];let h=[],p,m;const x={x:0,y:0},y={x:0,y:0},[v,g,w,N]=wa({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(o[c]*a[c]===-1){p=i.x??v,m=i.y??g;const C=[{x:p,y:l.y},{x:p,y:d.y}],E=[{x:l.x,y:m},{x:d.x,y:m}];o[c]===f?h=c==="x"?C:E:h=c==="x"?E:C}else{const C=[{x:l.x,y:d.y}],E=[{x:d.x,y:l.y}];if(c==="x"?h=o.x===f?E:C:h=o.y===f?C:E,t===r){const D=Math.abs(e[c]-n[c]);if(D<=s){const b=Math.min(s-1,s-D);o[c]===f?x[c]=(l[c]>e[c]?-1:1)*b:y[c]=(d[c]>n[c]?-1:1)*b}}if(t!==r){const D=c==="x"?"y":"x",b=o[c]===a[D],T=l[D]>d[D],M=l[D]<d[D];(o[c]===1&&(!b&&T||b&&M)||o[c]!==1&&(!b&&M||b&&T))&&(h=c==="x"?C:E)}const _={x:l.x+x.x,y:l.y+x.y},S={x:d.x+y.x,y:d.y+y.y},R=Math.max(Math.abs(_.x-h[0].x),Math.abs(S.x-h[0].x)),I=Math.max(Math.abs(_.y-h[0].y),Math.abs(S.y-h[0].y));R>=I?(p=(_.x+S.x)/2,m=h[0].y):(p=h[0].x,m=(_.y+S.y)/2)}return[[e,{x:l.x+x.x,y:l.y+x.y},...h,{x:d.x+y.x,y:d.y+y.y},n],p,m,w,N]}function Qh(e,t,n,r){const i=Math.min(Ao(e,t)/2,Ao(t,n)/2,r),{x:s,y:o}=t;if(e.x===s&&s===n.x||e.y===o&&o===n.y)return`L${s} ${o}`;if(e.y===o){const d=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${s+i*d},${o}Q ${s},${o} ${s},${o+i*u}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${s},${o+i*l}Q ${s},${o} ${s+i*a},${o}`}function Hr({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:i,targetPosition:s=X.Top,borderRadius:o=5,centerX:a,centerY:l,offset:d=20}){const[u,c,f,h,p]=Zh({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:a,y:l},offset:d});return[u.reduce((x,y,v)=>{let g="";return v>0&&v<u.length-1?g=Qh(u[v-1],y,u[v+1],o):g=`${v===0?"M":"L"}${y.x} ${y.y}`,x+=g,x},""),c,f,h,p]}function Po(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Jh(e){var c;const{sourceNode:t,targetNode:n}=e;if(!Po(t)||!Po(n))return null;const r=t.internals.handleBounds||$o(t.handles),i=n.internals.handleBounds||$o(n.handles),s=Oo((r==null?void 0:r.source)??[],e.sourceHandle),o=Oo(e.connectionMode===Xe.Strict?(i==null?void 0:i.target)??[]:((i==null?void 0:i.target)??[]).concat((i==null?void 0:i.source)??[]),e.targetHandle);if(!s||!o)return(c=e.onError)==null||c.call(e,"008",xe.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||X.Bottom,l=(o==null?void 0:o.position)||X.Top,d=yt(t,s,a),u=yt(n,o,l);return{sourceX:d.x,sourceY:d.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:l}}function $o(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function yt(e,t,n=X.Left,r=!1){const i=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:o,height:a}=t??ke(e);if(r)return{x:i+o/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case X.Top:return{x:i+o/2,y:s};case X.Right:return{x:i+o,y:s+a/2};case X.Bottom:return{x:i+o/2,y:s+a};case X.Left:return{x:i,y:s+a/2}}}function Oo(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function zr(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function ep(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:i}){const s=new Set;return e.reduce((o,a)=>([a.markerStart||r,a.markerEnd||i].forEach(l=>{if(l&&typeof l=="object"){const d=zr(l,t);s.has(d)||(o.push({id:d,color:l.color||n,...l}),s.add(d))}}),o),[]).sort((o,a)=>o.id.localeCompare(a.id))}const ei={nodeOrigin:[0,0],nodeExtent:pt,elevateNodesOnSelect:!0,defaults:{}},tp={...ei,checkEquality:!0};function ti(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function np(e,t,n){const r=ti(ei,n);for(const i of e.values())if(i.parentId)ni(i,e,t,r);else{const s=bt(i,r.nodeOrigin),o=Ke(i.extent)?i.extent:r.nodeExtent,a=je(s,o,ke(i));i.internals.positionAbsolute=a}}function Fr(e,t,n,r){var a,l;const i=ti(tp,r),s=new Map(t),o=i!=null&&i.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const d of e){let u=s.get(d.id);if(i.checkEquality&&d===(u==null?void 0:u.internals.userNode))t.set(d.id,u);else{const c=bt(d,i.nodeOrigin),f=Ke(d.extent)?d.extent:i.nodeExtent,h=je(c,f,ke(d));u={...i.defaults,...d,measured:{width:(a=d.measured)==null?void 0:a.width,height:(l=d.measured)==null?void 0:l.height},internals:{positionAbsolute:h,handleBounds:d.measured?u==null?void 0:u.internals.handleBounds:void 0,z:xa(d,o),userNode:d}},t.set(d.id,u)}d.parentId&&ni(u,t,n,r)}}function rp(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function ni(e,t,n,r){const{elevateNodesOnSelect:i,nodeOrigin:s,nodeExtent:o}=ti(ei,r),a=e.parentId,l=t.get(a);if(!l){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}rp(e,n);const d=i?1e3:0,{x:u,y:c,z:f}=ip(e,l,s,o,d),{positionAbsolute:h}=e.internals,p=u!==h.x||c!==h.y;(p||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:u,y:c}:h,z:f}})}function xa(e,t){return(ge(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function ip(e,t,n,r,i){const{x:s,y:o}=t.internals.positionAbsolute,a=ke(e),l=bt(e,n),d=Ke(e.extent)?je(l,e.extent,a):l;let u=je({x:s+d.x,y:o+d.y},r,a);e.extent==="parent"&&(u=la(u,a,t));const c=xa(e,i),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>c?f:c}}function ri(e,t,n,r=[0,0]){var o;const i=[],s=new Map;for(const a of e){const l=t.get(a.parentId);if(!l)continue;const d=((o=s.get(a.parentId))==null?void 0:o.expandedRect)??Ue(l),u=da(d,a.rect);s.set(a.parentId,{expandedRect:u,parent:l})}return s.size>0&&s.forEach(({expandedRect:a,parent:l},d)=>{var g;const u=l.internals.positionAbsolute,c=ke(l),f=l.origin??r,h=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,p=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,m=Math.max(c.width,Math.round(a.width)),x=Math.max(c.height,Math.round(a.height)),y=(m-c.width)*f[0],v=(x-c.height)*f[1];(h>0||p>0||y||v)&&(i.push({id:d,type:"position",position:{x:l.position.x-h+y,y:l.position.y-p+v}}),(g=n.get(d))==null||g.forEach(w=>{e.some(N=>N.id===w.id)||i.push({id:w.id,type:"position",position:{x:w.position.x+h,y:w.position.y+p}})})),(c.width<a.width||c.height<a.height||h||p)&&i.push({id:d,type:"dimensions",setAttributes:!0,dimensions:{width:m+(h?f[0]*h-y:0),height:x+(p?f[1]*p-v:0)}})}),i}function op(e,t,n,r,i,s){const o=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!o)return{changes:[],updatedInternals:a};const l=[],d=window.getComputedStyle(o),{m22:u}=new window.DOMMatrixReadOnly(d.transform),c=[];for(const f of e.values()){const h=t.get(f.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const p=cn(f.nodeElement),m=h.measured.width!==p.width||h.measured.height!==p.height;if(!!(p.width&&p.height&&(m||!h.internals.handleBounds||f.force))){const y=f.nodeElement.getBoundingClientRect(),v=Ke(h.extent)?h.extent:s;let{positionAbsolute:g}=h.internals;h.parentId&&h.extent==="parent"?g=la(g,p,t.get(h.parentId)):v&&(g=je(g,v,p));const w={...h,measured:p,internals:{...h.internals,positionAbsolute:g,handleBounds:{source:Ro("source",f.nodeElement,y,u,h.id),target:Ro("target",f.nodeElement,y,u,h.id)}}};t.set(h.id,w),h.parentId&&ni(w,t,n,{nodeOrigin:i}),a=!0,m&&(l.push({id:h.id,type:"dimensions",dimensions:p}),h.expandParent&&h.parentId&&c.push({id:h.id,parentId:h.parentId,rect:Ue(w,i)}))}}if(c.length>0){const f=ri(c,t,n,i);l.push(...f)}return{changes:l,updatedInternals:a}}async function sp({delta:e,panZoom:t,transform:n,translateExtent:r,width:i,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const o=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[i,s]],r),a=!!o&&(o.x!==n[0]||o.y!==n[1]||o.k!==n[2]);return Promise.resolve(a)}function Lo(e,t,n,r,i,s){let o=i;const a=r.get(o)||new Map;r.set(o,a.set(n,t)),o=`${i}-${e}`;const l=r.get(o)||new Map;if(r.set(o,l.set(n,t)),s){o=`${i}-${e}-${s}`;const d=r.get(o)||new Map;r.set(o,d.set(n,t))}}function va(e,t,n){e.clear(),t.clear();for(const r of n){const{source:i,target:s,sourceHandle:o=null,targetHandle:a=null}=r,l={edgeId:r.id,source:i,target:s,sourceHandle:o,targetHandle:a},d=`${i}-${o}--${s}-${a}`,u=`${s}-${a}--${i}-${o}`;Lo("source",l,u,e,i,o),Lo("target",l,d,e,s,a),t.set(r.id,r)}}function ba(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:ba(n,t):!1}function Do(e,t,n){var i;let r=e;do{if((i=r==null?void 0:r.matches)!=null&&i.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function ap(e,t,n,r){const i=new Map;for(const[s,o]of e)if((o.selected||o.id===r)&&(!o.parentId||!ba(o,e))&&(o.draggable||t&&typeof o.draggable>"u")){const a=e.get(s);a&&i.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return i}function wr({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var o,a,l;const i=[];for(const[d,u]of t){const c=(o=n.get(d))==null?void 0:o.internals.userNode;c&&i.push({...c,position:u.position,dragging:r})}if(!e)return[i[0],i];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((l=t.get(e))==null?void 0:l.position)||s.position,dragging:r}:i[0],i]}function cp({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:i}){let s={x:null,y:null},o=0,a=new Map,l=!1,d={x:0,y:0},u=null,c=!1,f=null,h=!1;function p({noDragClassName:x,handleSelector:y,domNode:v,isSelectable:g,nodeId:w,nodeClickDistance:N=0}){f=de(v);function k({x:S,y:R},I){const{nodeLookup:D,nodeExtent:b,snapGrid:T,snapToGrid:M,nodeOrigin:O,onNodeDrag:j,onSelectionDrag:P,onError:V,updateNodePositions:B}=t();s={x:S,y:R};let G=!1,A={x:0,y:0,x2:0,y2:0};if(a.size>1&&b){const $=Et(a);A=Dr($)}for(const[$,L]of a){if(!D.has($))continue;let F={x:S-L.distance.x,y:R-L.distance.y};M&&(F=an(F,T));let q=[[b[0][0],b[0][1]],[b[1][0],b[1][1]]];if(a.size>1&&b&&!L.extent){const{positionAbsolute:J}=L.internals,Q=J.x-A.x+b[0][0],U=J.x+L.measured.width-A.x2+b[1][0],Z=J.y-A.y+b[0][1],te=J.y+L.measured.height-A.y2+b[1][1];q=[[Q,Z],[U,te]]}const{position:Y,positionAbsolute:K}=ca({nodeId:$,nextPosition:F,nodeLookup:D,nodeExtent:q,nodeOrigin:O,onError:V});G=G||L.position.x!==Y.x||L.position.y!==Y.y,L.position=Y,L.internals.positionAbsolute=K}if(G&&(B(a,!0),I&&(r||j||!w&&P))){const[$,L]=wr({nodeId:w,dragItems:a,nodeLookup:D});r==null||r(I,a,$,L),j==null||j(I,$,L),w||P==null||P(I,L)}}async function C(){if(!u)return;const{transform:S,panBy:R,autoPanSpeed:I,autoPanOnNodeDrag:D}=t();if(!D){l=!1,cancelAnimationFrame(o);return}const[b,T]=ua(d,u,I);(b!==0||T!==0)&&(s.x=(s.x??0)-b/S[2],s.y=(s.y??0)-T/S[2],await R({x:b,y:T})&&k(s,null)),o=requestAnimationFrame(C)}function E(S){var G;const{nodeLookup:R,multiSelectionActive:I,nodesDraggable:D,transform:b,snapGrid:T,snapToGrid:M,selectNodesOnDrag:O,onNodeDragStart:j,onSelectionDragStart:P,unselectNodesAndEdges:V}=t();c=!0,(!O||!g)&&!I&&w&&((G=R.get(w))!=null&&G.selected||V()),g&&O&&w&&(e==null||e(w));const B=at(S.sourceEvent,{transform:b,snapGrid:T,snapToGrid:M,containerBounds:u});if(s=B,a=ap(R,D,B,w),a.size>0&&(n||j||!w&&P)){const[A,$]=wr({nodeId:w,dragItems:a,nodeLookup:R});n==null||n(S.sourceEvent,a,A,$),j==null||j(S.sourceEvent,A,$),w||P==null||P(S.sourceEvent,$)}}const _=Fs().clickDistance(N).on("start",S=>{const{domNode:R,nodeDragThreshold:I,transform:D,snapGrid:b,snapToGrid:T}=t();u=(R==null?void 0:R.getBoundingClientRect())||null,h=!1,I===0&&E(S),s=at(S.sourceEvent,{transform:D,snapGrid:b,snapToGrid:T,containerBounds:u}),d=_e(S.sourceEvent,u)}).on("drag",S=>{const{autoPanOnNodeDrag:R,transform:I,snapGrid:D,snapToGrid:b,nodeDragThreshold:T,nodeLookup:M}=t(),O=at(S.sourceEvent,{transform:I,snapGrid:D,snapToGrid:b,containerBounds:u});if((S.sourceEvent.type==="touchmove"&&S.sourceEvent.touches.length>1||w&&!M.has(w))&&(h=!0),!h){if(!l&&R&&c&&(l=!0,C()),!c){const j=O.xSnapped-(s.x??0),P=O.ySnapped-(s.y??0);Math.sqrt(j*j+P*P)>T&&E(S)}(s.x!==O.xSnapped||s.y!==O.ySnapped)&&a&&c&&(d=_e(S.sourceEvent,u),k(O,S.sourceEvent))}}).on("end",S=>{if(!(!c||h)&&(l=!1,c=!1,cancelAnimationFrame(o),a.size>0)){const{nodeLookup:R,updateNodePositions:I,onNodeDragStop:D,onSelectionDragStop:b}=t();if(I(a,!1),i||D||!w&&b){const[T,M]=wr({nodeId:w,dragItems:a,nodeLookup:R,dragging:!1});i==null||i(S.sourceEvent,a,T,M),D==null||D(S.sourceEvent,T,M),w||b==null||b(S.sourceEvent,M)}}}).filter(S=>{const R=S.target;return!S.button&&(!x||!Do(R,`.${x}`,v))&&(!y||Do(R,y,v))});f.call(_)}function m(){f==null||f.on(".drag",null)}return{update:p,destroy:m}}function lp(e,t,n){const r=[],i={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())mt(i,Ue(s))>0&&r.push(s);return r}const up=250;function dp(e,t,n,r){var a,l;let i=[],s=1/0;const o=lp(e,n,t+up);for(const d of o){const u=[...((a=d.internals.handleBounds)==null?void 0:a.source)??[],...((l=d.internals.handleBounds)==null?void 0:l.target)??[]];for(const c of u){if(r.nodeId===c.nodeId&&r.type===c.type&&r.id===c.id)continue;const{x:f,y:h}=yt(d,c,c.position,!0),p=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(h-e.y,2));p>t||(p<s?(i=[{...c,x:f,y:h}],s=p):p===s&&i.push({...c,x:f,y:h}))}}if(!i.length)return null;if(i.length>1){const d=r.type==="source"?"target":"source";return i.find(u=>u.type===d)??i[0]}return i[0]}function Ea(e,t,n,r,i,s=!1){var d,u,c;const o=r.get(e);if(!o)return null;const a=i==="strict"?(d=o.internals.handleBounds)==null?void 0:d[t]:[...((u=o.internals.handleBounds)==null?void 0:u.source)??[],...((c=o.internals.handleBounds)==null?void 0:c.target)??[]],l=(n?a==null?void 0:a.find(f=>f.id===n):a==null?void 0:a[0])??null;return l&&s?{...l,...yt(o,l,l.position,!0)}:l}function _a(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function fp(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Na=()=>!0;function hp(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:i,edgeUpdaterType:s,isTarget:o,domNode:a,nodeLookup:l,lib:d,autoPanOnConnect:u,flowId:c,panBy:f,cancelConnection:h,onConnectStart:p,onConnect:m,onConnectEnd:x,isValidConnection:y=Na,onReconnectEnd:v,updateConnection:g,getTransform:w,getFromHandle:N,autoPanSpeed:k}){const C=pa(e.target);let E=0,_;const{x:S,y:R}=_e(e),I=C==null?void 0:C.elementFromPoint(S,R),D=_a(s,I),b=a==null?void 0:a.getBoundingClientRect();if(!b||!D)return;const T=Ea(i,D,r,l,t);if(!T)return;let M=_e(e,b),O=!1,j=null,P=!1,V=null;function B(){if(!u||!b)return;const[K,J]=ua(M,b,k);f({x:K,y:J}),E=requestAnimationFrame(B)}const G={...T,nodeId:i,type:D,position:T.position},A=l.get(i),L={inProgress:!0,isValid:null,from:yt(A,G,X.Left,!0),fromHandle:G,fromPosition:G.position,fromNode:A,to:M,toHandle:null,toPosition:So[G.position],toNode:null};g(L);let F=L;p==null||p(e,{nodeId:i,handleId:r,handleType:D});function q(K){if(!N()||!G){Y(K);return}const J=w();M=_e(K,b),_=dp(_t(M,J,!1,[1,1]),n,l,G),O||(B(),O=!0);const Q=Sa(K,{handle:_,connectionMode:t,fromNodeId:i,fromHandleId:r,fromType:o?"target":"source",isValidConnection:y,doc:C,lib:d,flowId:c,nodeLookup:l});V=Q.handleDomNode,j=Q.connection,P=fp(!!_,Q.isValid);const U={...F,isValid:P,to:_&&P?fa({x:_.x,y:_.y},J):M,toHandle:Q.toHandle,toPosition:P&&Q.toHandle?Q.toHandle.position:So[G.position],toNode:Q.toHandle?l.get(Q.toHandle.nodeId):null};P&&_&&F.toHandle&&U.toHandle&&F.toHandle.type===U.toHandle.type&&F.toHandle.nodeId===U.toHandle.nodeId&&F.toHandle.id===U.toHandle.id&&F.to.x===U.to.x&&F.to.y===U.to.y||(g(U),F=U)}function Y(K){(_||V)&&j&&P&&(m==null||m(j));const{inProgress:J,...Q}=F,U={...Q,toPosition:F.toHandle?F.toPosition:null};x==null||x(K,U),s&&(v==null||v(K,U)),h(),cancelAnimationFrame(E),O=!1,P=!1,j=null,V=null,C.removeEventListener("mousemove",q),C.removeEventListener("mouseup",Y),C.removeEventListener("touchmove",q),C.removeEventListener("touchend",Y)}C.addEventListener("mousemove",q),C.addEventListener("mouseup",Y),C.addEventListener("touchmove",q),C.addEventListener("touchend",Y)}function Sa(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:i,fromType:s,doc:o,lib:a,flowId:l,isValidConnection:d=Na,nodeLookup:u}){const c=s==="target",f=t?o.querySelector(`.${a}-flow__handle[data-id="${l}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:p}=_e(e),m=o.elementFromPoint(h,p),x=m!=null&&m.classList.contains(`${a}-flow__handle`)?m:f,y={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){const v=_a(void 0,x),g=x.getAttribute("data-nodeid"),w=x.getAttribute("data-handleid"),N=x.classList.contains("connectable"),k=x.classList.contains("connectableend");if(!g||!v)return y;const C={source:c?g:r,sourceHandle:c?w:i,target:c?r:g,targetHandle:c?i:w};y.connection=C;const _=N&&k&&(n===Xe.Strict?c&&v==="source"||!c&&v==="target":g!==r||w!==i);y.isValid=_&&d(C),y.toHandle=Ea(g,v,w,u,n,!1)}return y}const Vr={onPointerDown:hp,isValid:Sa};function pp({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const i=de(e);function s({translateExtent:a,width:l,height:d,zoomStep:u=10,pannable:c=!0,zoomable:f=!0,inversePan:h=!1}){const p=g=>{const w=n();if(g.sourceEvent.type!=="wheel"||!t)return;const N=-g.sourceEvent.deltaY*(g.sourceEvent.deltaMode===1?.05:g.sourceEvent.deltaMode?1:.002)*u,k=w[2]*Math.pow(2,N);t.scaleTo(k)};let m=[0,0];const x=g=>{(g.sourceEvent.type==="mousedown"||g.sourceEvent.type==="touchstart")&&(m=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY])},y=g=>{const w=n();if(g.sourceEvent.type!=="mousemove"&&g.sourceEvent.type!=="touchmove"||!t)return;const N=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY],k=[N[0]-m[0],N[1]-m[1]];m=N;const C=r()*Math.max(w[2],Math.log(w[2]))*(h?-1:1),E={x:w[0]-k[0]*C,y:w[1]-k[1]*C},_=[[0,0],[l,d]];t.setViewportConstrained({x:E.x,y:E.y,zoom:w[2]},_,a)},v=na().on("start",x).on("zoom",c?y:null).on("zoom.wheel",f?p:null);i.call(v,{})}function o(){i.on("zoom",null)}return{update:s,destroy:o,pointer:he}}const gp=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ln=e=>({x:e.x,y:e.y,zoom:e.k}),xr=({x:e,y:t,zoom:n})=>rn.translate(e,t).scale(n),ze=(e,t)=>e.target.closest(`.${t}`),ka=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),vr=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},Ca=e=>{const t=e.ctrlKey&&Zt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function mp({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:i,panOnScrollSpeed:s,zoomOnPinch:o,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:d}){return u=>{if(ze(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const c=n.property("__zoom").k||1;if(u.ctrlKey&&o){const x=he(u),y=Ca(u),v=c*Math.pow(2,y);r.scaleTo(n,v,x,u);return}const f=u.deltaMode===1?20:1;let h=i===Le.Vertical?0:u.deltaX*f,p=i===Le.Horizontal?0:u.deltaY*f;!Zt()&&u.shiftKey&&i!==Le.Vertical&&(h=u.deltaY*f,p=0),r.translateBy(n,-(h/c)*s,-(p/c)*s,{internal:!0});const m=ln(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(u,m)),e.isPanScrolling&&(l==null||l(u,m),e.panScrollTimeout=setTimeout(()=>{d==null||d(u,m),e.isPanScrolling=!1},150))}}function yp({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,i){if(!t&&r.type==="wheel"&&!r.ctrlKey||ze(r,e))return null;r.preventDefault(),n.call(this,r,i)}}function wp({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var s,o,a;if((s=r.sourceEvent)!=null&&s.internal)return;const i=ln(r.transform);e.mouseButton=((o=r.sourceEvent)==null?void 0:o.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=i,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,i))}}function xp({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:i}){return s=>{var o,a;e.usedRightMouseButton=!!(n&&ka(t,e.mouseButton??0)),(o=s.sourceEvent)!=null&&o.sync||r([s.transform.x,s.transform.y,s.transform.k]),i&&!((a=s.sourceEvent)!=null&&a.internal)&&(i==null||i(s.sourceEvent,ln(s.transform)))}}function vp({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:i,onPaneContextMenu:s}){return o=>{var a;if(!((a=o.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&ka(t,e.mouseButton??0)&&!e.usedRightMouseButton&&o.sourceEvent&&s(o.sourceEvent),e.usedRightMouseButton=!1,r(!1),i&&gp(e.prevViewport,o.transform))){const l=ln(o.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{i==null||i(o.sourceEvent,l)},n?150:0)}}}function bp({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:i,zoomOnDoubleClick:s,userSelectionActive:o,noWheelClassName:a,noPanClassName:l,lib:d}){return u=>{var p;const c=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(ze(u,`${d}-flow__node`)||ze(u,`${d}-flow__edge`)))return!0;if(!r&&!c&&!i&&!s&&!n||o||ze(u,a)&&u.type==="wheel"||ze(u,l)&&(u.type!=="wheel"||i&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((p=u.touches)==null?void 0:p.length)>1)return u.preventDefault(),!1;if(!c&&!i&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function Ep({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:i,viewport:s,onPanZoom:o,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:d}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},c=e.getBoundingClientRect(),f=na().clickDistance(!ge(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(i),h=de(e).call(f);g({x:s.x,y:s.y,zoom:We(s.zoom,t,n)},[[0,0],[c.width,c.height]],i);const p=h.on("wheel.zoom"),m=h.on("dblclick.zoom");f.wheelDelta(Ca);function x(I,D){return h?new Promise(b=>{f==null||f.transform(vr(h,D==null?void 0:D.duration,()=>b(!0)),I)}):Promise.resolve(!1)}function y({noWheelClassName:I,noPanClassName:D,onPaneContextMenu:b,userSelectionActive:T,panOnScroll:M,panOnDrag:O,panOnScrollMode:j,panOnScrollSpeed:P,preventScrolling:V,zoomOnPinch:B,zoomOnScroll:G,zoomOnDoubleClick:A,zoomActivationKeyPressed:$,lib:L,onTransformChange:F}){T&&!u.isZoomingOrPanning&&v();const Y=M&&!$&&!T?mp({zoomPanValues:u,noWheelClassName:I,d3Selection:h,d3Zoom:f,panOnScrollMode:j,panOnScrollSpeed:P,zoomOnPinch:B,onPanZoomStart:a,onPanZoom:o,onPanZoomEnd:l}):yp({noWheelClassName:I,preventScrolling:V,d3ZoomHandler:p});if(h.on("wheel.zoom",Y,{passive:!1}),!T){const J=wp({zoomPanValues:u,onDraggingChange:d,onPanZoomStart:a});f.on("start",J);const Q=xp({zoomPanValues:u,panOnDrag:O,onPaneContextMenu:!!b,onPanZoom:o,onTransformChange:F});f.on("zoom",Q);const U=vp({zoomPanValues:u,panOnDrag:O,panOnScroll:M,onPaneContextMenu:b,onPanZoomEnd:l,onDraggingChange:d});f.on("end",U)}const K=bp({zoomActivationKeyPressed:$,panOnDrag:O,zoomOnScroll:G,panOnScroll:M,zoomOnDoubleClick:A,zoomOnPinch:B,userSelectionActive:T,noPanClassName:D,noWheelClassName:I,lib:L});f.filter(K),A?h.on("dblclick.zoom",m):h.on("dblclick.zoom",null)}function v(){f.on("zoom",null)}async function g(I,D,b){const T=xr(I),M=f==null?void 0:f.constrain()(T,D,b);return M&&await x(M),new Promise(O=>O(M))}async function w(I,D){const b=xr(I);return await x(b,D),new Promise(T=>T(b))}function N(I){if(h){const D=xr(I),b=h.property("__zoom");(b.k!==I.zoom||b.x!==I.x||b.y!==I.y)&&(f==null||f.transform(h,D,null,{sync:!0}))}}function k(){const I=h?ta(h.node()):{x:0,y:0,k:1};return{x:I.x,y:I.y,zoom:I.k}}function C(I,D){return h?new Promise(b=>{f==null||f.scaleTo(vr(h,D==null?void 0:D.duration,()=>b(!0)),I)}):Promise.resolve(!1)}function E(I,D){return h?new Promise(b=>{f==null||f.scaleBy(vr(h,D==null?void 0:D.duration,()=>b(!0)),I)}):Promise.resolve(!1)}function _(I){f==null||f.scaleExtent(I)}function S(I){f==null||f.translateExtent(I)}function R(I){const D=!ge(I)||I<0?0:I;f==null||f.clickDistance(D)}return{update:y,destroy:v,setViewport:w,setViewportConstrained:g,getViewport:k,scaleTo:C,scaleBy:E,setScaleExtent:_,setTranslateExtent:S,syncViewport:N,setClickDistance:R}}var ct;(function(e){e.Line="line",e.Handle="handle"})(ct||(ct={}));function _p({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:i,affectsY:s}){const o=e-t,a=n-r,l=[o>0?1:o<0?-1:0,a>0?1:a<0?-1:0];return o&&i&&(l[0]=l[0]*-1),a&&s&&(l[1]=l[1]*-1),l}function Np(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),i=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:i}}function Ce(e,t){return Math.max(0,t-e)}function Me(e,t){return Math.max(0,e-t)}function At(e,t,n){return Math.max(0,t-e,e-n)}function jo(e,t){return e?!t:t}function Sp(e,t,n,r,i,s,o,a){let{affectsX:l,affectsY:d}=t;const{isHorizontal:u,isVertical:c}=t,f=u&&c,{xSnapped:h,ySnapped:p}=n,{minWidth:m,maxWidth:x,minHeight:y,maxHeight:v}=r,{x:g,y:w,width:N,height:k,aspectRatio:C}=e;let E=Math.floor(u?h-e.pointerX:0),_=Math.floor(c?p-e.pointerY:0);const S=N+(l?-E:E),R=k+(d?-_:_),I=-s[0]*N,D=-s[1]*k;let b=At(S,m,x),T=At(R,y,v);if(o){let j=0,P=0;l&&E<0?j=Ce(g+E+I,o[0][0]):!l&&E>0&&(j=Me(g+S+I,o[1][0])),d&&_<0?P=Ce(w+_+D,o[0][1]):!d&&_>0&&(P=Me(w+R+D,o[1][1])),b=Math.max(b,j),T=Math.max(T,P)}if(a){let j=0,P=0;l&&E>0?j=Me(g+E,a[0][0]):!l&&E<0&&(j=Ce(g+S,a[1][0])),d&&_>0?P=Me(w+_,a[0][1]):!d&&_<0&&(P=Ce(w+R,a[1][1])),b=Math.max(b,j),T=Math.max(T,P)}if(i){if(u){const j=At(S/C,y,v)*C;if(b=Math.max(b,j),o){let P=0;!l&&!d||l&&!d&&f?P=Me(w+D+S/C,o[1][1])*C:P=Ce(w+D+(l?E:-E)/C,o[0][1])*C,b=Math.max(b,P)}if(a){let P=0;!l&&!d||l&&!d&&f?P=Ce(w+S/C,a[1][1])*C:P=Me(w+(l?E:-E)/C,a[0][1])*C,b=Math.max(b,P)}}if(c){const j=At(R*C,m,x)/C;if(T=Math.max(T,j),o){let P=0;!l&&!d||d&&!l&&f?P=Me(g+R*C+I,o[1][0])/C:P=Ce(g+(d?_:-_)*C+I,o[0][0])/C,T=Math.max(T,P)}if(a){let P=0;!l&&!d||d&&!l&&f?P=Ce(g+R*C,a[1][0])/C:P=Me(g+(d?_:-_)*C,a[0][0])/C,T=Math.max(T,P)}}}_=_+(_<0?T:-T),E=E+(E<0?b:-b),i&&(f?S>R*C?_=(jo(l,d)?-E:E)/C:E=(jo(l,d)?-_:_)*C:u?(_=E/C,d=l):(E=_*C,l=d));const M=l?g+E:g,O=d?w+_:w;return{width:N+(l?-E:E),height:k+(d?-_:_),x:s[0]*E*(l?-1:1)+M,y:s[1]*_*(d?-1:1)+O}}const Ma={width:0,height:0,x:0,y:0},kp={...Ma,pointerX:0,pointerY:0,aspectRatio:1};function Cp(e){return[[0,0],[e.measured.width,e.measured.height]]}function Mp(e,t,n){const r=t.position.x+e.position.x,i=t.position.y+e.position.y,s=e.measured.width??0,o=e.measured.height??0,a=n[0]*s,l=n[1]*o;return[[r-a,i-l],[r+s-a,i+o-l]]}function Rp({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:i}){const s=de(e);function o({controlPosition:l,boundaries:d,keepAspectRatio:u,onResizeStart:c,onResize:f,onResizeEnd:h,shouldResize:p}){let m={...Ma},x={...kp};const y=Np(l);let v,g=null,w=[],N,k,C;const E=Fs().on("start",_=>{const{nodeLookup:S,transform:R,snapGrid:I,snapToGrid:D,nodeOrigin:b,paneDomNode:T}=n();if(v=S.get(t),!v)return;g=(T==null?void 0:T.getBoundingClientRect())??null;const{xSnapped:M,ySnapped:O}=at(_.sourceEvent,{transform:R,snapGrid:I,snapToGrid:D,containerBounds:g});m={width:v.measured.width??0,height:v.measured.height??0,x:v.position.x??0,y:v.position.y??0},x={...m,pointerX:M,pointerY:O,aspectRatio:m.width/m.height},N=void 0,v.parentId&&(v.extent==="parent"||v.expandParent)&&(N=S.get(v.parentId),k=N&&v.extent==="parent"?Cp(N):void 0),w=[],C=void 0;for(const[j,P]of S)if(P.parentId===t&&(w.push({id:j,position:{...P.position},extent:P.extent}),P.extent==="parent"||P.expandParent)){const V=Mp(P,v,P.origin??b);C?C=[[Math.min(V[0][0],C[0][0]),Math.min(V[0][1],C[0][1])],[Math.max(V[1][0],C[1][0]),Math.max(V[1][1],C[1][1])]]:C=V}c==null||c(_,{...m})}).on("drag",_=>{const{transform:S,snapGrid:R,snapToGrid:I,nodeOrigin:D}=n(),b=at(_.sourceEvent,{transform:S,snapGrid:R,snapToGrid:I,containerBounds:g}),T=[];if(!v)return;const{x:M,y:O,width:j,height:P}=m,V={},B=v.origin??D,{width:G,height:A,x:$,y:L}=Sp(x,y,b,d,u,B,k,C),F=G!==j,q=A!==P,Y=$!==M&&F,K=L!==O&&q;if(!Y&&!K&&!F&&!q)return;if((Y||K||B[0]===1||B[1]===1)&&(V.x=Y?$:m.x,V.y=K?L:m.y,m.x=V.x,m.y=V.y,w.length>0)){const Z=$-M,te=L-O;for(const ie of w)ie.position={x:ie.position.x-Z+B[0]*(G-j),y:ie.position.y-te+B[1]*(A-P)},T.push(ie)}if((F||q)&&(V.width=F?G:m.width,V.height=q?A:m.height,m.width=V.width,m.height=V.height),N&&v.expandParent){const Z=B[0]*(V.width??0);V.x&&V.x<Z&&(m.x=Z,x.x=x.x-(V.x-Z));const te=B[1]*(V.height??0);V.y&&V.y<te&&(m.y=te,x.y=x.y-(V.y-te))}const J=_p({width:m.width,prevWidth:j,height:m.height,prevHeight:P,affectsX:y.affectsX,affectsY:y.affectsY}),Q={...m,direction:J};(p==null?void 0:p(_,Q))!==!1&&(f==null||f(_,Q),r(V,T))}).on("end",_=>{h==null||h(_,{...m}),i==null||i()});s.call(E)}function a(){s.on(".drag",null)}return{update:o,destroy:a}}var br={exports:{}},Er={},_r={exports:{}},Nr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ho;function Ip(){if(Ho)return Nr;Ho=1;var e=vs();function t(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,i=e.useEffect,s=e.useLayoutEffect,o=e.useDebugValue;function a(c,f){var h=f(),p=r({inst:{value:h,getSnapshot:f}}),m=p[0].inst,x=p[1];return s(function(){m.value=h,m.getSnapshot=f,l(m)&&x({inst:m})},[c,h,f]),i(function(){return l(m)&&x({inst:m}),c(function(){l(m)&&x({inst:m})})},[c]),o(h),h}function l(c){var f=c.getSnapshot;c=c.value;try{var h=f();return!n(c,h)}catch{return!0}}function d(c,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:a;return Nr.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,Nr}var zo;function Tp(){return zo||(zo=1,_r.exports=Ip()),_r.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fo;function Ap(){if(Fo)return Er;Fo=1;var e=vs(),t=Tp();function n(d,u){return d===u&&(d!==0||1/d===1/u)||d!==d&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=t.useSyncExternalStore,s=e.useRef,o=e.useEffect,a=e.useMemo,l=e.useDebugValue;return Er.useSyncExternalStoreWithSelector=function(d,u,c,f,h){var p=s(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=a(function(){function y(k){if(!v){if(v=!0,g=k,k=f(k),h!==void 0&&m.hasValue){var C=m.value;if(h(C,k))return w=C}return w=k}if(C=w,r(g,k))return C;var E=f(k);return h!==void 0&&h(C,E)?(g=k,C):(g=k,w=E)}var v=!1,g,w,N=c===void 0?null:c;return[function(){return y(u())},N===null?void 0:function(){return y(N())}]},[u,c,f,h]);var x=i(d,p[0],p[1]);return o(function(){m.hasValue=!0,m.value=x},[x]),l(x),x},Er}var Vo;function Pp(){return Vo||(Vo=1,br.exports=Ap()),br.exports}var $p=Pp();const Op=xs($p),Lp={},qo=e=>{let t;const n=new Set,r=(u,c)=>{const f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){const h=t;t=c??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(p=>p(t,h))}},i=()=>t,l={setState:r,getState:i,getInitialState:()=>d,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(Lp?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(r,i,l);return l},Dp=e=>e?qo(e):qo,{useDebugValue:jp}=W,{useSyncExternalStoreWithSelector:Hp}=Op,zp=e=>e;function Ra(e,t=zp,n){const r=Hp(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return jp(r),r}const Bo=(e,t)=>{const n=Dp(e),r=(i,s=t)=>Ra(n,i,s);return Object.assign(r,n),r},Fp=(e,t)=>e?Bo(e,t):Bo;function re(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,i]of e)if(!Object.is(i,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const un=z.createContext(null),Vp=un.Provider,Ia=xe.error001();function ee(e,t){const n=z.useContext(un);if(n===null)throw new Error(Ia);return Ra(n,e,t)}function ne(){const e=z.useContext(un);if(e===null)throw new Error(Ia);return z.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Go={display:"none"},qp={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ta="react-flow__node-desc",Aa="react-flow__edge-desc",Bp="react-flow__aria-live",Gp=e=>e.ariaLiveMessage;function Yp({rfId:e}){const t=ee(Gp);return H.jsx("div",{id:`${Bp}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:qp,children:t})}function Xp({rfId:e,disableKeyboardA11y:t}){return H.jsxs(H.Fragment,{children:[H.jsxs("div",{id:`${Ta}-${e}`,style:Go,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),H.jsx("div",{id:`${Aa}-${e}`,style:Go,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&H.jsx(Yp,{rfId:e})]})}const Wp=e=>e.userSelectionActive?"none":"all",dn=z.forwardRef(({position:e="top-left",children:t,className:n,style:r,...i},s)=>{const o=ee(Wp),a=`${e}`.split("-");return H.jsx("div",{className:ce(["react-flow__panel",n,...a]),style:{...r,pointerEvents:o},ref:s,...i,children:t})});dn.displayName="Panel";function Up({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:H.jsx(dn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:H.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Kp=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Pt=e=>e.id;function Zp(e,t){return re(e.selectedNodes.map(Pt),t.selectedNodes.map(Pt))&&re(e.selectedEdges.map(Pt),t.selectedEdges.map(Pt))}function Qp({onSelectionChange:e}){const t=ne(),{selectedNodes:n,selectedEdges:r}=ee(Kp,Zp);return z.useEffect(()=>{const i={nodes:n,edges:r};e==null||e(i),t.getState().onSelectionChangeHandlers.forEach(s=>s(i))},[n,r,e]),null}const Jp=e=>!!e.onSelectionChangeHandlers;function eg({onSelectionChange:e}){const t=ee(Jp);return e||t?H.jsx(Qp,{onSelectionChange:e}):null}const Pa=[0,0],tg={x:0,y:0,zoom:1},ng=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],Yo=[...ng,"rfId"],rg=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Xo={translateExtent:pt,nodeOrigin:Pa,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function ig(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:i,setTranslateExtent:s,setNodeExtent:o,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:d}=ee(rg,re),u=ne();z.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{c.current=Xo,a()}),[]);const c=z.useRef(Xo);return z.useEffect(()=>{for(const f of Yo){const h=e[f],p=c.current[f];h!==p&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?r(h):f==="maxZoom"?i(h):f==="translateExtent"?s(h):f==="nodeExtent"?o(h):f==="paneClickDistance"?d(h):f==="fitView"?u.setState({fitViewOnInit:h}):f==="fitViewOptions"?u.setState({fitViewOnInitOptions:h}):u.setState({[f]:h})))}c.current=e},Yo.map(f=>e[f])),null}function Wo(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function og(e){var r;const[t,n]=z.useState(e==="system"?null:e);return z.useEffect(()=>{if(e!=="system"){n(e);return}const i=Wo(),s=()=>n(i!=null&&i.matches?"dark":"light");return s(),i==null||i.addEventListener("change",s),()=>{i==null||i.removeEventListener("change",s)}},[e]),t!==null?t:(r=Wo())!=null&&r.matches?"dark":"light"}const Uo=typeof document<"u"?document:null;function wt(e=null,t={target:Uo,actInsideInputWithModifier:!0}){const[n,r]=z.useState(!1),i=z.useRef(!1),s=z.useRef(new Set([])),[o,a]=z.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(c=>typeof c=="string").map(c=>c.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=d.reduce((c,f)=>c.concat(...f),[]);return[d,u]}return[[],[]]},[e]);return z.useEffect(()=>{const l=(t==null?void 0:t.target)||Uo;if(e!==null){const d=f=>{if(i.current=f.ctrlKey||f.metaKey||f.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&jr(f))return!1;const p=Zo(f.code,a);s.current.add(f[p]),Ko(o,s.current,!1)&&(f.preventDefault(),r(!0))},u=f=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&jr(f))return!1;const p=Zo(f.code,a);Ko(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(f[p]),f.key==="Meta"&&s.current.clear(),i.current=!1},c=()=>{s.current.clear(),r(!1)};return l==null||l.addEventListener("keydown",d),l==null||l.addEventListener("keyup",u),window.addEventListener("blur",c),window.addEventListener("contextmenu",c),()=>{l==null||l.removeEventListener("keydown",d),l==null||l.removeEventListener("keyup",u),window.removeEventListener("blur",c),window.removeEventListener("contextmenu",c)}}},[e,r]),n}function Ko(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(i=>t.has(i)))}function Zo(e,t){return t.includes(e)?"code":"key"}const sg=()=>{const e=ne();return z.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,i,s],panZoom:o}=e.getState();return o?(await o.setViewport({x:t.x??r,y:t.y??i,zoom:t.zoom??s},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:i,panZoom:s,domNode:o}=e.getState();if(!s||!o)return Promise.resolve(!1);const a=Or(n,t),{width:l,height:d}=cn(o);return Lr({nodes:a,width:l,height:d,minZoom:r,maxZoom:i,panZoom:s},t)},setCenter:async(t,n,r)=>{const{width:i,height:s,maxZoom:o,panZoom:a}=e.getState(),l=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:o,d=i/2-t*l,u=s/2-n*l;return a?(await a.setViewport({x:d,y:u,zoom:l},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:i,minZoom:s,maxZoom:o,panZoom:a}=e.getState(),l=Qr(t,r,i,s,o,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(l,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:i,snapToGrid:s,domNode:o}=e.getState();if(!o)return t;const{x:a,y:l}=o.getBoundingClientRect(),d={x:t.x-a,y:t.y-l},u=n.snapGrid??i,c=n.snapToGrid??s;return _t(d,r,c,u)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:i,y:s}=r.getBoundingClientRect(),o=fa(t,n);return{x:o.x+i,y:o.y+s}}}),[])};function $a(e,t){const n=[],r=new Map,i=[];for(const s of e)if(s.type==="add"){i.push(s);continue}else if(s.type==="remove"||s.type==="replace")r.set(s.id,[s]);else{const o=r.get(s.id);o?o.push(s):r.set(s.id,[s])}for(const s of t){const o=r.get(s.id);if(!o){n.push(s);continue}if(o[0].type==="remove")continue;if(o[0].type==="replace"){n.push({...o[0].item});continue}const a={...s};for(const l of o)ag(l,a);n.push(a)}return i.length&&i.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function ag(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Oa(e,t){return $a(e,t)}function La(e,t){return $a(e,t)}function Pe(e,t){return{id:e,type:"select",selected:t}}function Fe(e,t=new Set,n=!1){const r=[];for(const[i,s]of e){const o=t.has(i);!(s.selected===void 0&&!o)&&s.selected!==o&&(n&&(s.selected=o),r.push(Pe(s.id,o)))}return r}function Qo({items:e=[],lookup:t}){var i;const n=[],r=new Map(e.map(s=>[s.id,s]));for(const[s,o]of e.entries()){const a=t.get(o.id),l=((i=a==null?void 0:a.internals)==null?void 0:i.userNode)??a;l!==void 0&&l!==o&&n.push({id:o.id,item:o,type:"replace"}),l===void 0&&n.push({item:o,type:"add",index:s})}for(const[s]of t)r.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function Jo(e){return{id:e.id,type:"remove"}}const es=e=>Hh(e),cg=e=>sa(e);function Da(e){return z.forwardRef(e)}const lg=typeof window<"u"?z.useLayoutEffect:z.useEffect;function ts(e){const[t,n]=z.useState(BigInt(0)),[r]=z.useState(()=>ug(()=>n(i=>i+BigInt(1))));return lg(()=>{const i=r.get();i.length&&(e(i),r.reset())},[t]),r}function ug(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const ja=z.createContext(null);function dg({children:e}){const t=ne(),n=z.useCallback(a=>{const{nodes:l=[],setNodes:d,hasDefaultNodes:u,onNodesChange:c,nodeLookup:f}=t.getState();let h=l;for(const p of a)h=typeof p=="function"?p(h):p;u?d(h):c&&c(Qo({items:h,lookup:f}))},[]),r=ts(n),i=z.useCallback(a=>{const{edges:l=[],setEdges:d,hasDefaultEdges:u,onEdgesChange:c,edgeLookup:f}=t.getState();let h=l;for(const p of a)h=typeof p=="function"?p(h):p;u?d(h):c&&c(Qo({items:h,lookup:f}))},[]),s=ts(i),o=z.useMemo(()=>({nodeQueue:r,edgeQueue:s}),[]);return H.jsx(ja.Provider,{value:o,children:e})}function fg(){const e=z.useContext(ja);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const hg=e=>!!e.panZoom;function fn(){const e=sg(),t=ne(),n=fg(),r=ee(hg),i=z.useMemo(()=>{const s=c=>t.getState().nodeLookup.get(c),o=c=>{n.nodeQueue.push(c)},a=c=>{n.edgeQueue.push(c)},l=c=>{var y,v;const{nodeLookup:f,nodeOrigin:h}=t.getState(),p=es(c)?c:f.get(c.id),m=p.parentId?ha(p.position,p.measured,p.parentId,f,h):p.position,x={...p,position:m,width:((y=p.measured)==null?void 0:y.width)??p.width,height:((v=p.measured)==null?void 0:v.height)??p.height};return Ue(x)},d=(c,f,h={replace:!1})=>{o(p=>p.map(m=>{if(m.id===c){const x=typeof f=="function"?f(m):f;return h.replace&&es(x)?x:{...m,...x}}return m}))},u=(c,f,h={replace:!1})=>{a(p=>p.map(m=>{if(m.id===c){const x=typeof f=="function"?f(m):f;return h.replace&&cg(x)?x:{...m,...x}}return m}))};return{getNodes:()=>t.getState().nodes.map(c=>({...c})),getNode:c=>{var f;return(f=s(c))==null?void 0:f.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:c=[]}=t.getState();return c.map(f=>({...f}))},getEdge:c=>t.getState().edgeLookup.get(c),setNodes:o,setEdges:a,addNodes:c=>{const f=Array.isArray(c)?c:[c];n.nodeQueue.push(h=>[...h,...f])},addEdges:c=>{const f=Array.isArray(c)?c:[c];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:c=[],edges:f=[],transform:h}=t.getState(),[p,m,x]=h;return{nodes:c.map(y=>({...y})),edges:f.map(y=>({...y})),viewport:{x:p,y:m,zoom:x}}},deleteElements:async({nodes:c=[],edges:f=[]})=>{const{nodes:h,edges:p,onNodesDelete:m,onEdgesDelete:x,triggerNodeChanges:y,triggerEdgeChanges:v,onDelete:g,onBeforeDelete:w}=t.getState(),{nodes:N,edges:k}=await Vh({nodesToRemove:c,edgesToRemove:f,nodes:h,edges:p,onBeforeDelete:w}),C=k.length>0,E=N.length>0;if(C){const _=k.map(Jo);x==null||x(k),v(_)}if(E){const _=N.map(Jo);m==null||m(N),y(_)}return(E||C)&&(g==null||g({nodes:N,edges:k})),{deletedNodes:N,deletedEdges:k}},getIntersectingNodes:(c,f=!0,h)=>{const p=Co(c),m=p?c:l(c),x=h!==void 0;return m?(h||t.getState().nodes).filter(y=>{const v=t.getState().nodeLookup.get(y.id);if(v&&!p&&(y.id===c.id||!v.internals.positionAbsolute))return!1;const g=Ue(x?y:v),w=mt(g,m);return f&&w>0||w>=m.width*m.height}):[]},isNodeIntersecting:(c,f,h=!0)=>{const m=Co(c)?c:l(c);if(!m)return!1;const x=mt(m,f);return h&&x>0||x>=m.width*m.height},updateNode:d,updateNodeData:(c,f,h={replace:!1})=>{d(c,p=>{const m=typeof f=="function"?f(p):f;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},updateEdge:u,updateEdgeData:(c,f,h={replace:!1})=>{u(c,p=>{const m=typeof f=="function"?f(p):f;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},getNodesBounds:c=>{const{nodeLookup:f,nodeOrigin:h}=t.getState();return zh(c,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:c,id:f,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}-${c}${f?`-${f}`:""}`))==null?void 0:p.values())??[])},getNodeConnections:({type:c,handleId:f,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}${c?f?`-${c}-${f}`:`-${c}`:""}`))==null?void 0:p.values())??[])}}},[]);return z.useMemo(()=>({...i,...e,viewportInitialized:r}),[r])}const ns=e=>e.selected,pg={actInsideInputWithModifier:!1},gg=typeof window<"u"?window:void 0;function mg({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ne(),{deleteElements:r}=fn(),i=wt(e,pg),s=wt(t,{target:gg});z.useEffect(()=>{if(i){const{edges:o,nodes:a}=n.getState();r({nodes:a.filter(ns),edges:o.filter(ns)}),n.setState({nodesSelectionActive:!1})}},[i]),z.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function yg(e){const t=ne();z.useEffect(()=>{const n=()=>{var i,s;if(!e.current)return!1;const r=cn(e.current);(r.height===0||r.width===0)&&((s=(i=t.getState()).onError)==null||s.call(i,"004",xe.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const hn={position:"absolute",width:"100%",height:"100%",top:0,left:0},wg=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function xg({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:i=.5,panOnScrollMode:s=Le.Free,zoomOnDoubleClick:o=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:d,minZoom:u,maxZoom:c,zoomActivationKeyCode:f,preventScrolling:h=!0,children:p,noWheelClassName:m,noPanClassName:x,onViewportChange:y,isControlledViewport:v,paneClickDistance:g}){const w=ne(),N=z.useRef(null),{userSelectionActive:k,lib:C}=ee(wg,re),E=wt(f),_=z.useRef();yg(N);const S=z.useCallback(R=>{y==null||y({x:R[0],y:R[1],zoom:R[2]}),v||w.setState({transform:R})},[y,v]);return z.useEffect(()=>{if(N.current){_.current=Ep({domNode:N.current,minZoom:u,maxZoom:c,translateExtent:d,viewport:l,paneClickDistance:g,onDraggingChange:b=>w.setState({paneDragging:b}),onPanZoomStart:(b,T)=>{const{onViewportChangeStart:M,onMoveStart:O}=w.getState();O==null||O(b,T),M==null||M(T)},onPanZoom:(b,T)=>{const{onViewportChange:M,onMove:O}=w.getState();O==null||O(b,T),M==null||M(T)},onPanZoomEnd:(b,T)=>{const{onViewportChangeEnd:M,onMoveEnd:O}=w.getState();O==null||O(b,T),M==null||M(T)}});const{x:R,y:I,zoom:D}=_.current.getViewport();return w.setState({panZoom:_.current,transform:[R,I,D],domNode:N.current.closest(".react-flow")}),()=>{var b;(b=_.current)==null||b.destroy()}}},[]),z.useEffect(()=>{var R;(R=_.current)==null||R.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:i,panOnScrollMode:s,zoomOnDoubleClick:o,panOnDrag:a,zoomActivationKeyPressed:E,preventScrolling:h,noPanClassName:x,userSelectionActive:k,noWheelClassName:m,lib:C,onTransformChange:S})},[e,t,n,r,i,s,o,a,E,h,x,k,m,C,S]),H.jsx("div",{className:"react-flow__renderer",ref:N,style:hn,children:p})}const vg=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function bg(){const{userSelectionActive:e,userSelectionRect:t}=ee(vg,re);return e&&t?H.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Sr=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Eg=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function _g({isSelecting:e,selectionKeyPressed:t,selectionMode:n=gt.Full,panOnDrag:r,selectionOnDrag:i,onSelectionStart:s,onSelectionEnd:o,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:d,onPaneMouseEnter:u,onPaneMouseMove:c,onPaneMouseLeave:f,children:h}){const p=ne(),{userSelectionActive:m,elementsSelectable:x,dragging:y}=ee(Eg,re),v=x&&(e||m),g=z.useRef(null),w=z.useRef(),N=z.useRef(new Set),k=z.useRef(new Set),C=z.useRef(!1),E=z.useRef(!1),_=M=>{if(C.current){C.current=!1;return}a==null||a(M),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},S=M=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){M.preventDefault();return}l==null||l(M)},R=d?M=>d(M):void 0,I=M=>{var B,G;const{resetSelectedElements:O,domNode:j}=p.getState();if(w.current=j==null?void 0:j.getBoundingClientRect(),!x||!e||M.button!==0||M.target!==g.current||!w.current)return;(G=(B=M.target)==null?void 0:B.setPointerCapture)==null||G.call(B,M.pointerId),E.current=!0,C.current=!1;const{x:P,y:V}=_e(M.nativeEvent,w.current);O(),p.setState({userSelectionRect:{width:0,height:0,startX:P,startY:V,x:P,y:V}}),s==null||s(M)},D=M=>{const{userSelectionRect:O,transform:j,nodeLookup:P,edgeLookup:V,connectionLookup:B,triggerNodeChanges:G,triggerEdgeChanges:A,defaultEdgeOptions:$}=p.getState();if(!w.current||!O)return;C.current=!0;const{x:L,y:F}=_e(M.nativeEvent,w.current),{startX:q,startY:Y}=O,K={startX:q,startY:Y,x:L<q?L:q,y:F<Y?F:Y,width:Math.abs(L-q),height:Math.abs(F-Y)},J=N.current,Q=k.current;N.current=new Set(aa(P,K,j,n===gt.Partial,!0).map(Z=>Z.id)),k.current=new Set;const U=($==null?void 0:$.selectable)??!0;for(const Z of N.current){const te=B.get(Z);if(te)for(const{edgeId:ie}of te.values()){const le=V.get(ie);le&&(le.selectable??U)&&k.current.add(ie)}}if(!Mo(J,N.current)){const Z=Fe(P,N.current,!0);G(Z)}if(!Mo(Q,k.current)){const Z=Fe(V,k.current);A(Z)}p.setState({userSelectionRect:K,userSelectionActive:!0,nodesSelectionActive:!1})},b=M=>{var j,P;if(M.button!==0||!E.current)return;(P=(j=M.target)==null?void 0:j.releasePointerCapture)==null||P.call(j,M.pointerId);const{userSelectionRect:O}=p.getState();!m&&O&&M.target===g.current&&(_==null||_(M)),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:N.current.size>0}),o==null||o(M),(t||i)&&(C.current=!1),E.current=!1},T=r===!0||Array.isArray(r)&&r.includes(0);return H.jsxs("div",{className:ce(["react-flow__pane",{draggable:T,dragging:y,selection:e}]),onClick:v?void 0:Sr(_,g),onContextMenu:Sr(S,g),onWheel:Sr(R,g),onPointerEnter:v?void 0:u,onPointerDown:v?I:c,onPointerMove:v?D:c,onPointerUp:v?b:void 0,onPointerLeave:f,ref:g,style:hn,children:[h,H.jsx(bg,{})]})}function qr({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeLookup:a,onError:l}=t.getState(),d=a.get(e);if(!d){l==null||l("012",xe.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(n||d.selected&&o)&&(s({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):i([e])}function Ha({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,nodeClickDistance:o}){const a=ne(),[l,d]=z.useState(!1),u=z.useRef();return z.useEffect(()=>{u.current=cp({getStoreItems:()=>a.getState(),onNodeMouseDown:c=>{qr({id:c,store:a,nodeRef:e})},onDragStart:()=>{d(!0)},onDragStop:()=>{d(!1)}})},[]),z.useEffect(()=>{var c,f;if(t)(c=u.current)==null||c.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:s,nodeId:i,nodeClickDistance:o}),()=>{var h;(h=u.current)==null||h.destroy()}},[n,r,t,s,e,i]),l}const Ng=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function za(){const e=ne();return z.useCallback(n=>{const{nodeExtent:r,snapToGrid:i,snapGrid:s,nodesDraggable:o,onError:a,updateNodePositions:l,nodeLookup:d,nodeOrigin:u}=e.getState(),c=new Map,f=Ng(o),h=i?s[0]:5,p=i?s[1]:5,m=n.direction.x*h*n.factor,x=n.direction.y*p*n.factor;for(const[,y]of d){if(!f(y))continue;let v={x:y.internals.positionAbsolute.x+m,y:y.internals.positionAbsolute.y+x};i&&(v=an(v,s));const{position:g,positionAbsolute:w}=ca({nodeId:y.id,nextPosition:v,nodeLookup:d,nodeExtent:r,nodeOrigin:u,onError:a});y.position=g,y.internals.positionAbsolute=w,c.set(y.id,y)}l(c)},[])}const ii=z.createContext(null),Sg=ii.Provider;ii.Consumer;const Fa=()=>z.useContext(ii),kg=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Cg=(e,t,n)=>r=>{const{connectionClickStartHandle:i,connectionMode:s,connection:o}=r,{fromHandle:a,toHandle:l,isValid:d}=o,u=(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.id)===t&&(l==null?void 0:l.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:u,clickConnecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.id)===t&&(i==null?void 0:i.type)===n,isPossibleEndHandle:s===Xe.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!i,valid:u&&d}};function Mg({type:e="source",position:t=X.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:a,children:l,className:d,onMouseDown:u,onTouchStart:c,...f},h){var T,M;const p=o||null,m=e==="target",x=ne(),y=Fa(),{connectOnClick:v,noPanClassName:g,rfId:w}=ee(kg,re),{connectingFrom:N,connectingTo:k,clickConnecting:C,isPossibleEndHandle:E,connectionInProcess:_,clickConnectionInProcess:S,valid:R}=ee(Cg(y,p,e),re);y||(M=(T=x.getState()).onError)==null||M.call(T,"010",xe.error010());const I=O=>{const{defaultEdgeOptions:j,onConnect:P,hasDefaultEdges:V}=x.getState(),B={...j,...O};if(V){const{edges:G,setEdges:A}=x.getState();A(Uh(B,G))}P==null||P(B),a==null||a(B)},D=O=>{if(!y)return;const j=ga(O.nativeEvent);if(i&&(j&&O.button===0||!j)){const P=x.getState();Vr.onPointerDown(O.nativeEvent,{autoPanOnConnect:P.autoPanOnConnect,connectionMode:P.connectionMode,connectionRadius:P.connectionRadius,domNode:P.domNode,nodeLookup:P.nodeLookup,lib:P.lib,isTarget:m,handleId:p,nodeId:y,flowId:P.rfId,panBy:P.panBy,cancelConnection:P.cancelConnection,onConnectStart:P.onConnectStart,onConnectEnd:P.onConnectEnd,updateConnection:P.updateConnection,onConnect:I,isValidConnection:n||P.isValidConnection,getTransform:()=>x.getState().transform,getFromHandle:()=>x.getState().connection.fromHandle,autoPanSpeed:P.autoPanSpeed})}j?u==null||u(O):c==null||c(O)},b=O=>{const{onClickConnectStart:j,onClickConnectEnd:P,connectionClickStartHandle:V,connectionMode:B,isValidConnection:G,lib:A,rfId:$,nodeLookup:L,connection:F}=x.getState();if(!y||!V&&!i)return;if(!V){j==null||j(O.nativeEvent,{nodeId:y,handleId:p,handleType:e}),x.setState({connectionClickStartHandle:{nodeId:y,type:e,id:p}});return}const q=pa(O.target),Y=n||G,{connection:K,isValid:J}=Vr.isValid(O.nativeEvent,{handle:{nodeId:y,id:p,type:e},connectionMode:B,fromNodeId:V.nodeId,fromHandleId:V.id||null,fromType:V.type,isValidConnection:Y,flowId:$,doc:q,lib:A,nodeLookup:L});J&&K&&I(K);const Q=structuredClone(F);delete Q.inProgress,Q.toPosition=Q.toHandle?Q.toHandle.position:null,P==null||P(O,Q),x.setState({connectionClickStartHandle:null})};return H.jsx("div",{"data-handleid":p,"data-nodeid":y,"data-handlepos":t,"data-id":`${w}-${y}-${p}-${e}`,className:ce(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",g,d,{source:!m,target:m,connectable:r,connectablestart:i,connectableend:s,clickconnecting:C,connectingfrom:N,connectingto:k,valid:R,connectionindicator:r&&(!_||E)&&(_||S?s:i)}]),onMouseDown:D,onTouchStart:D,onClick:v?b:void 0,ref:h,...f,children:l})}const se=z.memo(Da(Mg));function Rg({data:e,isConnectable:t,sourcePosition:n=X.Bottom}){return H.jsxs(H.Fragment,{children:[e==null?void 0:e.label,H.jsx(se,{type:"source",position:n,isConnectable:t})]})}function Ig({data:e,isConnectable:t,targetPosition:n=X.Top,sourcePosition:r=X.Bottom}){return H.jsxs(H.Fragment,{children:[H.jsx(se,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,H.jsx(se,{type:"source",position:r,isConnectable:t})]})}function Tg(){return null}function Ag({data:e,isConnectable:t,targetPosition:n=X.Top}){return H.jsxs(H.Fragment,{children:[H.jsx(se,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Qt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},rs={input:Rg,default:Ig,output:Ag,group:Tg};function Pg(e){var t,n,r,i;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((i=e.style)==null?void 0:i.height)}}const $g=e=>{const{width:t,height:n,x:r,y:i}=Et(e.nodeLookup,{filter:s=>!!s.selected});return{width:ge(t)?t:null,height:ge(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${i}px)`}};function Og({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ne(),{width:i,height:s,transformString:o,userSelectionActive:a}=ee($g,re),l=za(),d=z.useRef(null);if(z.useEffect(()=>{var f;n||(f=d.current)==null||f.focus({preventScroll:!0})},[n]),Ha({nodeRef:d}),a||!i||!s)return null;const u=e?f=>{const h=r.getState().nodes.filter(p=>p.selected);e(f,h)}:void 0,c=f=>{Object.prototype.hasOwnProperty.call(Qt,f.key)&&(f.preventDefault(),l({direction:Qt[f.key],factor:f.shiftKey?4:1}))};return H.jsx("div",{className:ce(["react-flow__nodesselection","react-flow__container",t]),style:{transform:o},children:H.jsx("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:c,style:{width:i,height:s}})})}const is=typeof window<"u"?window:void 0,Lg=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Va({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:d,selectionOnDrag:u,selectionMode:c,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:m,zoomActivationKeyCode:x,elementsSelectable:y,zoomOnScroll:v,zoomOnPinch:g,panOnScroll:w,panOnScrollSpeed:N,panOnScrollMode:k,zoomOnDoubleClick:C,panOnDrag:E,defaultViewport:_,translateExtent:S,minZoom:R,maxZoom:I,preventScrolling:D,onSelectionContextMenu:b,noWheelClassName:T,noPanClassName:M,disableKeyboardA11y:O,onViewportChange:j,isControlledViewport:P}){const{nodesSelectionActive:V,userSelectionActive:B}=ee(Lg),G=wt(d,{target:is}),A=wt(m,{target:is}),$=A||E,L=A||w,F=u&&$!==!0,q=G||B||F;return mg({deleteKeyCode:l,multiSelectionKeyCode:p}),H.jsx(xg,{onPaneContextMenu:s,elementsSelectable:y,zoomOnScroll:v,zoomOnPinch:g,panOnScroll:L,panOnScrollSpeed:N,panOnScrollMode:k,zoomOnDoubleClick:C,panOnDrag:!G&&$,defaultViewport:_,translateExtent:S,minZoom:R,maxZoom:I,zoomActivationKeyCode:x,preventScrolling:D,noWheelClassName:T,noPanClassName:M,onViewportChange:j,isControlledViewport:P,paneClickDistance:a,children:H.jsxs(_g,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:$,isSelecting:!!q,selectionMode:c,selectionKeyPressed:G,selectionOnDrag:F,children:[e,V&&H.jsx(Og,{onSelectionContextMenu:b,noPanClassName:M,disableKeyboardA11y:O})]})})}Va.displayName="FlowRenderer";const Dg=z.memo(Va),jg=e=>t=>e?aa(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Hg(e){return ee(z.useCallback(jg(e),[e]),re)}const zg=e=>e.updateNodeInternals;function Fg(){const e=ee(zg),[t]=z.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(i=>{const s=i.target.getAttribute("data-id");r.set(s,{id:s,nodeElement:i.target,force:!0})}),e(r)}));return z.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Vg({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const i=ne(),s=z.useRef(null),o=z.useRef(null),a=z.useRef(e.sourcePosition),l=z.useRef(e.targetPosition),d=z.useRef(t),u=n&&!!e.internals.handleBounds;return z.useEffect(()=>{s.current&&!e.hidden&&(!u||o.current!==s.current)&&(o.current&&(r==null||r.unobserve(o.current)),r==null||r.observe(s.current),o.current=s.current)},[u,e.hidden]),z.useEffect(()=>()=>{o.current&&(r==null||r.unobserve(o.current),o.current=null)},[]),z.useEffect(()=>{if(s.current){const c=d.current!==t,f=a.current!==e.sourcePosition,h=l.current!==e.targetPosition;(c||f||h)&&(d.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,i.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function qg({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:i,onContextMenu:s,onDoubleClick:o,nodesDraggable:a,elementsSelectable:l,nodesConnectable:d,nodesFocusable:u,resizeObserver:c,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:p,rfId:m,nodeTypes:x,nodeClickDistance:y,onError:v}){const{node:g,internals:w,isParent:N}=ee(q=>{const Y=q.nodeLookup.get(e),K=q.parentLookup.has(e);return{node:Y,internals:Y.internals,isParent:K}},re);let k=g.type||"default",C=(x==null?void 0:x[k])||rs[k];C===void 0&&(v==null||v("003",xe.error003(k)),k="default",C=rs.default);const E=!!(g.draggable||a&&typeof g.draggable>"u"),_=!!(g.selectable||l&&typeof g.selectable>"u"),S=!!(g.connectable||d&&typeof g.connectable>"u"),R=!!(g.focusable||u&&typeof g.focusable>"u"),I=ne(),D=Jr(g),b=Vg({node:g,nodeType:k,hasDimensions:D,resizeObserver:c}),T=Ha({nodeRef:b,disabled:g.hidden||!E,noDragClassName:f,handleSelector:g.dragHandle,nodeId:e,isSelectable:_,nodeClickDistance:y}),M=za();if(g.hidden)return null;const O=ke(g),j=Pg(g),P=_||E||t||n||r||i,V=n?q=>n(q,{...w.userNode}):void 0,B=r?q=>r(q,{...w.userNode}):void 0,G=i?q=>i(q,{...w.userNode}):void 0,A=s?q=>s(q,{...w.userNode}):void 0,$=o?q=>o(q,{...w.userNode}):void 0,L=q=>{const{selectNodesOnDrag:Y,nodeDragThreshold:K}=I.getState();_&&(!Y||!E||K>0)&&qr({id:e,store:I,nodeRef:b}),t&&t(q,{...w.userNode})},F=q=>{if(!(jr(q.nativeEvent)||p))if(ra.includes(q.key)&&_){const Y=q.key==="Escape";qr({id:e,store:I,unselect:Y,nodeRef:b})}else E&&g.selected&&Object.prototype.hasOwnProperty.call(Qt,q.key)&&(q.preventDefault(),I.setState({ariaLiveMessage:`Moved selected node ${q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~w.positionAbsolute.x}, y: ${~~w.positionAbsolute.y}`}),M({direction:Qt[q.key],factor:q.shiftKey?4:1}))};return H.jsx("div",{className:ce(["react-flow__node",`react-flow__node-${k}`,{[h]:E},g.className,{selected:g.selected,selectable:_,parent:N,draggable:E,dragging:T}]),ref:b,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:P?"all":"none",visibility:D?"visible":"hidden",...g.style,...j},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:V,onMouseMove:B,onMouseLeave:G,onContextMenu:A,onClick:L,onDoubleClick:$,onKeyDown:R?F:void 0,tabIndex:R?0:void 0,role:R?"button":void 0,"aria-describedby":p?void 0:`${Ta}-${m}`,"aria-label":g.ariaLabel,children:H.jsx(Sg,{value:e,children:H.jsx(C,{id:e,data:g.data,type:k,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:g.selected??!1,selectable:_,draggable:E,deletable:g.deletable??!0,isConnectable:S,sourcePosition:g.sourcePosition,targetPosition:g.targetPosition,dragging:T,dragHandle:g.dragHandle,zIndex:w.z,parentId:g.parentId,...O})})})}const Bg=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function qa(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,onError:s}=ee(Bg,re),o=Hg(e.onlyRenderVisibleElements),a=Fg();return H.jsx("div",{className:"react-flow__nodes",style:hn,children:o.map(l=>H.jsx(qg,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,nodeClickDistance:e.nodeClickDistance,onError:s},l))})}qa.displayName="NodeRenderer";const Gg=z.memo(qa);function Yg(e){return ee(z.useCallback(n=>{if(!e)return n.edges.map(i=>i.id);const r=[];if(n.width&&n.height)for(const i of n.edges){const s=n.nodeLookup.get(i.source),o=n.nodeLookup.get(i.target);s&&o&&Yh({sourceNode:s,targetNode:o,width:n.width,height:n.height,transform:n.transform})&&r.push(i.id)}return r},[e]),re)}const Xg=({color:e="none",strokeWidth:t=1})=>H.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Wg=({color:e="none",strokeWidth:t=1})=>H.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),os={[Ut.Arrow]:Xg,[Ut.ArrowClosed]:Wg};function Ug(e){const t=ne();return z.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(os,e)?os[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",xe.error009(e)),null)},[e])}const Kg=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const l=Ug(t);return l?H.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:H.jsx(l,{color:n,strokeWidth:o})}):null},Ba=({defaultColor:e,rfId:t})=>{const n=ee(s=>s.edges),r=ee(s=>s.defaultEdgeOptions),i=z.useMemo(()=>ep(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return i.length?H.jsx("svg",{className:"react-flow__marker",children:H.jsx("defs",{children:i.map(s=>H.jsx(Kg,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};Ba.displayName="MarkerDefinitions";var Zg=z.memo(Ba);function Ga({x:e,y:t,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:l,className:d,...u}){const[c,f]=z.useState({x:1,y:0,width:0,height:0}),h=ce(["react-flow__edge-textwrapper",d]),p=z.useRef(null);return z.useEffect(()=>{if(p.current){const m=p.current.getBBox();f({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),typeof n>"u"||!n?null:H.jsxs("g",{transform:`translate(${e-c.width/2} ${t-c.height/2})`,className:h,visibility:c.width?"visible":"hidden",...u,children:[i&&H.jsx("rect",{width:c.width+2*o[0],x:-o[0],y:-o[1],height:c.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),H.jsx("text",{className:"react-flow__edge-text",y:c.height/2,dy:"0.3em",ref:p,style:r,children:n}),l]})}Ga.displayName="EdgeText";const Qg=z.memo(Ga);function Se({path:e,labelX:t,labelY:n,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:o,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:d=20,...u}){return H.jsxs(H.Fragment,{children:[H.jsx("path",{...u,d:e,fill:"none",className:ce(["react-flow__edge-path",u.className])}),d&&H.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:d,className:"react-flow__edge-interaction"}),r&&ge(t)&&ge(n)?H.jsx(Qg,{x:t,y:n,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:o,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function ss({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===X.Left||e===X.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function Ya({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:i,targetPosition:s=X.Top}){const[o,a]=ss({pos:n,x1:e,y1:t,x2:r,y2:i}),[l,d]=ss({pos:s,x1:r,y1:i,x2:e,y2:t}),[u,c,f,h]=ma({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:o,sourceControlY:a,targetControlX:l,targetControlY:d});return[`M${e},${t} C${o},${a} ${l},${d} ${r},${i}`,u,c,f,h]}function Xa(e){return z.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,sourcePosition:o=X.Bottom,targetPosition:a=X.Top,label:l,labelStyle:d,labelShowBg:u,labelBgStyle:c,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:x,interactionWidth:y})=>{const[v,g,w]=Ya({sourceX:n,sourceY:r,sourcePosition:o,targetX:i,targetY:s,targetPosition:a}),N=e.isInternal?void 0:t;return H.jsx(Se,{id:N,path:v,labelX:g,labelY:w,label:l,labelStyle:d,labelShowBg:u,labelBgStyle:c,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:x,interactionWidth:y})})}const Jg=Xa({isInternal:!1}),Wa=Xa({isInternal:!0});Jg.displayName="SimpleBezierEdge";Wa.displayName="SimpleBezierEdgeInternal";function Ua(e){return z.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:c,style:f,sourcePosition:h=X.Bottom,targetPosition:p=X.Top,markerEnd:m,markerStart:x,pathOptions:y,interactionWidth:v})=>{const[g,w,N]=Hr({sourceX:n,sourceY:r,sourcePosition:h,targetX:i,targetY:s,targetPosition:p,borderRadius:y==null?void 0:y.borderRadius,offset:y==null?void 0:y.offset}),k=e.isInternal?void 0:t;return H.jsx(Se,{id:k,path:g,labelX:w,labelY:N,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:c,style:f,markerEnd:m,markerStart:x,interactionWidth:v})})}const oi=Ua({isInternal:!1}),Ka=Ua({isInternal:!0});oi.displayName="SmoothStepEdge";Ka.displayName="SmoothStepEdgeInternal";function Za(e){return z.memo(({id:t,...n})=>{var i;const r=e.isInternal?void 0:t;return H.jsx(oi,{...n,id:r,pathOptions:z.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(i=n.pathOptions)==null?void 0:i.offset])})})}const em=Za({isInternal:!1}),Qa=Za({isInternal:!0});em.displayName="StepEdge";Qa.displayName="StepEdgeInternal";function Ja(e){return z.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:c,style:f,markerEnd:h,markerStart:p,interactionWidth:m})=>{const[x,y,v]=He({sourceX:n,sourceY:r,targetX:i,targetY:s}),g=e.isInternal?void 0:t;return H.jsx(Se,{id:g,path:x,labelX:y,labelY:v,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:c,style:f,markerEnd:h,markerStart:p,interactionWidth:m})})}const tm=Ja({isInternal:!1}),ec=Ja({isInternal:!0});tm.displayName="StraightEdge";ec.displayName="StraightEdgeInternal";function tc(e){return z.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,sourcePosition:o=X.Bottom,targetPosition:a=X.Top,label:l,labelStyle:d,labelShowBg:u,labelBgStyle:c,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:x,pathOptions:y,interactionWidth:v})=>{const[g,w,N]=ya({sourceX:n,sourceY:r,sourcePosition:o,targetX:i,targetY:s,targetPosition:a,curvature:y==null?void 0:y.curvature}),k=e.isInternal?void 0:t;return H.jsx(Se,{id:k,path:g,labelX:w,labelY:N,label:l,labelStyle:d,labelShowBg:u,labelBgStyle:c,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:x,interactionWidth:v})})}const nm=tc({isInternal:!1}),nc=tc({isInternal:!0});nm.displayName="BezierEdge";nc.displayName="BezierEdgeInternal";const as={default:nc,straight:ec,step:Qa,smoothstep:Ka,simplebezier:Wa},cs={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},rm=(e,t,n)=>n===X.Left?e-t:n===X.Right?e+t:e,im=(e,t,n)=>n===X.Top?e-t:n===X.Bottom?e+t:e,ls="react-flow__edgeupdater";function us({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:a}){return H.jsx("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:ce([ls,`${ls}-${a}`]),cx:rm(t,r,e),cy:im(n,r,e),r,stroke:"transparent",fill:"transparent"})}function om({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:i,targetX:s,targetY:o,sourcePosition:a,targetPosition:l,onReconnect:d,onReconnectStart:u,onReconnectEnd:c,setReconnecting:f,setUpdateHover:h}){const p=ne(),m=(w,N)=>{if(w.button!==0)return;const{autoPanOnConnect:k,domNode:C,isValidConnection:E,connectionMode:_,connectionRadius:S,lib:R,onConnectStart:I,onConnectEnd:D,cancelConnection:b,nodeLookup:T,rfId:M,panBy:O,updateConnection:j}=p.getState(),P=N.type==="target";f(!0),u==null||u(w,n,N.type);const V=(G,A)=>{f(!1),c==null||c(G,n,N.type,A)},B=G=>d==null?void 0:d(n,G);Vr.onPointerDown(w.nativeEvent,{autoPanOnConnect:k,connectionMode:_,connectionRadius:S,domNode:C,handleId:N.id,nodeId:N.nodeId,nodeLookup:T,isTarget:P,edgeUpdaterType:N.type,lib:R,flowId:M,cancelConnection:b,panBy:O,isValidConnection:E,onConnect:B,onConnectStart:I,onConnectEnd:D,onReconnectEnd:V,updateConnection:j,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle})},x=w=>m(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),y=w=>m(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),v=()=>h(!0),g=()=>h(!1);return H.jsxs(H.Fragment,{children:[(e===!0||e==="source")&&H.jsx(us,{position:a,centerX:r,centerY:i,radius:t,onMouseDown:x,onMouseEnter:v,onMouseOut:g,type:"source"}),(e===!0||e==="target")&&H.jsx(us,{position:l,centerX:s,centerY:o,radius:t,onMouseDown:y,onMouseEnter:v,onMouseOut:g,type:"target"})]})}function sm({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:i,onDoubleClick:s,onContextMenu:o,onMouseEnter:a,onMouseMove:l,onMouseLeave:d,reconnectRadius:u,onReconnect:c,onReconnectStart:f,onReconnectEnd:h,rfId:p,edgeTypes:m,noPanClassName:x,onError:y,disableKeyboardA11y:v}){let g=ee(U=>U.edgeLookup.get(e));const w=ee(U=>U.defaultEdgeOptions);g=w?{...w,...g}:g;let N=g.type||"default",k=(m==null?void 0:m[N])||as[N];k===void 0&&(y==null||y("011",xe.error011(N)),N="default",k=as.default);const C=!!(g.focusable||t&&typeof g.focusable>"u"),E=typeof c<"u"&&(g.reconnectable||n&&typeof g.reconnectable>"u"),_=!!(g.selectable||r&&typeof g.selectable>"u"),S=z.useRef(null),[R,I]=z.useState(!1),[D,b]=z.useState(!1),T=ne(),{zIndex:M,sourceX:O,sourceY:j,targetX:P,targetY:V,sourcePosition:B,targetPosition:G}=ee(z.useCallback(U=>{const Z=U.nodeLookup.get(g.source),te=U.nodeLookup.get(g.target);if(!Z||!te)return{zIndex:g.zIndex,...cs};const ie=Jh({id:e,sourceNode:Z,targetNode:te,sourceHandle:g.sourceHandle||null,targetHandle:g.targetHandle||null,connectionMode:U.connectionMode,onError:y});return{zIndex:Gh({selected:g.selected,zIndex:g.zIndex,sourceNode:Z,targetNode:te,elevateOnSelect:U.elevateEdgesOnSelect}),...ie||cs}},[g.source,g.target,g.sourceHandle,g.targetHandle,g.selected,g.zIndex]),re),A=z.useMemo(()=>g.markerStart?`url('#${zr(g.markerStart,p)}')`:void 0,[g.markerStart,p]),$=z.useMemo(()=>g.markerEnd?`url('#${zr(g.markerEnd,p)}')`:void 0,[g.markerEnd,p]);if(g.hidden||O===null||j===null||P===null||V===null)return null;const L=U=>{var le;const{addSelectedEdges:Z,unselectNodesAndEdges:te,multiSelectionActive:ie}=T.getState();_&&(T.setState({nodesSelectionActive:!1}),g.selected&&ie?(te({nodes:[],edges:[g]}),(le=S.current)==null||le.blur()):Z([e])),i&&i(U,g)},F=s?U=>{s(U,{...g})}:void 0,q=o?U=>{o(U,{...g})}:void 0,Y=a?U=>{a(U,{...g})}:void 0,K=l?U=>{l(U,{...g})}:void 0,J=d?U=>{d(U,{...g})}:void 0,Q=U=>{var Z;if(!v&&ra.includes(U.key)&&_){const{unselectNodesAndEdges:te,addSelectedEdges:ie}=T.getState();U.key==="Escape"?((Z=S.current)==null||Z.blur(),te({edges:[g]})):ie([e])}};return H.jsx("svg",{style:{zIndex:M},children:H.jsxs("g",{className:ce(["react-flow__edge",`react-flow__edge-${N}`,g.className,x,{selected:g.selected,animated:g.animated,inactive:!_&&!i,updating:R,selectable:_}]),onClick:L,onDoubleClick:F,onContextMenu:q,onMouseEnter:Y,onMouseMove:K,onMouseLeave:J,onKeyDown:C?Q:void 0,tabIndex:C?0:void 0,role:C?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":g.ariaLabel===null?void 0:g.ariaLabel||`Edge from ${g.source} to ${g.target}`,"aria-describedby":C?`${Aa}-${p}`:void 0,ref:S,children:[!D&&H.jsx(k,{id:e,source:g.source,target:g.target,type:g.type,selected:g.selected,animated:g.animated,selectable:_,deletable:g.deletable??!0,label:g.label,labelStyle:g.labelStyle,labelShowBg:g.labelShowBg,labelBgStyle:g.labelBgStyle,labelBgPadding:g.labelBgPadding,labelBgBorderRadius:g.labelBgBorderRadius,sourceX:O,sourceY:j,targetX:P,targetY:V,sourcePosition:B,targetPosition:G,data:g.data,style:g.style,sourceHandleId:g.sourceHandle,targetHandleId:g.targetHandle,markerStart:A,markerEnd:$,pathOptions:"pathOptions"in g?g.pathOptions:void 0,interactionWidth:g.interactionWidth}),E&&H.jsx(om,{edge:g,isReconnectable:E,reconnectRadius:u,onReconnect:c,onReconnectStart:f,onReconnectEnd:h,sourceX:O,sourceY:j,targetX:P,targetY:V,sourcePosition:B,targetPosition:G,setUpdateHover:I,setReconnecting:b})]})})}const am=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function rc({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:i,onReconnect:s,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:d,onEdgeClick:u,reconnectRadius:c,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:m}){const{edgesFocusable:x,edgesReconnectable:y,elementsSelectable:v,onError:g}=ee(am,re),w=Yg(t);return H.jsxs("div",{className:"react-flow__edges",children:[H.jsx(Zg,{defaultColor:e,rfId:n}),w.map(N=>H.jsx(sm,{id:N,edgesFocusable:x,edgesReconnectable:y,elementsSelectable:v,noPanClassName:i,onReconnect:s,onContextMenu:o,onMouseEnter:a,onMouseMove:l,onMouseLeave:d,onClick:u,reconnectRadius:c,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:g,edgeTypes:r,disableKeyboardA11y:m},N))]})}rc.displayName="EdgeRenderer";const cm=z.memo(rc),lm=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function um({children:e}){const t=ee(lm);return H.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function dm(e){const t=fn(),n=z.useRef(!1);z.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const fm=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function hm(e){const t=ee(fm),n=ne();return z.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function pm(e){return e.connection.inProgress?{...e.connection,to:_t(e.connection.to,e.transform)}:{...e.connection}}function gm(e){return pm}function mm(e){const t=gm();return ee(t,re)}const ym=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function wm({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:i,width:s,height:o,isValid:a,inProgress:l}=ee(ym,re);return!(s&&i&&l)?null:H.jsx("svg",{style:e,width:s,height:o,className:"react-flow__connectionline react-flow__container",children:H.jsx("g",{className:ce(["react-flow__connection",oa(a)]),children:H.jsx(ic,{style:t,type:n,CustomComponent:r,isValid:a})})})}const ic=({style:e,type:t=Te.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:i,from:s,fromNode:o,fromHandle:a,fromPosition:l,to:d,toNode:u,toHandle:c,toPosition:f}=mm();if(!i)return;if(n)return H.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:o,fromHandle:a,fromX:s.x,fromY:s.y,toX:d.x,toY:d.y,fromPosition:l,toPosition:f,connectionStatus:oa(r),toNode:u,toHandle:c});let h="";const p={sourceX:s.x,sourceY:s.y,sourcePosition:l,targetX:d.x,targetY:d.y,targetPosition:f};switch(t){case Te.Bezier:[h]=ya(p);break;case Te.SimpleBezier:[h]=Ya(p);break;case Te.Step:[h]=Hr({...p,borderRadius:0});break;case Te.SmoothStep:[h]=Hr(p);break;default:[h]=He(p)}return H.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};ic.displayName="ConnectionLine";const xm={};function ds(e=xm){z.useRef(e),ne(),z.useEffect(()=>{},[e])}function vm(){ne(),z.useRef(!1),z.useEffect(()=>{},[])}function oc({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:i,onNodeDoubleClick:s,onEdgeDoubleClick:o,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:d,onNodeContextMenu:u,onSelectionContextMenu:c,onSelectionStart:f,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:m,connectionLineComponent:x,connectionLineContainerStyle:y,selectionKeyCode:v,selectionOnDrag:g,selectionMode:w,multiSelectionKeyCode:N,panActivationKeyCode:k,zoomActivationKeyCode:C,deleteKeyCode:E,onlyRenderVisibleElements:_,elementsSelectable:S,defaultViewport:R,translateExtent:I,minZoom:D,maxZoom:b,preventScrolling:T,defaultMarkerColor:M,zoomOnScroll:O,zoomOnPinch:j,panOnScroll:P,panOnScrollSpeed:V,panOnScrollMode:B,zoomOnDoubleClick:G,panOnDrag:A,onPaneClick:$,onPaneMouseEnter:L,onPaneMouseMove:F,onPaneMouseLeave:q,onPaneScroll:Y,onPaneContextMenu:K,paneClickDistance:J,nodeClickDistance:Q,onEdgeContextMenu:U,onEdgeMouseEnter:Z,onEdgeMouseMove:te,onEdgeMouseLeave:ie,reconnectRadius:le,onReconnect:pn,onReconnectStart:gn,onReconnectEnd:mn,noDragClassName:Ze,noWheelClassName:yn,noPanClassName:Qe,disableKeyboardA11y:Je,nodeExtent:wn,rfId:et,viewport:tt,onViewportChange:Nt}){return ds(e),ds(t),vm(),dm(n),hm(tt),H.jsx(Dg,{onPaneClick:$,onPaneMouseEnter:L,onPaneMouseMove:F,onPaneMouseLeave:q,onPaneContextMenu:K,onPaneScroll:Y,paneClickDistance:J,deleteKeyCode:E,selectionKeyCode:v,selectionOnDrag:g,selectionMode:w,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:N,panActivationKeyCode:k,zoomActivationKeyCode:C,elementsSelectable:S,zoomOnScroll:O,zoomOnPinch:j,zoomOnDoubleClick:G,panOnScroll:P,panOnScrollSpeed:V,panOnScrollMode:B,panOnDrag:A,defaultViewport:R,translateExtent:I,minZoom:D,maxZoom:b,onSelectionContextMenu:c,preventScrolling:T,noDragClassName:Ze,noWheelClassName:yn,noPanClassName:Qe,disableKeyboardA11y:Je,onViewportChange:Nt,isControlledViewport:!!tt,children:H.jsxs(um,{children:[H.jsx(cm,{edgeTypes:t,onEdgeClick:i,onEdgeDoubleClick:o,onReconnect:pn,onReconnectStart:gn,onReconnectEnd:mn,onlyRenderVisibleElements:_,onEdgeContextMenu:U,onEdgeMouseEnter:Z,onEdgeMouseMove:te,onEdgeMouseLeave:ie,reconnectRadius:le,defaultMarkerColor:M,noPanClassName:Qe,disableKeyboardA11y:Je,rfId:et}),H.jsx(wm,{style:m,type:p,component:x,containerStyle:y}),H.jsx("div",{className:"react-flow__edgelabel-renderer"}),H.jsx(Gg,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:d,onNodeContextMenu:u,nodeClickDistance:Q,onlyRenderVisibleElements:_,noPanClassName:Qe,noDragClassName:Ze,disableKeyboardA11y:Je,nodeExtent:wn,rfId:et}),H.jsx("div",{className:"react-flow__viewport-portal"})]})})}oc.displayName="GraphView";const bm=z.memo(oc),fs=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:o,nodeOrigin:a,nodeExtent:l}={})=>{const d=new Map,u=new Map,c=new Map,f=new Map,h=r??t??[],p=n??e??[],m=a??[0,0],x=l??pt;va(c,f,h),Fr(p,d,u,{nodeOrigin:m,nodeExtent:x,elevateNodesOnSelect:!1});let y=[0,0,1];if(o&&i&&s){const v=Et(d,{filter:k=>!!((k.width||k.initialWidth)&&(k.height||k.initialHeight))}),{x:g,y:w,zoom:N}=Qr(v,i,s,.5,2,.1);y=[g,w,N]}return{rfId:"1",width:0,height:0,transform:y,nodes:p,nodeLookup:d,parentLookup:u,edges:h,edgeLookup:f,connectionLookup:c,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:pt,nodeExtent:x,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Xe.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:m,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...ia},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:qh,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},Em=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:o,nodeOrigin:a,nodeExtent:l})=>Fp((d,u)=>({...fs({nodes:e,edges:t,width:i,height:s,fitView:o,nodeOrigin:a,nodeExtent:l,defaultNodes:n,defaultEdges:r}),setNodes:c=>{const{nodeLookup:f,parentLookup:h,nodeOrigin:p,elevateNodesOnSelect:m}=u();Fr(c,f,h,{nodeOrigin:p,nodeExtent:l,elevateNodesOnSelect:m,checkEquality:!0}),d({nodes:c})},setEdges:c=>{const{connectionLookup:f,edgeLookup:h}=u();va(f,h,c),d({edges:c})},setDefaultNodesAndEdges:(c,f)=>{if(c){const{setNodes:h}=u();h(c),d({hasDefaultNodes:!0})}if(f){const{setEdges:h}=u();h(f),d({hasDefaultEdges:!0})}},updateNodeInternals:(c,f={triggerFitView:!0})=>{const{triggerNodeChanges:h,nodeLookup:p,parentLookup:m,fitViewOnInit:x,fitViewDone:y,fitViewOnInitOptions:v,domNode:g,nodeOrigin:w,nodeExtent:N,debug:k,fitViewSync:C}=u(),{changes:E,updatedInternals:_}=op(c,p,m,g,w,N);if(_){if(np(p,m,{nodeOrigin:w,nodeExtent:N}),f.triggerFitView){let S=y;!y&&x&&(S=C({...v,nodes:v==null?void 0:v.nodes})),d({fitViewDone:S})}else d({});(E==null?void 0:E.length)>0&&(k&&console.log("React Flow: trigger node changes",E),h==null||h(E))}},updateNodePositions:(c,f=!1)=>{const h=[],p=[],{nodeLookup:m,triggerNodeChanges:x}=u();for(const[y,v]of c){const g=m.get(y),w=!!(g!=null&&g.expandParent&&(g!=null&&g.parentId)&&(v!=null&&v.position)),N={id:y,type:"position",position:w?{x:Math.max(0,v.position.x),y:Math.max(0,v.position.y)}:v.position,dragging:f};w&&g.parentId&&h.push({id:y,parentId:g.parentId,rect:{...v.internals.positionAbsolute,width:v.measured.width??0,height:v.measured.height??0}}),p.push(N)}if(h.length>0){const{parentLookup:y,nodeOrigin:v}=u(),g=ri(h,m,y,v);p.push(...g)}x(p)},triggerNodeChanges:c=>{const{onNodesChange:f,setNodes:h,nodes:p,hasDefaultNodes:m,debug:x}=u();if(c!=null&&c.length){if(m){const y=Oa(c,p);h(y)}x&&console.log("React Flow: trigger node changes",c),f==null||f(c)}},triggerEdgeChanges:c=>{const{onEdgesChange:f,setEdges:h,edges:p,hasDefaultEdges:m,debug:x}=u();if(c!=null&&c.length){if(m){const y=La(c,p);h(y)}x&&console.log("React Flow: trigger edge changes",c),f==null||f(c)}},addSelectedNodes:c=>{const{multiSelectionActive:f,edgeLookup:h,nodeLookup:p,triggerNodeChanges:m,triggerEdgeChanges:x}=u();if(f){const y=c.map(v=>Pe(v,!0));m(y);return}m(Fe(p,new Set([...c]),!0)),x(Fe(h))},addSelectedEdges:c=>{const{multiSelectionActive:f,edgeLookup:h,nodeLookup:p,triggerNodeChanges:m,triggerEdgeChanges:x}=u();if(f){const y=c.map(v=>Pe(v,!0));x(y);return}x(Fe(h,new Set([...c]))),m(Fe(p,new Set,!0))},unselectNodesAndEdges:({nodes:c,edges:f}={})=>{const{edges:h,nodes:p,nodeLookup:m,triggerNodeChanges:x,triggerEdgeChanges:y}=u(),v=c||p,g=f||h,w=v.map(k=>{const C=m.get(k.id);return C&&(C.selected=!1),Pe(k.id,!1)}),N=g.map(k=>Pe(k.id,!1));x(w),y(N)},setMinZoom:c=>{const{panZoom:f,maxZoom:h}=u();f==null||f.setScaleExtent([c,h]),d({minZoom:c})},setMaxZoom:c=>{const{panZoom:f,minZoom:h}=u();f==null||f.setScaleExtent([h,c]),d({maxZoom:c})},setTranslateExtent:c=>{var f;(f=u().panZoom)==null||f.setTranslateExtent(c),d({translateExtent:c})},setPaneClickDistance:c=>{var f;(f=u().panZoom)==null||f.setClickDistance(c)},resetSelectedElements:()=>{const{edges:c,nodes:f,triggerNodeChanges:h,triggerEdgeChanges:p}=u(),m=f.reduce((y,v)=>v.selected?[...y,Pe(v.id,!1)]:y,[]),x=c.reduce((y,v)=>v.selected?[...y,Pe(v.id,!1)]:y,[]);h(m),p(x)},setNodeExtent:c=>{const{nodes:f,nodeLookup:h,parentLookup:p,nodeOrigin:m,elevateNodesOnSelect:x,nodeExtent:y}=u();c[0][0]===y[0][0]&&c[0][1]===y[0][1]&&c[1][0]===y[1][0]&&c[1][1]===y[1][1]||(Fr(f,h,p,{nodeOrigin:m,nodeExtent:c,elevateNodesOnSelect:x,checkEquality:!1}),d({nodeExtent:c}))},panBy:c=>{const{transform:f,width:h,height:p,panZoom:m,translateExtent:x}=u();return sp({delta:c,panZoom:m,transform:f,translateExtent:x,width:h,height:p})},fitView:c=>{const{panZoom:f,width:h,height:p,minZoom:m,maxZoom:x,nodeLookup:y}=u();if(!f)return Promise.resolve(!1);const v=Or(y,c);return Lr({nodes:v,width:h,height:p,panZoom:f,minZoom:m,maxZoom:x},c)},fitViewSync:c=>{const{panZoom:f,width:h,height:p,minZoom:m,maxZoom:x,nodeLookup:y}=u();if(!f)return!1;const v=Or(y,c);return Lr({nodes:v,width:h,height:p,panZoom:f,minZoom:m,maxZoom:x},c),v.size>0},cancelConnection:()=>{d({connection:{...ia}})},updateConnection:c=>{d({connection:c})},reset:()=>d({...fs()})}),Object.is);function sc({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:i,initialHeight:s,fitView:o,nodeOrigin:a,nodeExtent:l,children:d}){const[u]=z.useState(()=>Em({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:o,nodeOrigin:a,nodeExtent:l}));return H.jsx(Vp,{value:u,children:H.jsx(dg,{children:d})})}function _m({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:i,width:s,height:o,fitView:a,nodeOrigin:l,nodeExtent:d}){return z.useContext(un)?H.jsx(H.Fragment,{children:e}):H.jsx(sc,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:i,initialWidth:s,initialHeight:o,fitView:a,nodeOrigin:l,nodeExtent:d,children:e})}const Nm={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Sm({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s,edgeTypes:o,onNodeClick:a,onEdgeClick:l,onInit:d,onMove:u,onMoveStart:c,onMoveEnd:f,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:x,onClickConnectEnd:y,onNodeMouseEnter:v,onNodeMouseMove:g,onNodeMouseLeave:w,onNodeContextMenu:N,onNodeDoubleClick:k,onNodeDragStart:C,onNodeDrag:E,onNodeDragStop:_,onNodesDelete:S,onEdgesDelete:R,onDelete:I,onSelectionChange:D,onSelectionDragStart:b,onSelectionDrag:T,onSelectionDragStop:M,onSelectionContextMenu:O,onSelectionStart:j,onSelectionEnd:P,onBeforeDelete:V,connectionMode:B,connectionLineType:G=Te.Bezier,connectionLineStyle:A,connectionLineComponent:$,connectionLineContainerStyle:L,deleteKeyCode:F="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:Y=!1,selectionMode:K=gt.Full,panActivationKeyCode:J="Space",multiSelectionKeyCode:Q=Zt()?"Meta":"Control",zoomActivationKeyCode:U=Zt()?"Meta":"Control",snapToGrid:Z,snapGrid:te,onlyRenderVisibleElements:ie=!1,selectNodesOnDrag:le,nodesDraggable:pn,nodesConnectable:gn,nodesFocusable:mn,nodeOrigin:Ze=Pa,edgesFocusable:yn,edgesReconnectable:Qe,elementsSelectable:Je=!0,defaultViewport:wn=tg,minZoom:et=.5,maxZoom:tt=2,translateExtent:Nt=pt,preventScrolling:bc=!0,nodeExtent:xn,defaultMarkerColor:Ec="#b1b1b7",zoomOnScroll:_c=!0,zoomOnPinch:Nc=!0,panOnScroll:Sc=!1,panOnScrollSpeed:kc=.5,panOnScrollMode:Cc=Le.Free,zoomOnDoubleClick:Mc=!0,panOnDrag:Rc=!0,onPaneClick:Ic,onPaneMouseEnter:Tc,onPaneMouseMove:Ac,onPaneMouseLeave:Pc,onPaneScroll:$c,onPaneContextMenu:Oc,paneClickDistance:si=0,nodeClickDistance:Lc=0,children:Dc,onReconnect:jc,onReconnectStart:Hc,onReconnectEnd:zc,onEdgeContextMenu:Fc,onEdgeDoubleClick:Vc,onEdgeMouseEnter:qc,onEdgeMouseMove:Bc,onEdgeMouseLeave:Gc,reconnectRadius:Yc=10,onNodesChange:Xc,onEdgesChange:Wc,noDragClassName:Uc="nodrag",noWheelClassName:Kc="nowheel",noPanClassName:ai="nopan",fitView:ci,fitViewOptions:Zc,connectOnClick:Qc,attributionPosition:Jc,proOptions:el,defaultEdgeOptions:tl,elevateNodesOnSelect:nl,elevateEdgesOnSelect:rl,disableKeyboardA11y:li=!1,autoPanOnConnect:il,autoPanOnNodeDrag:ol,autoPanSpeed:sl,connectionRadius:al,isValidConnection:cl,onError:ll,style:ul,id:ui,nodeDragThreshold:dl,viewport:fl,onViewportChange:hl,width:pl,height:gl,colorMode:ml="light",debug:yl,onScroll:St,...wl},xl){const vn=ui||"1",vl=og(ml),bl=z.useCallback(di=>{di.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),St==null||St(di)},[St]);return H.jsx("div",{"data-testid":"rf__wrapper",...wl,onScroll:bl,style:{...ul,...Nm},ref:xl,className:ce(["react-flow",i,vl]),id:ui,children:H.jsxs(_m,{nodes:e,edges:t,width:pl,height:gl,fitView:ci,nodeOrigin:Ze,nodeExtent:xn,children:[H.jsx(bm,{onInit:d,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:v,onNodeMouseMove:g,onNodeMouseLeave:w,onNodeContextMenu:N,onNodeDoubleClick:k,nodeTypes:s,edgeTypes:o,connectionLineType:G,connectionLineStyle:A,connectionLineComponent:$,connectionLineContainerStyle:L,selectionKeyCode:q,selectionOnDrag:Y,selectionMode:K,deleteKeyCode:F,multiSelectionKeyCode:Q,panActivationKeyCode:J,zoomActivationKeyCode:U,onlyRenderVisibleElements:ie,defaultViewport:wn,translateExtent:Nt,minZoom:et,maxZoom:tt,preventScrolling:bc,zoomOnScroll:_c,zoomOnPinch:Nc,zoomOnDoubleClick:Mc,panOnScroll:Sc,panOnScrollSpeed:kc,panOnScrollMode:Cc,panOnDrag:Rc,onPaneClick:Ic,onPaneMouseEnter:Tc,onPaneMouseMove:Ac,onPaneMouseLeave:Pc,onPaneScroll:$c,onPaneContextMenu:Oc,paneClickDistance:si,nodeClickDistance:Lc,onSelectionContextMenu:O,onSelectionStart:j,onSelectionEnd:P,onReconnect:jc,onReconnectStart:Hc,onReconnectEnd:zc,onEdgeContextMenu:Fc,onEdgeDoubleClick:Vc,onEdgeMouseEnter:qc,onEdgeMouseMove:Bc,onEdgeMouseLeave:Gc,reconnectRadius:Yc,defaultMarkerColor:Ec,noDragClassName:Uc,noWheelClassName:Kc,noPanClassName:ai,rfId:vn,disableKeyboardA11y:li,nodeExtent:xn,viewport:fl,onViewportChange:hl}),H.jsx(ig,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:x,onClickConnectEnd:y,nodesDraggable:pn,nodesConnectable:gn,nodesFocusable:mn,edgesFocusable:yn,edgesReconnectable:Qe,elementsSelectable:Je,elevateNodesOnSelect:nl,elevateEdgesOnSelect:rl,minZoom:et,maxZoom:tt,nodeExtent:xn,onNodesChange:Xc,onEdgesChange:Wc,snapToGrid:Z,snapGrid:te,connectionMode:B,translateExtent:Nt,connectOnClick:Qc,defaultEdgeOptions:tl,fitView:ci,fitViewOptions:Zc,onNodesDelete:S,onEdgesDelete:R,onDelete:I,onNodeDragStart:C,onNodeDrag:E,onNodeDragStop:_,onSelectionDrag:T,onSelectionDragStart:b,onSelectionDragStop:M,onMove:u,onMoveStart:c,onMoveEnd:f,noPanClassName:ai,nodeOrigin:Ze,rfId:vn,autoPanOnConnect:il,autoPanOnNodeDrag:ol,autoPanSpeed:sl,onError:ll,connectionRadius:al,isValidConnection:cl,selectNodesOnDrag:le,nodeDragThreshold:dl,onBeforeDelete:V,paneClickDistance:si,debug:yl}),H.jsx(eg,{onSelectionChange:D}),Dc,H.jsx(Up,{proOptions:el,position:Jc}),H.jsx(Xp,{rfId:vn,disableKeyboardA11y:li})]})})}var km=Da(Sm);function Cm(e){const[t,n]=z.useState(e),r=z.useCallback(i=>n(s=>Oa(i,s)),[]);return[t,n,r]}function Mm(e){const[t,n]=z.useState(e),r=z.useCallback(i=>n(s=>La(i,s)),[]);return[t,n,r]}const Rm=e=>t=>{if(t.nodeLookup.size===0)return!1;for(const[,{hidden:n,internals:r}]of t.nodeLookup)if((e.includeHiddenNodes||!n)&&(r.handleBounds===void 0||!Jr(r.userNode)))return!1;return!0};function Im(e={includeHiddenNodes:!1}){return ee(Rm(e))}function Tm({dimensions:e,lineWidth:t,variant:n,className:r}){return H.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ce(["react-flow__background-pattern",n,r])})}function Am({radius:e,className:t}){return H.jsx("circle",{cx:e,cy:e,r:e,className:ce(["react-flow__background-pattern","dots",t])})}var Ae;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ae||(Ae={}));const Pm={[Ae.Dots]:1,[Ae.Lines]:1,[Ae.Cross]:6},$m=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function ac({id:e,variant:t=Ae.Dots,gap:n=20,size:r,lineWidth:i=1,offset:s=0,color:o,bgColor:a,style:l,className:d,patternClassName:u}){const c=z.useRef(null),{transform:f,patternId:h}=ee($m,re),p=r||Pm[t],m=t===Ae.Dots,x=t===Ae.Cross,y=Array.isArray(n)?n:[n,n],v=[y[0]*f[2]||1,y[1]*f[2]||1],g=p*f[2],w=Array.isArray(s)?s:[s,s],N=x?[g,g]:v,k=[w[0]*f[2]||1+N[0]/2,w[1]*f[2]||1+N[1]/2],C=`${h}${e||""}`;return H.jsxs("svg",{className:ce(["react-flow__background",d]),style:{...l,...hn,"--xy-background-color-props":a,"--xy-background-pattern-color-props":o},ref:c,"data-testid":"rf__background",children:[H.jsx("pattern",{id:C,x:f[0]%v[0],y:f[1]%v[1],width:v[0],height:v[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${k[0]},-${k[1]})`,children:m?H.jsx(Am,{radius:g/2,className:u}):H.jsx(Tm,{dimensions:N,lineWidth:i,variant:t,className:u})}),H.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${C})`})]})}ac.displayName="Background";z.memo(ac);function Om(){return H.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:H.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Lm(){return H.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:H.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Dm(){return H.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:H.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function jm(){return H.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:H.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Hm(){return H.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:H.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function $t({children:e,className:t,...n}){return H.jsx("button",{type:"button",className:ce(["react-flow__controls-button",t]),...n,children:e})}const zm=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function cc({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:o,onFitView:a,onInteractiveChange:l,className:d,children:u,position:c="bottom-left",orientation:f="vertical","aria-label":h="React Flow controls"}){const p=ne(),{isInteractive:m,minZoomReached:x,maxZoomReached:y}=ee(zm,re),{zoomIn:v,zoomOut:g,fitView:w}=fn(),N=()=>{v(),s==null||s()},k=()=>{g(),o==null||o()},C=()=>{w(i),a==null||a()},E=()=>{p.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),l==null||l(!m)},_=f==="horizontal"?"horizontal":"vertical";return H.jsxs(dn,{className:ce(["react-flow__controls",_,d]),position:c,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&H.jsxs(H.Fragment,{children:[H.jsx($t,{onClick:N,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y,children:H.jsx(Om,{})}),H.jsx($t,{onClick:k,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:x,children:H.jsx(Lm,{})})]}),n&&H.jsx($t,{className:"react-flow__controls-fitview",onClick:C,title:"fit view","aria-label":"fit view",children:H.jsx(Dm,{})}),r&&H.jsx($t,{className:"react-flow__controls-interactive",onClick:E,title:"toggle interactivity","aria-label":"toggle interactivity",children:m?H.jsx(Hm,{}):H.jsx(jm,{})}),u]})}cc.displayName="Controls";z.memo(cc);function Fm({id:e,x:t,y:n,width:r,height:i,style:s,color:o,strokeColor:a,strokeWidth:l,className:d,borderRadius:u,shapeRendering:c,selected:f,onClick:h}){const{background:p,backgroundColor:m}=s||{},x=o||p||m;return H.jsx("rect",{className:ce(["react-flow__minimap-node",{selected:f},d]),x:t,y:n,rx:u,ry:u,width:r,height:i,style:{fill:x,stroke:a,strokeWidth:l},shapeRendering:c,onClick:h?y=>h(y,e):void 0})}const Vm=z.memo(Fm),qm=e=>e.nodes.map(t=>t.id),kr=e=>e instanceof Function?e:()=>e;function Bm({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:s=Vm,onClick:o}){const a=ee(qm,re),l=kr(t),d=kr(e),u=kr(n),c=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return H.jsx(H.Fragment,{children:a.map(f=>H.jsx(Ym,{id:f,nodeColorFunc:l,nodeStrokeColorFunc:d,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:i,NodeComponent:s,onClick:o,shapeRendering:c},f))})}function Gm({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:i,nodeStrokeWidth:s,shapeRendering:o,NodeComponent:a,onClick:l}){const{node:d,x:u,y:c,width:f,height:h}=ee(p=>{const m=p.nodeLookup.get(e),{x,y}=m.internals.positionAbsolute,{width:v,height:g}=ke(m);return{node:m,x,y,width:v,height:g}},re);return!d||d.hidden||!Jr(d)?null:H.jsx(a,{x:u,y:c,width:f,height:h,style:d.style,selected:!!d.selected,className:r(d),color:t(d),borderRadius:i,strokeColor:n(d),strokeWidth:s,shapeRendering:o,onClick:l,id:d.id})}const Ym=z.memo(Gm);var Xm=z.memo(Bm);const Wm=200,Um=150,Km=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?da(Et(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Zm="react-flow__minimap-desc";function lc({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o,nodeComponent:a,bgColor:l,maskColor:d,maskStrokeColor:u,maskStrokeWidth:c,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:m=!1,zoomable:x=!1,ariaLabel:y="React Flow mini map",inversePan:v,zoomStep:g=10,offsetScale:w=5}){const N=ne(),k=z.useRef(null),{boundingRect:C,viewBB:E,rfId:_,panZoom:S,translateExtent:R,flowWidth:I,flowHeight:D}=ee(Km,re),b=(e==null?void 0:e.width)??Wm,T=(e==null?void 0:e.height)??Um,M=C.width/b,O=C.height/T,j=Math.max(M,O),P=j*b,V=j*T,B=w*j,G=C.x-(P-C.width)/2-B,A=C.y-(V-C.height)/2-B,$=P+B*2,L=V+B*2,F=`${Zm}-${_}`,q=z.useRef(0),Y=z.useRef();q.current=j,z.useEffect(()=>{if(k.current&&S)return Y.current=pp({domNode:k.current,panZoom:S,getTransform:()=>N.getState().transform,getViewScale:()=>q.current}),()=>{var Q;(Q=Y.current)==null||Q.destroy()}},[S]),z.useEffect(()=>{var Q;(Q=Y.current)==null||Q.update({translateExtent:R,width:I,height:D,inversePan:v,pannable:m,zoomStep:g,zoomable:x})},[m,x,v,g,R,I,D]);const K=h?Q=>{var te;const[U,Z]=((te=Y.current)==null?void 0:te.pointer(Q))||[0,0];h(Q,{x:U,y:Z})}:void 0,J=p?z.useCallback((Q,U)=>{const Z=N.getState().nodeLookup.get(U);p(Q,Z)},[]):void 0;return H.jsx(dn,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof c=="number"?c*j:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof o=="string"?o:void 0},className:ce(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:H.jsxs("svg",{width:b,height:T,viewBox:`${G} ${A} ${$} ${L}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":F,ref:k,onClick:K,children:[y&&H.jsx("title",{id:F,children:y}),H.jsx(Xm,{onClick:J,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:a}),H.jsx("path",{className:"react-flow__minimap-mask",d:`M${G-B},${A-B}h${$+B*2}v${L+B*2}h${-$-B*2}z
        M${E.x},${E.y}h${E.width}v${E.height}h${-E.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}lc.displayName="MiniMap";z.memo(lc);function Qm({nodeId:e,position:t,variant:n=ct.Handle,className:r,style:i={},children:s,color:o,minWidth:a=10,minHeight:l=10,maxWidth:d=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:c=!1,shouldResize:f,onResizeStart:h,onResize:p,onResizeEnd:m}){const x=Fa(),y=typeof e=="string"?e:x,v=ne(),g=z.useRef(null),w=n===ct.Line?"right":"bottom-right",N=t??w,k=z.useRef(null);z.useEffect(()=>{if(!(!g.current||!y))return k.current||(k.current=Rp({domNode:g.current,nodeId:y,getStoreItems:()=>{const{nodeLookup:S,transform:R,snapGrid:I,snapToGrid:D,nodeOrigin:b,domNode:T}=v.getState();return{nodeLookup:S,transform:R,snapGrid:I,snapToGrid:D,nodeOrigin:b,paneDomNode:T}},onChange:(S,R)=>{const{triggerNodeChanges:I,nodeLookup:D,parentLookup:b,nodeOrigin:T}=v.getState(),M=[],O={x:S.x,y:S.y},j=D.get(y);if(j&&j.expandParent&&j.parentId){const P=j.origin??T,V=S.width??j.measured.width??0,B=S.height??j.measured.height??0,G={id:j.id,parentId:j.parentId,rect:{width:V,height:B,...ha({x:S.x??j.position.x,y:S.y??j.position.y},{width:V,height:B},j.parentId,D,P)}},A=ri([G],D,b,T);M.push(...A),O.x=S.x?Math.max(P[0]*V,S.x):void 0,O.y=S.y?Math.max(P[1]*B,S.y):void 0}if(O.x!==void 0&&O.y!==void 0){const P={id:y,type:"position",position:{...O}};M.push(P)}if(S.width!==void 0&&S.height!==void 0){const P={id:y,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:S.width,height:S.height}};M.push(P)}for(const P of R){const V={...P,type:"position"};M.push(V)}I(M)},onEnd:()=>{const S={id:y,type:"dimensions",resizing:!1};v.getState().triggerNodeChanges([S])}})),k.current.update({controlPosition:N,boundaries:{minWidth:a,minHeight:l,maxWidth:d,maxHeight:u},keepAspectRatio:c,onResizeStart:h,onResize:p,onResizeEnd:m,shouldResize:f}),()=>{var S;(S=k.current)==null||S.destroy()}},[N,a,l,d,u,c,h,p,m,f]);const C=N.split("-"),E=n===ct.Line?"borderColor":"backgroundColor",_=o?{...i,[E]:o}:i;return H.jsx("div",{className:ce(["react-flow__resize-control","nodrag",...C,n,r]),ref:g,style:_,children:s})}z.memo(Qm);const Ve=({id:e,personData:t})=>{const n=(t==null?void 0:t.age)===-1?"Deceased":`${t==null?void 0:t.age} years old`,r=e?{id:`${e}-ext-out`}:{};return W.createElement("div",{className:"whitespace-no-wrap relative left-1/2 w-[150px] -translate-x-1/2 py-2"},W.createElement("p",null,t==null?void 0:t.name),W.createElement("p",{className:"text-[10px] text-gray-500"},n),W.createElement(se,{...r,className:"opacity-0",type:"source",position:X.Bottom,isConnectable:!1}))};Ve.__docgenInfo={description:"",methods:[],displayName:"PersonLabel",props:{id:{required:!1,tsType:{name:"string"},description:""},personData:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  label?: string;
  name?: string;
  age?: number;
  location?: string;
  relation?: string;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!1}},{key:"name",value:{name:"string",required:!1}},{key:"age",value:{name:"number",required:!1}},{key:"location",value:{name:"string",required:!1}},{key:"relation",value:{name:"string",required:!1}}]}},description:""}}};const uc=e=>{const{data:t}=e;return W.createElement("div",{className:"relative w-[48px] overflow-visible text-center text-xs"},W.createElement("div",{className:"bg-node relative flex h-[48px] w-[48px] items-center justify-center rounded-full text-xs text-white"},t.label,W.createElement(se,{className:"top-[3px] opacity-0",type:"target",position:X.Top,isConnectable:!1})),W.createElement(Ve,{personData:t}))},dc=z.memo(uc);dc.displayName="PersonNode";uc.__docgenInfo={description:"",methods:[],displayName:"PersonNode"};function fc(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=fc(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function hs(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=fc(e))&&(r&&(r+=" "),r+=t);return r}const hc=e=>{var l,d,u;const{data:t}=e,n=!!((l=t.subflow)!=null&&l.isClientPair),r=!!((d=t.subflow)!=null&&d.exSpouseForR1),i=!!((u=t.subflow)!=null&&u.exSpouseForR2),s=()=>{var p,m,x,y,v,g;const c=hs("relative overflow-visible text-center text-xs",n?"w-[72px]":"w-[48px]"),f=hs("bg-node relative flex items-center justify-center rounded-full text-xs text-white",n?"h-[72px] w-[72px]":"h-[48px] w-[48px]"),h=n?72:48;return W.createElement(W.Fragment,null,W.createElement("div",{className:c},W.createElement("div",{className:f},(m=(p=t.subflow)==null?void 0:p.R1)==null?void 0:m.label,W.createElement(se,{className:"opacity-0",id:"R1-ext-in",type:"target",position:X.Top,isConnectable:!1,style:{top:"3px"}}),W.createElement(se,{className:"opacity-0",id:"R1-int-in",type:"target",position:X.Left,isConnectable:!1,style:{left:"3px"}}),W.createElement(se,{className:"opacity-0",id:"R1-int-out",type:"source",position:X.Right,isConnectable:!1,style:{right:"3px"}}),W.createElement(se,{className:"opacity-0",id:"R1R2-in",type:"target",position:X.Left,style:{left:`calc(${h+48}px + 3px)`},isConnectable:!1})),W.createElement(Ve,{id:"R1",personData:(x=t.subflow)==null?void 0:x.R1}),W.createElement(se,{className:"opacity-0",id:"R1R2-out",type:"source",position:X.Bottom,style:{left:`calc(${h+48}px)`},isConnectable:!1})),W.createElement("div",{className:"w-[96px]"}),W.createElement("div",{className:c},W.createElement("div",{className:f},(v=(y=t.subflow)==null?void 0:y.R2)==null?void 0:v.label,W.createElement(se,{className:"opacity-0",id:"R2-ext-in",type:"target",position:X.Top,isConnectable:!1,style:{top:"3px"}}),W.createElement(se,{className:"opacity-0",id:"R2-int-in",type:"target",position:X.Left,isConnectable:!1,style:{left:"3px"}}),W.createElement(se,{className:"opacity-0",id:"R2-int-out",type:"source",position:X.Right,isConnectable:!1,style:{right:"3px"}})),W.createElement(Ve,{id:"R2",personData:(g=t.subflow)==null?void 0:g.R2})))},o=()=>{var c,f,h;return r?W.createElement(W.Fragment,null,W.createElement("div",{className:"relative w-[48px] overflow-visible text-center text-xs"},W.createElement("div",{className:"bg-node relative flex h-[48px] w-[48px] items-center justify-center rounded-full text-xs text-white"},(f=(c=t.subflow)==null?void 0:c.exSpouseForR1)==null?void 0:f.label,W.createElement(se,{className:"opacity-0",id:"X1-ext-in",type:"target",position:X.Top,isConnectable:!1,style:{top:"3px"}}),W.createElement(se,{className:"opacity-0",id:"X1-int-out",type:"source",position:X.Right,isConnectable:!1,style:{right:"3px"}}),W.createElement(se,{className:"opacity-0",id:"X1R1-in",type:"target",position:X.Left,style:{left:"99px"},isConnectable:!1})),W.createElement(Ve,{id:"X1",personData:(h=t.subflow)==null?void 0:h.exSpouseForR1}),W.createElement(se,{className:"opacity-0",id:"X1R1-out",type:"source",position:X.Bottom,style:{left:"96px"},isConnectable:!1})),W.createElement("div",{className:"w-[96px]"})):null},a=()=>{var c,f,h;return i?W.createElement(W.Fragment,null,W.createElement("div",{className:"w-[96px]"}),W.createElement("div",{className:"relative w-[48px] overflow-visible text-center text-xs"},W.createElement("div",{className:"bg-node relative flex h-[48px] w-[48px] items-center justify-center rounded-full text-xs text-white"},(f=(c=t.subflow)==null?void 0:c.exSpouseForR2)==null?void 0:f.label,W.createElement(se,{className:"opacity-0",id:"X2-ext-in",type:"target",position:X.Top,isConnectable:!1,style:{top:"3px"}}),W.createElement(se,{className:"opacity-0",id:"X2-int-in",type:"target",position:X.Left,isConnectable:!1,style:{left:"3px"}})),W.createElement(Ve,{id:"X2",personData:(h=t.subflow)==null?void 0:h.exSpouseForR2}))):null};return W.createElement("div",{className:"flex flex-row items-center"},o(),s(),a())},pc=z.memo(hc);pc.displayName="PersonGroupNode";hc.__docgenInfo={description:"",methods:[],displayName:"PersonGroupNode"};const Jm={person:dc,personGroup:pc},Ot=8,e0=[-4,4],gc=e=>{const{sourceX:t,sourceY:n,targetX:r,targetY:i}=e,[s,o,a]=He({sourceX:t,sourceY:n,targetX:r,targetY:i}),l=e0.map(d=>({start:{x:o-Ot/2+d,y:a+Ot/2},end:{x:o+Ot/2+d,y:a-Ot/2}}));return W.createElement(W.Fragment,null,W.createElement(Se,{className:"stroke-edge",path:s}),W.createElement("svg",{className:"absolute overflow-visible"},l.map(({start:d,end:u})=>W.createElement("line",{key:d.x,className:"stroke-edge",x1:d.x,y1:d.y,x2:u.x,y2:u.y,strokeWidth:"0.6"}))))};gc.__docgenInfo={description:"",methods:[],displayName:"DivorcedEdge"};const mc=e=>{const{sourceX:t,sourceY:n,targetX:r,targetY:i}=e,[s]=He({sourceX:t,sourceY:n,targetX:r,targetY:i});return W.createElement(Se,{className:"stroke-edge [stroke-dasharray:3,3]",path:s})};mc.__docgenInfo={description:"",methods:[],displayName:"EngagedEdge"};const yc=e=>{const{sourceX:t,sourceY:n,targetX:r,targetY:i}=e,[s]=He({sourceX:t,sourceY:n-3,targetX:r,targetY:i-3}),[o]=He({sourceX:t,sourceY:n,targetX:r,targetY:i});return W.createElement(W.Fragment,null,W.createElement(Se,{className:"stroke-edge [stroke-dasharray:3,3]",path:s}),W.createElement(Se,{className:"stroke-edge",path:o}))};yc.__docgenInfo={description:"",methods:[],displayName:"PartneredEdge"};const wc=e=>W.createElement(oi,{...e,pathOptions:{borderRadius:16,offset:0},style:{stroke:"#5c657a"}});wc.__docgenInfo={description:"",methods:[],displayName:"RelationEdge"};const Lt=8,xc=e=>{const{sourceX:t,sourceY:n,targetX:r,targetY:i}=e,[s,o,a]=He({sourceX:t,sourceY:n,targetX:r,targetY:i}),l={start:{x:o-Lt/2,y:a+Lt/2},end:{x:o+Lt/2,y:a-Lt/2}};return W.createElement(W.Fragment,null,W.createElement(Se,{className:"stroke-edge",path:s}),W.createElement("svg",null,W.createElement("line",{className:"stroke-edge",x1:l.start.x,y1:l.start.y,x2:l.end.x,y2:l.end.y,strokeWidth:"0.6"})))};xc.__docgenInfo={description:"",methods:[],displayName:"SeparatedEdge"};const t0={divorced:gc,engaged:mc,relation:wc,partnered:yc,separated:xc},Re={x:0,y:0},n0=[{id:"P3",data:{label:"HH",name:"Howard Harrison",age:-1},position:Re,type:"person"},{id:"G0",data:{label:"G0",subflow:{R1:{label:"HL",name:"Henry Leonard",age:98},R2:{label:"DL",name:"Daisy Leonard",age:-1}}},position:Re,type:"personGroup"},{id:"G1",data:{label:"G1",subflow:{isClientPair:!0,R1:{label:"DL",name:"Douglas Leonard",age:77},R2:{label:"ML",name:"Melissa Leonard",age:71},exSpouseForR1:{label:"MS",name:"Martha Smith",age:77},exSpouseForR2:{label:"DT",name:"Dale Thompson",age:71}}},position:Re,type:"personGroup"},{id:"G2",data:{label:"G2",subflow:{R1:{label:"JL",name:"John Leonard",age:40},R2:{label:"GR",name:"Georgia Roberts",age:40}}},position:Re,type:"personGroup"},{id:"G3",data:{label:"G3",subflow:{R1:{label:"SL",name:"Sophie Leonard",age:40},R2:{label:"GS",name:"George Smith",age:40}}},position:Re,type:"personGroup"},{id:"G4",data:{label:"G4",subflow:{R1:{label:"GS",name:"George Smith",age:40},R2:{label:"SL",name:"Stephanie Leonard",age:40}}},position:Re,type:"personGroup"},{id:"GC1",data:{label:"GS",name:"George Smith Jr.",age:10},position:Re,type:"person"},{id:"GC2",data:{label:"SS",name:"Sarah Smith",age:10},position:Re,type:"person"}],it=(e,t)=>({id:`${e}__R1:R2`,source:e,sourceHandle:"R1-int-out",target:e,targetHandle:"R2-int-in",type:t}),r0=(e,t)=>({id:`${e}__X1:R1`,source:e,sourceHandle:"X1-int-out",target:e,targetHandle:"R1-int-in",type:t}),i0=(e,t)=>({id:`${e}__R1:X2`,source:e,sourceHandle:"R2-int-out",target:e,targetHandle:"X2-int-in",type:t}),ps=(e,t,n)=>[{id:`${e}__R1R2ie`,source:e,sourceHandle:"R1R2-out",target:e,targetHandle:"R1R2-in",type:"relation"},{id:`${e}__R1R2:${t}__${n}`,source:e,sourceHandle:"R1R2-out",target:t,targetHandle:`${n}-ext-in`,type:"relation"}],gs=(e,t,n)=>[{id:`${e}__X1R1ie`,source:e,sourceHandle:"X1R1-out",target:e,targetHandle:"X1R1-in",type:"relation"},{id:`${e}__X1R1:${t}__${n}`,source:e,sourceHandle:"X1R1-out",target:t,targetHandle:`${n}-ext-in`,type:"relation"}],o0=[{id:"P3:G1__R2",source:"P3",target:"G1",targetHandle:"R2-ext-in",type:"relation"},it("G0","relation"),...ps("G0","G1","R1"),it("G1","partnered"),r0("G1","divorced"),i0("G1","separated"),...ps("G1","G2","R1"),...gs("G1","G3","R1"),...gs("G1","G4","R2"),it("G2","engaged"),it("G3","relation"),{id:"G3__R1R2ie",source:"G3",sourceHandle:"R1R2-out",target:"G3",targetHandle:"R1R2-in",type:"relation"},{id:"G3_R1R2:GC1",source:"G3",sourceHandle:"R1R2-out",target:"GC1",type:"relation"},{id:"G3_R1R2:GC2",source:"G3",sourceHandle:"R1R2-out",target:"GC2",type:"relation"},it("G4","relation")],s0=(e,t)=>{const n=new oo.graphlib.Graph().setDefaultEdgeLabel(()=>({}));return n.setGraph({rankdir:"TB"}),t.forEach(r=>n.setEdge(r.source,r.target)),e.forEach(r=>{var i,s;return n.setNode(r.id,{...r,width:((i=r.measured)==null?void 0:i.width)??0,height:((s=r.measured)==null?void 0:s.height)??0})}),oo.layout(n),{nodes:e.map(r=>{var a,l;const i=n.node(r.id),s=i.x-(((a=r.measured)==null?void 0:a.width)??0)/2,o=i.y-(((l=r.measured)==null?void 0:l.height)??0)/2;return{...r,position:{x:s,y:o}}}),edges:t}},a0=()=>{const{fitView:e}=fn(),t=Im(),[n,r,i]=Cm(n0),[s,o,a]=Mm(o0),l=z.useCallback(()=>{const d=s0(n,s);r([...d.nodes]),o([...d.edges]),window.requestAnimationFrame(()=>e())},[n,s]);return z.useEffect(()=>{t&&l()},[t]),W.createElement(km,{fitView:!0,nodes:n,edges:s,nodeTypes:Jm,edgeTypes:t0,proOptions:{hideAttribution:!0},onNodesChange:i,onEdgesChange:a})},vc=()=>W.createElement("div",{className:"h-screen w-full border border-solid border-orange-500"},W.createElement(sc,null,W.createElement(a0,null)));vc.__docgenInfo={description:"",methods:[],displayName:"POC1"};const f0={title:"Family Tree/POC1",component:vc,parameters:{layout:"fullscreen",docs:{description:{component:"A proof of concept for a family tree using @xyflow/react"}},tags:["autodocs"]}},Dt={};var ms,ys,ws;Dt.parameters={...Dt.parameters,docs:{...(ms=Dt.parameters)==null?void 0:ms.docs,source:{originalSource:"{}",...(ws=(ys=Dt.parameters)==null?void 0:ys.docs)==null?void 0:ws.source}}};const h0=["Default"];export{Dt as Default,h0 as __namedExportsOrder,f0 as default};
